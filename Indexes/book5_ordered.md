| book | slide | page | 
| -----|-------|------|
| Perimeter Security and the Need for Zero Trust | Perimeter security has a major failing: it was not built with assume breach in mind, yet a compromise is inevitable. Inside access is not always benign. Modern attacks are inside out. A trusted system brings attacker in. Internal access is loosely regulated. Assets wont be 100% controlled. | 5.3 |
| Zero Trust Architecture | developed by Forrester's John Kindervag in 2010; **Data-centric focus** <br> **Basic principles of zero trust:**; Network is always hostile: assume breach; Internal and external threats are always present.; Internal network does not equal trusted; Every device, user, and network flow must be proven.; Log and inspect all traffic. | 5.4 | 
| Zero Trust over Time | The original ZT concept has been evolving over time; Network or identity? **Both!**; Implementing ZT principles is difficult; Beware of taking shortcuts and opening more security gaps; Balance, based on risk prioritization, is needed | 5.5 |
| Zero Trust Tenets | **1. Network is hostile**<br> -Traffic must be authenticated.<br> -Traffic must be encrypted.  <br> **2. Least privilege must be enforced**.<br> -Trust must be factored into least privilege.<br> -Trust is no longer binary (yes or no).<br> -Access is granted per-session basis based by dynamic policy. <br> **3.** All data flows must be known and controlled. <br> **4.** All assets must be scanned, hardened, and rotated.   <br> **Trust Nothing Verify Everything** | 5.6 |
| Identity = User + Device + Context | Forresters original ZT research used the concept of a network agent for access.  In that model a network agent is a user and device combined.This new type of identity (user+device+context) is used to determine authorization. <br><br> User + corporate laptop = what access?<br> >User + personal laptop = what access?<br> User + corporate phone = what access? <br> Access to data is based on variable or dynamic trust | 5.7 |
| Variable Trust | Access controlled by variable trust; Similar to real-life credit scores.  Attempt to access PCI database requires +40 points:  <br> User authenticated with username/password +10 points <br> Device authenticated +10 points <br> Known device and location +10 points <br> Multifactor authentication with smart card +20 points | 5.8 |
| Trust over Time | Risk to systems increases over time. <br> - Systems need to be reloaded: Due to deviations from baseline <br> - Credentials need to be rotated.: Limits compromise and reuse <br> - Certificates need to be replaced.: Limits compromise and reuse <br> - Cycling time increases with security. But still should take place | 5.9 |
| Example of Zero Trust Scenario **Remote Exploitation or Insider Threat** In this example, a malicious cyber actor compromises a users device through an internet-based mobile code exploit. While a level of compromise occurs, damage is limited, and the time for defensive systems to detect and initiate appropriate mitigating responses is greatly reduced. | 5.1O |
| NIST: ZTA Reference Architecture  | (December 2022) NIST SP 1800-35B: Implementing a Zero Trust Architecture, builds up on NIST SP 800-207. This NIST Cybersecurity Practice Guide explains how 65 commercially available technologies can be integrated and used to build various ZTAs (see notes). TL/DR: no solution can provide full 100% ZT! | 5.11 |
| Federal Zero Trust Strategy | OMB has shared some of their priorities in a public document that details their journey: - Removing implicit trust of connections between systems, starting with HTTP and DNS - Deprecate decryption in transit with long-lived keys to favor context-aware decisions about visibility vs attack surface - Shifting away from traditional intranet/VPN model - Moving authentication to the application layer and use of phishing-resistant authentication methods - Treating everything as internet-accessible - Big emphasis on first/third-party testing (see new SEC568: Combating Supply Chain Attacks with Product Security Testing) | 5.15 |
| What Good Looks Like |  ZT will be infused throughout the organization;  ZT is not just about infrastructure, its also about mature security operations and high-quality, timely and relevant detection content (notice threat intel) | 5.16 |
| Implementing and Auditing Zero Trust Strategies | Mapping to NIST SP 800-207 and CIS Critical Security Controls V8 (or equivalent in other geographies)     Security architects can implement the tenets of ZTA using existing control frameworks, aligning with: NISTCyberSecurity Framework (CSF)and following the NISTRisk Management Framework (RMF).  The CSF provides the controls objectives and the RMF provides a high-level process for planning and implementation. The ZTA tenets can be supported by specific CSC control activities. Controls v8 supports a zero-trust architecture. This can be a great starting point to prioritize your journey. | 5.17 |
| Identity as a Perimeter | Probably one of the most important transformations for any organization that wants to implement ZT.   It requires a short and long-term approach to managing: Identity, Authentication, Authorization:  Across people, devices, networks, workloads and data. <br> Identity/Authentication/Authorization: People, Devices, Networks, Workloads, Data | 5.2O | 
| Identity Management | Ensuring that data is accessed by the right users, at the right time and for the right purposes often requires consolidating using centrally managed identity systems.<br> For most of us, the starting point is an on-prem Windows Server AD replicating with Entra ID.  |  5.21 | 
| Identity Federation |  Next logical step could be to use app provisioning in Entra ID.  Allows users to access resources across multiple domains or organizations with a single set of credentials (e.g., Dropbox, Salesforce, ServiceNow | 5.23 |
| Authentication, SaaS Applications, and Federated SSO |  On-prem AD servers will continue to use windows authentication protocols.<br> For cloud apps, Entra ID will use modern authentication protocols like SAML, OAUTH, OIDC.<br> Add risk-based authentication and conditional access, with passwordless capabilities such as hardware tokens, certificates, or windows hello where possible.  | 5.25 |
| Attack Vector in Azure/Entra ID | Authentication request from on-prem to https://login.microsoftonline.com. The on-prem AD Connect service pushes objects to Azure/Entra ID. <br> 1.Enrollment of a TLS certificate for Microsoft Login domain (no verification)2.Launches a DHCP Rogue, ARP spoofing, or IPv6 RA attac | 5.27-28 |
| Lessons Learned and Mitigations |   On-prem is still in most cases the weakest link. <br> Layered defense is vital, including: - Endpoint security and secure workstations 1, 2 - Network segregation and monitoring - Hardening against L2 attacks (e.g., ARP spoofing, DHCP, IPv6 RA) increases the attackers cost. <br> Privileged Access Management - Implement PAM solutions to enforce secure administrative access to the AD Connect server. - Monitor for abnormal activity. <br> Restrict access to certificate templates that allow server authentication and monitor enrollment. | 5.31 |
| Attackers Always Follow the Path of Least Resistance |   Remember: Attackers are lazy! - You need to continue working on securing your on-prem identity management systems, implementing less implicit trustas these are often the weakest link, and the target of attackers. - This includes: User passwords (yes, we still have those)  Service accounts | 5.32 |
| NIST 800-63B | NIST clearly states password rotation is not recommended. "Verifiers SHOULD NOT require memorized secrets to be changed arbitrarily (e.g., periodically). However, verifiers SHALL force a change if there is evidence of compromise of the authenticator."1 Based on studies that show password rotation increases the likelihood of poor passwords | 5.33 |
| Password Policies | Rotation increases chance of users picking weak passwords. - Primarily due to lack of password policy controlsWindows supports fine-grained password policies. - Allows different password policies per user or group | 5.34 |
| Third-Party Password Policy Management | Microsoft's password policy allows weak passwords. Winter2023! is susceptible to cracking and guessin; But meets complexity requirements <BR> Third-party solutions provide granular policy requirements; Cannot contain dictionary term; Disallow characters at beginning or end of passwor; Present GUI breakdown of rule; Disallow passwords using common permutationsLinux pluggable authentication module (PAM) has granular support | 5.35 |
| Entra Password Protection | Global and custom banned password - Works across Entra ID users and can sync-up policies with on-prem AD (see notes) | 5.36 |
| Password Auditing | Passwords should be evaluated for weaknesses. <br> - Consider doing it before the adversary does.Possible to intentionally dump hashes and test them <br> - Get-bADpasswords can automate the process <br> - Hashes can be pulled from volume shadow copy <br> - Linux hashes in /etc/passwd and /etc/shadow <br> Hashes can be sent to system with GPUs: - Low-cost solution for password auditing | 5.37 |
| Automatic Credential Rotation | Some accounts are high risk and need rotation frequently; Local administrator accounts (if enabled); Service accounts...Both account types are attacker favorites.; Gold images leave local admin password the same; Service accounts often set and never touched again;  Service accounts often have admin privileges.Both account types can integrate with automatic rotation. | 5.38 |
| Local Administrator Password Solution (LAPS ) |  is a free tool capability from Microsoft. <br> - Newer version is now built into Windows since April 2023 <br> - Automatically rotates local admin password <br> - Can back up passwords to Entra ID Active Directory, encrypt passwords in AD and store password history in case you need to log back into restored backup imagesLAPS is centrally controlled via Active Directory but can also now be managed via a Configuration Service Provider (CSP) to administer Entra ID policies, and via Intune. | 5.39 |
| Group-Managed Service Accounts (gMSA)| MSAs have some significant limitations.; Only work on one system (cannot be shared); Do not support scheduled tasks; Not supported by older SQL, Exchange, and other softwaregMSA solves many of these issues.; Requires AD schema of Server 2012 or later; Allows service account to work on multiple systems; Works with service accounts and other mainstream services | 5.41 |