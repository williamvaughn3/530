| slide title | description | Page |
| --- | --- | --- |
| What Is a Security Architecture? | Future State, Focus on Building at Net/Infra, App and Data, Endpoint, and Cloud, Typically built from network up.  Must be built around buisness processes and goals. | 1.4 |
| What Makes a Good Security Architect? | Understanding of networks,infrastructure, applications, information,and business architecture and how eachof these layers deal with risk. <br> - ThinkRED: What are the threatsthat are likely to cause an impact?. <br> - ActBLUE: What are thearchitectural designs andtechnologies that will help me defendagainst them?. <br> - Can balance business and technicalcommunications. <br> - Has good project management skills. <br> - Has a strategic and tactical vision <br> REALIZE THAT SECURITY IS PROBABLY NOT THE CORE BUSINESS OF YOUR ORGANIZATION. <br>  Must have understanding of Business requirements; Regulatory landscape; Threat landscape; IT landscape| 1.6 |
| Where We Came From (1) | <br> The internet we know today started as an experiment.<br> ARPANET was the first TCP/IP network created by the U.S. military - the precursor infrastructure for what we now refer to as the internet.<br> The massive growth of IP adoption over the 80s and 90s led to the birth of NAT, which led to perimeter defense | 1.17 |
| Where We Came From (2) | Perimeter defense is "a sort of crunchy shell around a soft, chewycenter."1o Bill Cheswick (1990), describing the first internet gateways (proxyfirewalls)<br> This was a reasonable design in 1990.<br> We have come a long way since then, but many organizations stillhave this "candy bar" design. - Hard on the outside, soft on the inside -  Flat networks with little to no internal segmentation; - A hardened perimeter, but with weaker/unpatched internal systems | 1.18 | 
| Defensible Security Architecture | term "defensible networks" was coined by Richard Bejtlich in The Tao of Network Security Monitoring (2004). - I use the term defensible networks to describe enterprises that encourage, rather than frustrate, digital self-defense. <br> - Bejtlich makes these points about defensible networks:o Defensible networks can be watched. -  Defensible networks limit an intruders freedom to maneuver. -  Defensible networks offer a minimum number of services. -  Defensible networks can be kept current. | 1.19 |
| Defensible Network Architecture 2.0 - MICCMAC | **Monitored**  -Deploy IDSes and IPSes <br> **Inventoried**  -Know every host and application <br> **Controlled**  -Ingress and egress filtering <br> **Claimed**  -Identify owners of all systems <br> **Minimized**  -Reduce the attack surface <br> **Assessed**  -Conduct vulnerabilityassessments <br> **Current**  -Patched | 1.2o |
| Defensible Security Architecture, Mindset | Defensible security architecture is entirely complementary to traditional network architecture approaches that focus primarily on operations. <br> - Often at the expense of security The mindset is "build it once, build it right." <br> - All networks must perform their operational functions effectively. <br> - Security can be complementary to this goal. <br> - It is (much) more efficient to bake security in at the outset, rather than retrofitting it later. For example, your team configures robust logging using a secure template as part of their new router deployment process. <br> - This logging later helps detect an operational issue that is impacting performance. <br> - The problem is solved before users are aware of any issue. | 1.21 | 
| Why Firewalls Were Created | The firewall (and modern information security industry) gained steam in the wake of the Morris worm (released in 1988).<br> Lesson learned: a globally flat ARPANET (the precursor to the internet) was a bad idea. - The worm is estimated to have infected 10% of the ARPANET's 60,000 computers.<br> How many corporate WANs have more than 60,000 hosts today and are also internally flat?<br> - "Those who cannot remember the past are condemned to repeat it."1—George Santayana | 1.23 | 
| Flat Networks Fail Catastrophically | A “flat” network offers little or no internal filteringat OSI Layers 2 (DataLink), 3 (Network), and 4 (Transport) <br> - Simply separating systems on VLANs (Virtual LANs, discussed later in 530.1) does notaddress this issue <br> - There must also be ACLs (Access Control Lists), firewall rules, etc <br> - Note that VLANs are certainly a good idea, but filtering must also take place.<br> A flat network allows an intruder to reach a large number of other systems <br> - For example, if an intruder can compromise one system and then scan TCP port 445(SMB) on hundreds or thousands of others, that network is too flat.<br> These networks fail catastrophically because one compromised system canendanger many others.<br> Segmentation across hybrid networks is required to address this risk. | 1.24 | 
| Presumption of Compromise | <br> Network defenders should always operate under the presumption of compromise<br> - Assume something on the network is already compromised<br> - This forces us to architect and engineer with a different mindset, one focused on anticipating, containing, and limiting damage. <br> *Preventive controls will fail in the face of a persistent adversary* <br> - "Three words sum up my attitude toward stopping intruders: prevention eventually fails."1 —Richard Bejtlich, the Tao of Network Security Monitoring | 1.29 | 
| Ruthless Prioritization and Disrupting Attacker’s ROI| Ruthless prioritization is the practice of taking the most effectiveactions with the fastest time to value first. This means looking for **blue/red asymmetries**: actions that disrupt real world attacks and offer a great bang for the buck for defenders. This can include using *traditional network and application controls in new zero-trust like ways, and adopting new data-centric, privilege reduction* focused controls. | 1.31 | 
| Identify and Prioritize Critical Assets | What are you trying to protect?Answer can’t be everything. <br>A security architect needs to understand the mission(s) of theorganization, value chain1, and work with business owners toidentify the associated critical assets needed to support them. <br>Create a list of defensible assets and classify themfrom most critical to least critical. <br>If your organization has a BCP, start there. <br>Consider how critical data flows acrossdifferent network zones and user tiers. <br>Align different security levels to zones and tiers. | 1.32 |
| Practical Threat Modeling Think Red, Act Blue | • To anticipatethe adversary, we need to determine the characteristics of the adversaries that could be expected to target our systems so we can define and implement effective architectures and controls.• Purple teaming (think red+ act blue) facilitate this by working together through simulation of specific threat scenarios. | 1.33 | 
| MITRE ATT&CK Matrix | Provides a common languageto describe adversarial tacticsand techniques<br>Applicable to realenvironments, allow mappingthe attacker’s behaviors todefenses<br>Go-to model to plan andverify purple teamingexercises | 1.34 |
| Think Red – Identifying the Adversary | A vulnerability can’t be exploited without a threat.<br> MITRE ATT&CK provides a public repository of threat groups including “intent” and “capabilities.”<br> Helps us to focus on risk; focus on capturing credentials authorized to access email and other nonpublic correspondence. |1.35|
| Act Blue – Identify Mismatches Between Adversary and Organization’s Strategy | Using MITRE ATT&CKNavigator,1we canoverlay attacker’s TTPswith our organizationalcapabilities forvisibility and detection.•Identifying gaps incoverage allow us toprioritize defensivestrategy based onthreat intel data.| 1.36|
| Practical Threat Modeling w/ DeTT&CT | DeTT&CT is an open-source framework to manage, assess, and compare the quality of data sources, visibility, detection, and threat actors.•Consists of a Python tool, YAML administration files and a built-in web-based editor | 1.37 | 
| Security Models, Standards, Frameworks, and Best Practices | Following references like models, standards, frameworks, and best practices minimizes the possibility of missing or forgetting a component in a security architecture. •They also provide a common language that helps to explain your decisions.•What security architecture framework should I follow?•Let’s consider some of the existing ones—strengths and weaknesses—including the new (?) zero trust model | 1.41 |
| Security Architecture Frameworks | TOGAF, SABSA, O-ESA, and OSA....Most of these references focus on the WHATvs the HOW. | 1.42 | 
| Time-Based Security | Reproducible method to understandhow much security a product ortechnology provides <br> How long are systems exposed? <br> How long before we detect a compromise? <br> How long before we respond?<br>**P–** how long our protectionworks <br>**D–** how long it takes us to detect<br>**R–** how long it takes us to react | 1.44 | 
| Kill Chain |  aka Intrusion Kill Chain is amodel designed by Lockheed Martin.  The metaphor: if you break the chain before the end, the attacker fails <br> The Kill Chain is (often) applied inthe context of malware and perimeter defenses...*Many criticize it for this reason*. <br> Can also be applied toother contexts, and the metaphor is quite useful.•The steps are:**Reconnaissance**-**Weaponizationo**-**Delivery**-**Exploitation**-**Installation**-**Command and control**-**Actions on **objectives**<br> | 1.46 |
| Kill Chain Countermeasures | Lockheed Martin also describes countermeasures that may perform the following actions:<br>-**D**etect<br>-**D**eny<br>-**D**isrupt<br>-**D**egrade <br>-**D**eceive | 1.47 |
| Architecting for Visibility and Detection – Different Needs | Most prevention and detection-oriented tools make poor threat hunting solutions<br> - Why?•**Prevention and real-time detectionare focused on low FPs**<br> - Hunting solutions rely on visibility and should be optimized for low FNs<br> - Detecting or doing triage is reactive. ***Threat hunting is proactive.*** | 1.49 |
| Zero Trust Model | Forrester’s original Zero Trust Model (2010) removes the concept of "internal is trusted, external is not."•It requires an organization to: <br> ...go through a state of transformation by ***eliminating the idea of a trusted network*** regardless of whether it is an internal or external network, and ***redesigning networks from the inside out***. In the Zero Trust Model of information security, we ***assume that all traffic is untrusted***. This approach demands that you build security into the DNA of your IT architecture. <br> This new model was officially published in NIST SP 800-207 in late 2020. | 1.51 | 
| US Government – Embracing a Zero Trust Security Model | Breaches like Solarwinds1have moved the US federalgovernment to make a major push to promote ZTadoption, releasing specific guidelines, including: •DISA Zero Trust Reference Architecture<br> NISTSP 800-207 on Zero Trust Architecture <br> •NSAEmbracing a Zero Trust Security Model<br>CISA Zero Trust Maturity Model <br> •While applicable to US government agencies, allorganizations will find these guidelines beneficial. | 1.53 | 
| CISA – Zero Trust Pillars and Maturity Model | •Updated in 2023, itincludes five pillars andthree cross-cuttingcapabilities, based onthe foundations of ZT,describing one of manypaths that anorganization can take indesigning andimplementing theirtransition journey toZTA. | 1.54 | 
| Zero Trust Architecture Design Principles, *NSCS* | 1.Know your architecture, including users, devices,services, and data <br> 2.Know your user, service, and device identities <br> 3.Assess your user behavior, devices, and services health <br> 4.Use policies to authorize requests <br> 5.Authenticate & authorize everywhere <br> 6.Focus your monitoring on users, devices, and services <br> 7.Don't trust any network, including your own <br> 8.Choose products and services designed with zero trustin mind where possible | 1.56 |
| Zero Trust Through the ‘Stained Glass-Windows of Vendors Marketing’ | Forrester acknowledged, Zero Trust hasbecome a marketing ploy instead of what *it really is: a strategy to reduce implicit trustthroughout the enterprise*. <BR> A**as a model for information security, ZeroTrust translates to a data-centric networkand security architecture,** one that can beworked toward but without an ultimate end state. Many already have technologies in placethat can be leveraged toward achieving ”less implicit trust” over time. | 1.58 | 
| Implementing Less Implicit Trust | This can seem intimidating for companies that still use the "candy bar" design; here is one way to start <br> **1.** New projects/technologies: use Zero Trust. **2.** Look for “easy wins” to convert existing technologies to a Zero Trust mindset. **3.** Replace legacy technology over time.<br> As NCSC acknowledges, following ZT principles is the ideal approach when choosing new services or building a network from scratch, but this may not be possible for an existing network where legacy systems are in use. | 1.59 | 
| Zero Trust – A Journey Over Time | Slide with task items in gant chart under Discovery, Assesment, Baseline, Intermmediate, Advanced - Aligned to DARIOM model | 1.6o |
| Defensible Security Architecture Life Cycle-  DARIOM Model | Based on practical models-Focused on implementing “realsecurity” mitigations vs.architecture design-Allows to secure already existinginfrastructure  (redesign)-Aligned to modern securityoperations practices-Risk-driven: focused on mitigating impact for threats you are facing already (or will soon) | 1.62 | 
| Defensible Security Architecture Life Cycle- DARIOM Model | Based on practical models-Focused on implementing “real-security” mitigations architecture design-Allows to secure already existing infrastructure (redesign)-Aligned to modern security operations practices-Risk-driven: focused on mitigating impact for threats you are facing already (or will soon) | 1.62 | 
| Discover and Assess - DARIOM | - Identify requirements, business and regulatory -HIPAA, PCI, SOX, GDPR, etc. Leverage BCP and GRC documentation. <br> - Identify assets in scope (data, users, devices) and how data flows.- Understand business and risk appetite. <br> - Identify resources available: tools, budget, personnel, skills, time.- Practical threat modeling and risk analysis <br> -Attack surface analysis, data flow and egress analysis, network visibility analysis, and protocol visibility analysis -Red teaming: impact analysis (think offensive), realistic scenarios based on attacker’s TTPs | 1.63 |
| Attack Surface Analysis | Attack surface describes all the vectors for exploitation...surface of a house (risk of theft of belongings): the doors, windows, vents, chimney, etc. <br>  Attack surface of a network: internet connections, extranet connections, mobile devices, physical access, etc. •Organizations should conduct a formal attack surface analysis and document the results. <br> Then seek to lower the attack surface where possible. <br> This includes network attack surface, software attack surface and human attack surface. | 1.65 | 
| Egress Analysis | Most organizations have spent time performing ingress analysis.<br> - Designing systems that prevent and/or detect unauthorized/malicious person/software from getting into a system or network.<br> - A required part of the network attack surface analysis process•How many have performed egress analysis?<br> - Designing systems that prevent and/or detect unauthorized/malicious person/software moving data out of a system/network<br> - Presumption of compromise: if the network is already owned, we should analyze the available vectors to push data out.<br> - Also known as “exfiltration analysis” or “extrusion analysis”<br> - Check ‘egress-analyzer’ | 1.66 |
| Network Visibility Analysis | involves identifying any network “blind spots” for NIDS, NIPS, full packet capture, NetFlow, etc. • Client access networks are common examples: Attacker pivots from one endpoint to another, with no sensor nearby to detect it. Note that a combination of network and host-based controls can also mitigate this risk, as we will discuss later in Security 530. The endpoints themselves can also provide additional visibility via logging. | 1.67 | 
| Protocol Visibility Analysis | goal is to become aware of all the protocols being used on a network and describe their business purpose - "My challenge to students is: collect 5 minutes of network traffic from your home network and try to explain every packet" —Dr. JohannesUllrich•Process: capture traffic at various network locations - Then analyze with Wireshark and find the outliers by applying lots of "not" display filters - "not http and not ftp and not smb" .. - Fun filter: "not ip" | 1.68 | 
| Redesign, DARIOM |  Identify desired state, determine the gap (current vs. desired) and roadmap; - Architectural decisions, Threat focused, covering protection, detection, and reaction; - Risk mitigation: -**People**-**Processes**-**Technology**; - Documentation | 1.69 | 
| Implement, DARIOM | Implement based on security architecture design; Harden at each layer, Network-centric, -Data-centric;  Enable logging for monitoring;   Determine baseline: Device configurations and traffic flows; Validate implementation | 1.7o |
| Operate and Monitor, DAROM |  Continuous security monitoring-Data at rest: registry keys, windows event logs, DNS, etc.-   Network security monitoring-Data in motion: NetFlow, transactional, pcaps-   Continue creating awareness, maintaining threat-focused operations, and augmenting visibility based on threat intel and IR lessons learned | 1.71 | 
| Defensible Security Architecture, Beginning at Layers 1 and 2 | begin implementing ‘less implicit trust’ from the ground up • Before we begin, let's consider a winning defensible security architecture mindset: Build security at every layer; Build it once, build it right; If there is a simple, low-risk solution to a potential security risk, deploy it; Then apply it to a large number of systems using IaC if possible; Architect for visibility, extending protection time, reducing time to detect and respond; Use our DA-R-I-OM method. | 1.75 | 
| Discover and Assess on 530.1 – Physical. |   Physical inspection.  Annual assessment.  Can you get a badge issued from an email?.  What could a janitor with a laptop do?.  How far in can a person wearing a FedEx outfit get to?.  Obtain written permission! | 1.76 |
| Physical, Threat | Network Cabinets, Backuptapes, Server Rooms, USB, Dropboxes/devices lan turtle, OMG-Cables, rouge devices, multitool devices like flipper zero | 1.78 | 
| Layer 1: Physical  Access | •Securing Layer 1 requires securing physical access to the network, systems, and facilities.•Most commercial office buildings offer weak physical security.•Office personnel can also be tricked into allowing black hats to enter via social engineering attacks.•One common targeted physical attack: gain temporary access to an office and deploy a penetration testing drop box | 1.79 | 
| Weaponized Keyboards.  | Rubber Ducky example, is USB keyboard in the size/shape of USB thumb drive; can be loaded with payloads that are able to typecommands on a logged-in computer.  Commands may include: Disable the firewall and antivirus.Surf to a website, download a malicious payload, and execute it. <br> The newest Rubber Ducky ships with a major upgrade tothe DuckyScript programming language, which is usedt o create the commands that the Rubber Ducky willenter into the victim machine. | 1.8o |
| USB Keyboard Mitigations Are Limited | USB devices have PIDs (Product IDs) and VIDs (Vendor IDs). - In theory, devices could be restricted to using approved PIDs and VIDs. <br> Unfortunately, these can also be spoofed by the USB devices. <br> This is still a reasonable mitigation, since the attacker would need to know the approved PIDs and VIDs in use.•For very secure sites, USB devices are designed to have a unique serial number. <br> Unfortunately (again), the serial number is usually left blank on most USB keyboards.•For sites requiring high security, mitigations include facility security and physically blocking USB devices. <br> These sites may also purchase USB keyboards with populated serial numbers and then lock down systems to allow those serial numbers only. | 1.81 | 
| Layer 1 Mitigations | •Pen testing drop boxes require (temporary) physical access. oWired Ethernet versions also require finding (or reusing) an open network port, ideally in a hidden area such as a closet. •Strong Layer 1 and Layer 2 defenses are the best mitigations for penetration testing drop boxes, RubberDucky attacks, etc. oMaintain physical security of the facility. oDisable unused switch ports and place them on a disabled VLAN. oUse MAC address filtering, 802.1X, or NAC. oWe will discuss the Layer 2 mitigation options later in 530.1. | 1.82 |
| Redesign and Implement on 530.I – Physical  | The application of the defense-in-depth principle to the protection of systems is enhanced through the use of successive layers of physical security (Australian Gov. September 2023). This includes: Color-coding and good quality cables; Tracking of all staff, visitors, and contractors with access to IT equipment; Secure doors, badge plus code, or biometric for restricted areas (no visitors); Processes including background checks for all staff with access to those areas, including janitors and contractors; SANS paper on Physical Security and Why It Is Important | 1.83 | 
| Wireless, Layer 1 |  Multiple forms of wireless network communication; 802.11 – Wireless standards and Wi-Fi technologies; Bluetooth– Low-bandwidth, short-range; Zigbee– Low-power, low-bandwidth, short-range; Z-Wave– Low-power, low-bandwidth, short-range; Cellular– Mobile networking over a wide area; Infrared– Short-range communication (cannot penetrate walls); Radio-frequency identification (RFID) – Active or passive short-range communication often used for inventory or badges | 1.84 | 
| Wireless Risk | What is the real risk?; Logic: Hacker must be physically present; Truth: Physical access is not required. <br> Consider the Internet of Things.; Security cameras (802.11, infrared, and wired); Neighbors wired internet-facing camera is compromised; Wireless interface can be used to find additional victims.; Mobile phones (cellular, 802.11, Bluetooth, and infrared); Employees will bring infected phones within range of corporate wireless | 1.85 |
| Wireless Intrusion Prevention System (WIPS) | An "evil twin" is a rogue access point masquerading as a legitimate access point (AP).; Possible by spoofing the BSSID of legitimate AP; May include denial of service against legitimate AP; Often combined with Machine-in-the-Middle attacks and phishing. <br> WIPS offers the ability to detect and protect against rogue access points; One or more radios scan for nearby wireless devices; May require a scheduled scan on older devices or continuous mode on new devices; May combine wireless scan information with wired scan information; Report and alert on rogue devices.; May deauthenticate clients or rogue APs (beware legal ramifications) | 1.86 | 
| WPA3 Enterprise – WPA2 + PMFs + Stronger Ciphers | WPA3 Enterprise (announced in 2018), buildsuponWPA2 and it is meant to replace it in thefuture. It’s the first major update to Wi-Fisecurity since 2004.; Includes better authentication, increasedcryptographic strength, and the use ofProtected Management Frames (PMFs) toincrease network security.; There’s optional 192-bit security. All involvedparties need to support 192-bit security mode,or no connection will be established.; Commonly placed in high-security Wi-Finetworks such as in government, defense,finance, and other industries.; Follows a similar process as the one in WPA2,enhanced due to stronger ciphers | 1.88 | 
| Guest Access | Guest access could require no authentication and the internet only.•But likely need a terms and conditions page to limit liability"Special guests" such as vendors may need internal access.•A common practice to use WPA2 with PSK for vendor SSID•This often is not secure enough. PSKs tend to be shared with the world.•An alternative is to create temporary accounts per guest user.•Most wireless solutions also support custom registration pages.•A form asks about who is requesting access and for what purpose.•Details of the form and approval grant dynamic access. **Remember to disable management services on guest interfaces! ** | 1.9O |
| Station Isolation |  Many corporate wireless solutions offer station isolation: a client on a wireless access point may speak to the AP (which is also a switch and a router) only. Clients may not access other clients on the same AP.Station isolation is also called client isolation.Default behavior between vendors varies.; Guest networks should have station isolation enabled. - Prevents infections from spreading from guest to guest; Highly recommend enabled for all wireless access | 1.91 | 
| Potential Issues with Station Isolation | Station isolation may create problems in some environments where wireless clients send traffic to each other on the same Layer 2 LAN. - Station isolation on a home network would mean a wireless laptop would not be able to connect to other wireless devices. - Smart TVs, AppleTV, Roku, Amazon FireTV, Chromecast, etc. - This is (usually) an issue unique to homes and small/simple wireless networks, which is why most do not employ station isolation.•This form of wireless/wireless client access is less common in well-designed corporate networks. - We'll discuss corporate networks shortly. | 1.93 | 
| Securing Zigbee | operates in one of three modes:<br> Unsecured Mode –No security enabled<br> Access Control List (ACL) Mode – MAC-based access control<br> Secured Mode –Uses a combination of:<br> Access Control – Uses MAC address<br> Frame Encryption – Encrypts frame using AES symmetric key<br> Frame Integrity – Prevents frame from being altered in transit<br> Sequential Freshness – Countermeasure against replay attacksLow-level security is part of IEEE 802.15.4.High-level security is part of the ZigBee standard | 1.94 | 
| Redesign and Implement - Wireless | Move to WPA3-Enterprise, segment with station isolation and guest management.•Private cellular (LTE/5G, CBRS and ‘5G LAN’) for IoT use cases1 are growing in adoption among manufacturing, warehouses, healthcare, schools and municipalities.•Shared responsibility model (i.e., who is responsible for encrypting and where?) | 1.95 | 
| Discover and Assess on 530.1 – Switches | Common basic issues relatedto switches (routers too): Secure administration; Services offered; Vulnerabilities; ACLs; Banners; Logging; Authentication, authorization, and accounting | 1.98 |
| Threats on 530.1 – Switches|  MAC flooding attacks; 802.1Q and ISL tagging attack; Double-encapsulated 802.1Q/VLAN hopping; ARP attacks; Private VLAN attack; VLAN trunking protocol attack; Multicast brute force attack; Spanning-tree attack; Random frame stress attack | 1.99 |
| Hardening Against Layer 2 Attacks: CDP | Cisco Discovery Protocol (CDP) is a Layer 2plaintext broadcast protocol designed for troubleshooting. - It allows Cisco devices to “see” each other.<br> CDP leaks a lot of critical information toevery system on the subnet.<br> CDP should be disabled unless expresslyrequired.<br> Cisco IOS command to disable CDP globally:o Router(config)# no cdp run<br> CDP may also be disabled per interface:o Router(config-if)# no cdp enable | 1.1OO | 
| MAC Spoofing | Slide shows example | 1.102 | 
| Port Security | Layer 2 port security can be used to mitigate these risks.•Additionally, port security can mitigate the risk of rogue devices.oMany incidents begin when a pre-infected device such as a laptop is plugged into a switch.oIt then normally requests and receives a DHCP addresso...and then begins attempting to infect every machine it can reach.•Mitigation with port security uses hardcoded MAC addresses or 'sticky' MAC addresses.•Stronger mitigation is possible with 802.1X and NAC (Network Access Control), covered later in the course. | 1.103 | 
| Hardcoded MAC Addresses | One simple (but high-maintenance) option is to hard code theMAC address of each connected system.oUnused ports should be “shut down,” requiring enabling on the switch before they may be used. Sample client configuration: <br> interface FastEthernet0/5 switchport access vlan 10 <br> switchport mode access <br> switchport port-security <br> switchport port-security mac-address 0021.61ae.1e01 <br> switchport port-security violation shutdown | 1.104 | 
| MAC Limiting and Sticky MAC Addresses | MAC limiting limits how many MAC addresses may be associatedwith one port.•Sticky addresses mean the switch will learn the MAC address ofeach connected system and automatically add them to therunning configuration .interface FastEthernet0/5 switchport port-security;  switchport security max-mac-count 1; switchport port-security mac-address sticky | 1.106 |  
| Layer 2 Attacks: ARP | ARP maps Layers 2 to 3 addresses.<br> Unlike CAM overflow and MAC spoofing (which target switches), ARP attacks target end systems.<br> Some of the worst internal attacks feature ARP spoofing and ARP cache poisoning; ARP spoofing remaps an IP address to a new illegitimate MAC address; ARP cache poisoning tricks a system into caching the spoofed ARP entry.<br>ARP spoofing requires local Layer 2 (LAN) access, which makes many sites consider these attacks low probability (and therefore low risk); The reality is that sites may be one click away from an infected host; If an attacker can escalate privileges to root or administrator/system, they may attempt ARP spoofing; Machine-in-the-Middle (MitM) is a common attack: remap the default gateway to another host; New (bogus) gateway knows where the real one is and can pass traffic accordingly | 1.107 | 
| ARP: A Trusting Protocol | Dynamic ARP uses no authentication or encryption.oIt trusts whatever answer is provided, which is common for Layer 2protocols. | 1.108 |
| Dynamic ARP | uses no authentication or encryption.oIt trusts whatever answer is provided, which is common for Layer 2protocols. | 1.108 |
| ARP Spoofing Tools and Mitigation | The most common ARP spoofing tool is Ettercap but there aremany other projects like larp.  They are all quite easy to use.•Switch-based ARP spoofing mitigations include:oDynamic ARP Inspection (DAI)•DHCP snooping creates a binding database of valid MAC/IP pairs it learns by trackingvalid DHCP traffic.•Dynamic ARP Inspection checks this database before forwarding ARP responses.•Port security can also mitigate the impact of an attacker trying tointercept client communications (MitM) using a combination ofDHCP starvationand DHCP rogue server attack. | 1.11O | 
| ARP Spoofing Tools and Mitigations | Ettercap or Larp.  Switches: Dynamic Arp Inspection (DAI), Port Security, DHCP Starvation, and DHCP Rouge Server attack | 1.11O | 
| DHCP Starvation | An attacker may attempt to request all  available DHCP addresses.oThis is called a DHCP starvation attack, which often leads to a rogue DHCP server attack; Most DHCP servers have a fairly small pool of addresses (often less than 255).oOnce all leases are claimed, the DHCP server will not be able to offer new leases until the old ones expire. | 1.111 | 
| Rogue DHCP Server | often follows A DHCP starvation attack.•Once the real DHCP server is out of leases, a rogue server canthen serve addresses as well as additional information.oIncluding the default gateway, DNS, etc.•This makes launching Machine-in-the-Middle attacks quite easy.•It also allows the rogue server to send clients forged DNSresponses, directing clients to malicious sites. | 1.112 | 
| Mitigations: DHCP Attacks | DHCP snooping filters DHCP requests sent to untrustedinterfaces.oThis mitigates the rogue DHCP server attack.•To enable it on a switch:#ip dhcp snooping•Configure a trusted interface (the DHCP server interface):#interface FastEthernet0/5#ip dhcp snooping trust...Then enable DHCP snooping non-DHCP server VLANs:#ip dhcp snooping vlan 53o |1.114 | 
| Private VLANs (PVLANs) | Private VLANs are (usually) one of the easiest “wins” anorganization may achieve for making pivoting more difficult to anattacker.o“Pivoting” describes the act of “moving behind enemy lines,” whenmalware (or a person) moves from one compromised internal host toanother host.oLots of malware will attempt to pivot from one client PC to another.•A private VLAN is the wired equivalent to wireless stationisolation.oIf this makes sense for wireless clients, why not wired?| 1.118 | 
| Potential Issues with Private VLANs | In the enterprise, these issues sometimes come up (most haveworkarounds).oPoorly designed networks that intermingle clients and servers on thesame LAN/VLANoPeer-to-peer client traffic•Some audio and video chat systems work this way.•Enterprise solutions can use gateways.oSome commercial products, can send updates between clients (in peer-to-peer fashion).oWindows 10 has a peer-to-peer patching mode.•Designed for informal workgroups and not recommended for the enterprise | 1.12o |
| Types of Private VLAN Ports | Promiscuous o Able to send traffic to any device on the VLAN o Normally includes the default gateway•Isolated o May only communicate with promiscuous ports o Cannot send traffic to other ports•Community oMay send traffic to promiscuous ports or other community ports o Cannot send traffic to isolated ports | 1.121 | 
| Primary and Secondary VLANs | Private VLANs support primary and secondary VLANs.oAll systems on the LAN are part of the primary VLAN.oSystems may also be part of secondary VLANs, such as isolated or community VLANs.| 1.123 | 
| Private VLAN FUD | Some network engineers will resist private VLANs, often claiming they require a lot of work.oThis is normally FUD (Fear, Uncertainty, and Doubt).oThe most damaging phrase in the language is “We’ve always done it this way!”—Rear Admiral Grace Murray Hopper•Many believe (falsely) that private VLANs require creating hundreds or thousands of VLANs (one for each client).oYou may create a single client VLAN, configure it to be private, and place hundreds or thousands of clients on that single VLAN.oPVLANs may be trunked with VTP 3 (see notes).•Testing is certainly required, as discussed previously.oHowever, enabling them is simple. | 1.125 |
| Network Flows | network flow is a log of connections between systems. | 1.128 | 
| Flow Data Sources | **Traditional:** Direct from network equipment; Switches/Routers/SDNs; NetFlow/sFlow/JFlow/IPFIX; Firewalls; VPN appliances; Hypervisor networking; Includes cloud flow generation; Example: Amazon VPC Flows or Azure Network Watcher.  <br> **Untraditional**: Generate flows from network monitoring; Suricata; Zeek; PacketbeatsGenerate flows from endpoints; Packetbeats; Sysmon | 1.129 | 
| Why Flow Data? | Flow data summarizes network traffic; Beyond network summary data, it allows for creating utilization graphs at Layers 2–4; Also helps identify "top talkers" at various layers, and helps understand and baselinenormal network applications and servicesoHelps trained analysts spot Denial-of-Service (DoS) attacksoCan detect network anomalies, including malware beaconing, data exfiltration or lateralmovement<br>Flow data is able to summarize encrypted traffic (since it doesn't inspect thepayload data).<br>Flow data helps achieve the goal of "Know Thy Network."oIn the right hands, flow data is a form of anomaly-based Intrusion Detection System | 1.13O | 
| NetFlow | NetFlow is a proprietary standard created by Cisco that summarizes network traffic, based on frame and packet headers.•NetFlow is V9 (also branded as Flexible Netflow or FNF); Data reported/included Byte and packet counts; ProtocoloSource and destination addresses (IPv4 and IPv6) and netmasks; IP and TCP flags, TCP and UDP ports and ICMP types and codes; Interface used; BGP information including Autonomous System, ect... <br> IPFIX, an open standard often referred as Netflow v10, has grown as a popular alternative to Netflow. Cisco's IOS-XE based platforms now support both FNF and IPFIX.| 1.131 | 
| Flow Planning | Careful planning is needed to stop duplicate flow creation. | 1.133 |
| Configuring NetFlow Exporters | syntax for setting up Cisco NetFlow exporter: <br> **(config)# ip flow-export destination netflow.sec530.com udp-port 2055** <br> **(config)# ip flow-export version 9** <br> Then configure each interface to export NetFlow: <br> **(config)#interface GigabitEthernet0/0** <br> **(config-if)#ip flow egress** sends outbound interface traffic, 'ingress' sends inbound•Linux syntax is in the notes. | 1.134 |
| Cloud Flows | Infrastructure-as-a-service (IaaS) may support exporting flow data.•Export process different than traditional flowsAmazon supports VPC flows. Requires flows to be exported to CloudWatch1•Or an S3 bucket2•Most SIEM solutions natively read files from S3.•Scripts capable of reading for manual analysis•Google and Azure both support network flows as well (see notes) | 1.135 | 
| Suricata Flow | Suricata is an intrusion detection system that is also capable of network security monitoring (NSM); **Flow generation** is a key component of its capabilities.Flows can be generated unidirectionally or bidirectionally.**Unidirectional** means source -> destination and destination -> source are two flows. **Bidirectional:** means source <-> destination is one flow.Requires port mirroring or network taps | 1.137 | 
| Suricata BPF Filtering | Software controls exceptions. *see slide for example* ; Easy to ignore hosts; Easy to ignore networks; Easy to ignorecombinations of things; Allows eliminating duplicates | 1.138 | 
| Filtering Flows | **Traditional:** To lower chance of duplication;  Limit flow collection points;  Design for ingress or egress;  Use SDN fabricsTo eliminate storing duplicates;  Purchase commercial solution;  Send flows to it.  **Untraditional:** Software flows;  Conditionally log flow dataEndpoint flows;  Conditionally log flow data | 1.139 | 
| Flow Components | Flow data requires the following components:; **Flow exporter** Switch, router, firewall, system, and so on that sendsflow records to a collector; **Flow collector** A system that collects flow records; Examples include fprobe, nprobe, and SiLK.; **Flow analyzer**; A system that analyzes and displays flow data; Examples include NfSen and ntopng.; **Some software offers combine flow collector andanalyzer functionality.;** Examples include SolarWinds and Scrutinizer. | 1.14O | 
| NfSen NetFlow Analyzer | NFdump collector and NfSen NetFlow analyzer are one set of open-source options. NfSen relies on RRDtool for generating the graphs, which is why the graphs shown above may look familiar to those who have used RRDtool (Round Robin Database Tool, available at: https://oss.oetiker.ch/rrdtool/). The NfSen General Overview Page is shown above. | 1.141 | 
| ntopng | offers one of the easiest installations of the various free options. Installing on Ubuntu Linux is a breeze. The ntopng package repository is here: http://packages.ntop.org/ntopng requires PF_RING. ntopng will automatically collect local flows and uses nprobe to collect remote flows. Packages for PF_RING, ntopng, and nprobe for various operating systems are available at the repository linked above. | 1.142 |