| Keyword | description | Page |
| --- | --- | --- |
| APT28 exploits |  known vulnerability to carry out  reconnaissance and deploy malware on Cisco routers | 2.5 | 
| SNMP vulnerability (CVE-2017-6742) | April 18, 2023, the UK National Cyber Security Centre (NCSC) along with the United States FBI, NSA, and CISA published a joint advisory describing how state-sponsored cyber actors were able to successfully exploit  | 2.5 | 
| Cyclops Blink | Modular Malware deployed by Threat Actor, Sandworm. Previously the same group had been deploying VPNFilter, a modular malware launched against Ukranian’s routers that can steal data, disrupt traffic, and even launch denial-of-service attacks | 2.5 |
| VPNFilter | a modular malware launched against Ukranian’s routers that can steal data, disrupt traffic, and even launch denial-of-service attacks. VPNFilter was first discovered in June 2018, and affected over 500,000 devices worldwide, and it is still active today Launched by Sandworm | 2.5 |
| Interior Gateway Protocols |  are used internally across privately owned networks, such as WANs. Common examples include OSPF (Open Shortest Path First), EIGRP (Extended Interior Gateway Protocol), and IS-IS (Intermediate System-to-Intermediate System). Legacy examples include RIPv1 and RIPv2 (the Routing Information Protocol), Note that RIP is a legacy protocol with a number of flaws and shortcomings, and its use should be avoided. | 2.8 | 
| BGP | is the primary EGP (Exterior Gateway Protocol), which may be used either internally or via the internet. BGP can only support MD5 by design; Organizations managing their own Autonomous Systems (AS) should mitigate BGP prefix hijacks with Resource Public Key Infrastructure. NIST live RPKI monitor shows ~45% IPv4 prefixes comply with RPKI in 2023. | 2.8,9 | 
| IPv6 |  the next-generation IP protocol, has routing protocols adapted from IPv4 or developed specifically for it, like RIPng (RIP next generation), an adaptation of RIP for IPv6, and OSPFv3, an evolution of OSPF for IPv6 support | 2.8 | 
| MD5, Routing | MD5 is available across most equipment but should be avoided in favor of HMAC-SHA-256 or HMAC-SHA-512 where supported (see DISA STIG reference below). <br> MD5 is vulnerable to "birthday" attacks and may be compromised, routing protocol authentication must use FIPS 140-2 validated algorithms and modules to encrypt the authentication key. This requirement applies to all IPv4 and IPv6 protocols that are used to exchange routing or packet forwarding information; this includes all Interior Gateway Protocols (such as OSPF, EIGRP, and IS-IS), MPLS-related protocols (such as LDP), and multicast-related protocols. BGP is excluded because it can only support MD5 by design | 2.9 |
| Routing protocol | designed with too much ‘implicit’ trust; Support plaintext or key (hash) authentication (BGP and EIGRP only allow hashed); Plaintext should be avoided (the key may be sniffed and reused); MD5 is available across most equipment but should be avoided in favor of HMAC-SHA-256 or HMAC-SHA-512 where supported (see DISA STIG reference below). BGP is excluded since it can only support MD5 by design. <br> Organizations managing their own Autonomous Systems (AS) should mitigate BGP prefix hijacks with Resource Public Key Infrastructure (RPKI – see notes). NIST live RPKI monitor2shows ~45% IPv4 prefixes comply with RPKI in 2023. | 2.9 | 
| Neighbor authentication, Routers |should be in place to avoid unauthorized routing updates; Without neighbor authentication, a properly positioned attacker could inject bogus routes; This would make Machine-in-the-Middle (MitM) attacks easy to accomplish. | 2.9 | 
| HMAC-SHA-256, Rtrs | is available on some equipment for EIGRP and OSPFv2 (beginning with Cisco IOS 15.4T). | 2.9 |
| Resource Public Key Infrastructure (RPKI) | organizations can mitigate the risk of BGP prefix hijacking using Resource Public Key Infrastructure (RPKI). Without RPKI, Internet routing depends on the trust of the network operators advertising the correct IP prefixes they manage; the trust-based model opens the door to malicious BGP hijacking that allows traffic interception and monitoring, as well as spoofing legitimate IP addresses for spamming.  RPKI mitigates this by leveraging semi-public databases, Regional Internet Registrar (RIR), used by network operators to register their assigned Internet resources; RIR uses  authentication and cryptography... **PKI for BGP**  | 2.10 | 
| Regional Internet Registrar (RIR) | Using root certificate generates signed certificate for a Local Internet Registry (LIR, a.k.a. a network operator) with all the resources they are assigned (IPs and ASNs). The LIR then signs the prefix containing the origin AS that they intend to use: a ROA (Route Object Authorization) is created. **ROAs are just simple X.509 certificates.** ROAs are the equivalent to TLS certificates in the Internet routing world. In order to track the emitted certificates in the RPKI, Certificate Transparency Log  servers are used. | 2.10 |
| Local Internet Registry | (LIR, a.k.a. a network operator) with all the resources they are assigned (IPs and ASNs). The LIR then signs the prefix containing the origin AS that they intend to use: a ROA (TLS Cert) | 2.10 | 
| Route Object Authorization (ROA) | Used by Local Internet Registry (Network Operator) equivalent to TLS certificates in the Internet routing world. In order to track the emitted certificates in the RPKI  Certificate Transparency Logs are used | 2.10 |
| BGPStream | cisco managed live view of BGP events | 2.10 | 
| Certificate transparency | a great tool for detecting bad behavior in the RPKI because it keeps a permanent record of all valid certificates that are submitted to it in an append-only database that can’t be modified without detection. It also enables users to download the entire set of certificates via an HTTP API.| 2.10 | 
| wormhole attack | an attacker receives packets at one point in the network, “tunnels” them to another point in the network, and then replays them into the network from that point. Requires unauthorized access <br> hping could be used to diagnose the issue; this will show the initial TTL -3, while a regular ping would show the initial TTL -1:$ hping -S -p80 sensitive.sec530.com | 2.11,12 | 
| SNMP attack | if the attacker can guess the SNMP write string, they read type IOS 0 passwords, decode type 7 (Vigenère Cipher), or attempt to crack the IOS type 5, 8, or 9 passwords. | 2.11 |
| Layer 3 switch |  works much like a router because it has the same IP routing table for lookups and it forms a broadcast domain. However, the “switch” part of “Layer 3 switch” is there because:The layer 3 switch looks like a switch. It has 24+ Ethernet ports and no WAN interfaces.The layer 3 switch will act as a switch when it is connecting devices that are on the same network.The layer 3 switch is the same as a switch with the router’s IP routing intelligence built in.The switch works very quickly to switch or route the packets it is sent. | 2.14 |
| Switch and Rtr, Secure |  Secure/ Disable Aux Ports, Use TACACS+, Disable SSHv1 and force SSHv2. Never use telnet or any other plain text protocol. Cisco devices default to an RSA key size of 512 bits. Use a **2048- or 4096-bit key.** Set 'ssh authentication-retries' to 3, to make the device drop the connection after three failed logins. | 2.15 | 
|  Securing Switch and Rtr,|  Secure/ Disable Aux Ports, Use TACACS+, Disable SSHv1 and force SSHv2. Never use telnet or any other plain text protocol. Cisco devices default to an RSA key size of 512 bits. Use a **2048- or 4096-bit key.** Set 'ssh authentication-retries' to 3, to make the device drop the connection after three failed logins. | 2.15 | 
| ssh authentication-retries | set to 3, to make the device drop the connection after three failed logins. | 2.15 | 
| console/Aux port, secure |  Substitute “aux” for “console” to secure the AUX port:Router(config)# line console 0Router(config-line)# exec-timeout 5 0Router(config-line)# privilege level 15Router(config-line)# logging synchronousRouter(config-line)# login authentication local_authRouter(config-line)# transport output sshThis configures console sessions to timeout after 5 minutes, allow privileged access, send console logging messages only after “enter” is pressed, allow SSH connections from that session, and use local authentication (the authentication method is configured separately) | 2.15 | 
| telnet, secure | Never use via a network, The telnet protocol was developed as ’secret’ technology in 1969(!) beginning with RFC 15 to run on the pre-IP ARPANET, using a Layer 3/4 protocol called NCP (Network Control Protocol). | 2.15 | 
| TACACS (Terminal Access Controller Access-Control System) |  is a remote authentication protocol that provides centralized validation of users attempting to gain access to network resources. TACACS has undergone various evolutions, with TACACS+ being the most recent and widely used variant. | 2.15,16 | 
| AAA Server, Centralized | NSA recommends that all network devices should be configured to use centralized AAA servers. NSA recommends implementing at least two AAA servers to ensure availability and assist with detecting and preventing adversary activities. If one server becomes unavailable due to scheduled maintenance or for other reasons, the remaining servers will continue providing the centralized AAA services. (see notes for configuring | 2.16 | 
| legacy services, rtr/sw | disable fingerd – the finger daemon (fingerd is disabled by default in IOS versions 12.1(5) and 12.1(5)T)BOOTP– boot protocolCDP – Cisco Discovery Protocol (discussed later)PAD – Packet Assembler/Disassembler (PAD), used by X.25 networksMOP – Maintenance Operation Protocol (used by DECNET)no service config – disables loading configurations via TFTP (the Trivial File Transfer Protocol | 2.18 |
| fingerd, sw/rtr legacy svc | disable is a legacy service the finger daemon (fingerd is disabled by default in IOS versions 12.1(5) and 12.1(5)T) | 2.18 |
| BOOTP,sw/rtr legacy svc|  disable is a legacy service boot protocol | 2.18 |
| CDP, sw/rtr legacy svc | disable is a legacy service Cisco Discovery Protocol (discussed later) | 2.18 |
| PAD, sw/rtr legacy svc | disable is a legacy service Packet Assembler/Disassembler (PAD), used by X.25 networks | 2.18 |
| MOP, sw/rtr legacy svc | disable is a legacy service Maintenance Operation Protocol (used by DECNET)no service  | 2.18 |
| config, sw/rtr legacy svc | disable is a legacy service disables loading configurations via TFTP (the Trivial File Transfer Protocol) | 2.18 |
| Centralized Logging, Routers | Cisco routers can log messages in five different ways: Console logging, Terminal Loggin, Buffered Loggin, Syslog Svr Logging, SNMP Loggin | 1.19 | 
| Console logging, Cisco Rtr | By default, the router sends all log messages to its console port. Hence only the users that are physically connected to the router console port can view these messages. | 2.19 | 
| Terminal logging, Cisco Rtr | It is similar to console logging, but it displays log messages to the router's VTY lines instead. This is not enabled by default. | 2.19 | 
| Buffered logging, Cisco Rtr | This type of logging uses router's RAM for storing log messages. buffer has a fixed size to ensure that the log will not deplete valuable system memory. The router accomplishes this by deleting old messages from the buffer as new messages are added. | 2.19 |
| Syslog Server logging, Cisco Rtr | The router can use syslog to forward log messages to external syslog servers for storage. This type of logging is not enabled by default. | 2.19 | 
| SNMP trap logging, Cisco Rtr | The router is able to use SNMP traps to send log messages to an external SNMP server. | 2.19 |
| TLS for Syslog | should be used. This adds authentication to client and server, encryption of the data, and integrity verification.  Notice that in many cases, when TCP is used, if the logging server is inaccessible, or the TCP connection to the server cannot be established, the router, by default, will block ALL new connections. This behavior can be disabled if you enable **logging permit-hostdown** | 2.19 |
| Loopback Interface, Sw/Rtr | The loopback interface on a switch or router is used as a dedicated in-band management IP address.o In-band access is usually complemented with Out-Of-Band Management(OOB). Many vendors provide a separate management VRF, withseparate routing tables for management purposes.•Switch and router loopback interfaces are beneficial becausethese devices often have multipleinterfaces with IP addresses.•Assume an 8-interface router without a loopback interface:oIt could theoretically be managed via SSH through any of the interfaces.oACLs for controlling traffic from the router (such as syslog) can bechallenging to write since any of the eight interfaces could be the source. | 2.20 | 
| Secure Passwords, sw/rtr | Cisco recommends the use of individual local accounts for fallback purposes; Cisco devices support a variety of password types, with strengths rangingfrom none (plaintext) to poor (Type 7) to reasonable to strong.•The default password type is Type 0 (plaintext).  *Switch(config)# username user0 password Security530* Here is the resulting Cisco IOS configuration entry:username user0 password 0 Security530....**Do not use Type 7 passwords (Vigenère Cipher)** *they are extremely weak*.  In order of preference, use Type 9 (SCRYPT), Type 8 (PBKDF2), or Type 5(salted MD5) | 2.22 |
| Cisco Password Hashes | Cisco supports the following password hashes that offer more security <br>Fair: Type 5 (Salted MD5) <br> Better: Type 8 (PBKDF2 –SHA256) <br> Best: Type 9 (SCRYPT) <br> •Type 8 (PBKDF2-SHA256) and Type 9 (SCRYPT) password hashes were added to Cisco IOS 15 as of version 15.3(3)M3 (released in 2014); They are relatively new, and many organizations are unaware of them; Most sites use Type 5 (MD5), which is better than Types 0 or 7, but fairly weak today. <br> **Do not use Type 4; it is weaker than Type 5** Type 4 uses one round of SHA256 with no salt.1oThis option has been removed from recent versions of Cisco IOS. | 2.23 | 
|  Hashing for integrity | should be cryptographically strong andcomputationally inexpensive(fast) | 2.24 | 
| Hashing for passwords |  should be cryptographically strong andcomputationally expensive(slow). For Rtr Passwords, both PBKDF2-HMAC-SHA256 (Type 8) and SCRYPT (Type 9)are cryptographically strong <br> PBKDF2 is slow, while SCRYPT is even slower; Either is reasonable, and Type 9 is preferred; Historically p/w hashes were computationally fast, (md4/5) **Windows LanMan (LM) is based on MD4, for example.** <br> Modern password hashing algorithms are designed to punish password cracking. PHP versions 5.5+ use Bcrypt by default for this reason.| 2.24 | 
| password cracking speed | Speed comparisons of cracking common algorithms using an eight NVidia GTX 1080 rig:2Unsalted MD5: 200 billion hashes/secondLM: 148 billion hashes/secondUnsalted SHA1: 68 billion hashes/secondHashed MD5 (Cisco IOS Type 5): 79 million hashes/secondPBKDF2-HMAC-SHA256 (Cisco IOS Type 8): 9.4 million hashes/secondScrypt (Cisco IOS Type 9): 3.4 million hashes/secondBcrypt: 105,000 hashes/second | 2.25 | 
| Banners | Cisco switches and routers support the followingbanners: <br> **Login** (shown before all logins); <br> **Exec** (shown after all logins); <br> **MotD** (Message of the Day, shown before all logins except SSH,where it is shown after)•The login banner is the most critical, since it displays thebanner text before authentication is attempted. Cisco devices support narrower-use banners, including incoming (used with reverse telnet sessions) and slip-ppp banner (used with SLIP and PPP connections).| 2.26 | 
| Cisco Smart Install |  a plug-and-play configuration and image-management feature that provides zero-touch deployment for new switches. You can ship a switch to a location, place it in the network and power it on with no configuration required on the device. CVE-2018-0171 (released March 28, 2018) describes a remote code execution flaw in Smart Install. Smart Install protocol does not require authentication.  Patching mitigates CVE-2018-0171 , but not the authentication flaw.  • Filter TCP port 4786 and/or disable Smart Install. *Switch(config)# no vstack* <br> - Metasploit: *nmap -p 4786 -v <IP Address(s)> use auxiliary/scanner/misc/cisco_smart_install* | 2.27 |
| Sigma Analytics, Cisco  | • Cisco accounting command logs can be used to detect malicious and unauthorized activity.•This is usually accomplished by deploying TACACS+ Server and enabling AAA new-model.•Sigma (covered in 530.5) has detection analytics mapped to MITRE ATT&CK in their GitHub | 2.29 | 
| Sigma | a useful tool for sharing threat detection information, focused on detecting anomalies in log data such as computer processes, commands, and operations associated with malware or malicious tools. Sigma operates on threat data captured from various sources, while also enabling threat hunters to aggregate events which would otherwise be hard to detect through traditional methods. This means that threat hunters can derive actionable insights from high-fidelity data, and potentially catch an attempted attack earlier in the cyber kill chain. | 2.29 | 
| Cisco Guide to Harden Cisco IOS Devices | best one-stop shopping guide for securing Cisco ***switches and routers***  | 2.31 |  
| Cisco AutoSecure | Cisco's AutoSecure automatically configures a switch or router for a variety of best practices, uses single cli command to disable vuln ip services, enable defensive focused IP svcs, and simply and harden security configuration | 2.32-33 | 
| STIGs | DISA produces the Secure Technical Implementation Guides(STIGs).oThey are freely available and exhaustive in their coverage.•U.S. government and military personnel are usually quitefamiliar with the STIGs, but many private sector companies areunaware of them (and therefore don't use them).•Their guidance on switches and routers (and other devices) isconcise, direct, and actionable. | 2.34 |
| STIGS, Cisco | On slides, 10 High, Cat I; 31 Meduim, Cat II, 15 low, Cat III | 2.35-38 | 
| STIG, Cisco Password Config | SPecifies Password visibility, Example in notes, configures Type 5 passwords (so that plaintext Type 0 passwords are not shown in the configuration). While this meets the STIG requirements, Type 8 or 9 passwords would be even better | 2.36 | 
| CIS benchmarks |  CIS Benchmarks are high quality, provide specific syntax for performing each step, and are free. CIS has also reduced its formerly exhaustive list of benchmarks, moving many older ones to the unsupported list. Unfortunately. includes the Juniper JUNOS 8–10 benchmarks.  | 2.37 |
| CIS Benchmark, Cisco | See Slide | 2.37 | 
| CIS Level 1 and Level 2 Benchmarks | Level 1 benchmarks are universal best practices that should be followed in nearly all cases. Level 2 benchmarks provide meaningful security but could be problematic for some organizations or topologies. | 2.39 | 
| SNMPv3 CIS Benchmarks | They are level 2 because  organizations have legacy equipment that do not support SNMPv3. Requiring SNMPv3 would mean these devices could not be monitored via SNMPv3; could cause more security problems than it solves | 2.39 | 
| NTP Authentication CIS Benchmark | Level 2, due to older equipment and may cause more problems | 2.39 | 
| CIS's Router Audit Tool |  now end-of-life. Replaced by CIS-CAT Pro; $1,400/year for orgs w/ less than 50 employees. | 2.40 |
| Nipper | (formerly CiscoParse, now part of Titania) has split intotwo versions: Nipper and Nipper Enterprise (commercial) andnipper-ng (open source).oNipper can assess commercial routers and firewalls, comparing thecurrent configuration of a device to a known good configuration based onDISA STIGs, NIST, and other standards.onipper-ng code is available at: https://github.com/arpitn30/nipper-ng40 | 2.40 | 
| SNMP | is an often overlooked and highly dangerous protocol. SNMP version 2c is the most commonly deployed version, which uses plaintext community strings. These strings often zip around a network thousands of times per day, sent from network monitoring systems, often every five minutes to hundreds of devices, 24/7/365. | 2.47 |
| SNMP Community Strings | effectively passwords, default strings quite common, APT hit Ukraine using this | 2.47 | 
| SNMP Attack: community string guess, MSF | snmp_logon auxiliary metasploit script. It uses a 120-entry SNMP community string wordlist by default.  See Slide for command | 2.48 |
| SNMP Attack: Download the Cisco IOS Configuration | The screenshot shown above shows the Nmap running the NSE (Nmap Scripting Engine) script **'snmp-ios-config'**. | 2.49 | 
| snmp_logon aux scanner | metasploit module to brute force community strings | 2.48 | 
| SNMP, Hardening | SNMP is disabled by default on modern Cisco switches and routers, see commands on slide | 2.51 | 
| SNMP, Hardening steps | Disable SNMP if not required•If SNMP is required:oDisable SNMP write access if possible.oUse complex (or randomly generated) community strings.oUse SNMP version 3 on all supported equipment.oFor non SNMPv3-capable devices that require SNMP, use SNMP version 2c with access lists that restrict polling to required servers only (such as network management and/or monitoring systems).oEnable logging to record commands executed on your network devices, such as TACACS+ and Syslog. Use these logs to immediately highlight suspicious events | 2.51 | 
| SNMPv3 | SNMP version three offers three levels of access:ono auth: unauthenticated accessoauth: authenticated access via plaintextopriv: authenticated and encrypted access (most secure mode)•Priv supports the following encryption algorithms:oSingle DES, Triple DES, AES-128, AES-192, and AES-256•The syntax for configuring SNMPv3 priv mode with AES-128 encryption is shown in the notes.| 2.52 |
| SNMPv3 commands | see slide | 2.52 |  
| NTP | used to set clocks on networked computers, port UDP/123.  Clock skew can create serious operational issues, ranging from authentication to investigations. Building a forensic timeline among systems with different local times can be quite challenging.Kerberos can also be affected. Microsoft recommends a maximum skew of 5 minutes | 2.54 | 
| Microsoft Kerberos Clock | recommends a maximum skew of 5 minutes | 2.54 | |
| Windows Time service |  is a component that uses a plug-in model for client and server time synchronization providers. Newer versions of Windows have two built-in client NTP providers. One uses NTP (RFC 1305) or MS-NTP to synchronize the local system time to an NTP and/or MS-NTP compliant reference server. The other is for Hyper-V and synchronizes virtual machines (VM) to the Hyper-V host.. When multiple providers exist, Windows will pick the best provider using stratum level first, followed by root delay, root dispersion, and finally time offset | 2.54 | 
| pool.ntp.org | uses DNS round robin to make a random selection from a pool of time servers who have volunteered to be in the pool.  | 2.56 | 
| ntpd config file for pool.ntp.org | see slide for config | 2.56 | 
| NTP Authentication | Stratum 1 NTP server contains an onboard clock, such as an atomic clock, or GPS-based clock. An NTP server that syncs to a stratum 1 server becomes a stratum 2 server. A system that syncs to a stratum 2 server becomes a stratum 3 server, etc. | 2.57 | 
| MON_GETLIST | will return the client IP addresses that havesynced most recently, can be used for NTP amplification attack **See Slides for Command**; There is no direct way for the victim to identify the system sending the spoofed requests.Monlist may also be used by attackers who have gained internal access to a network, providing a **list of local peers that have synced their clocks**; Block by setting disable monitor in ntp.conf | 2.58-57 | 
| bogon | is a derivative of the word bogus, which means illegitimate or fake. Team Cymru defines a bogon prefix as, "a route that should never appear in the internet routing table. A packet routed over the public internet (not including over VPNs or other tunnels) should never have a source address in a bogon range. These are commonly found as the source addresses of DDoS attacks. | 2.61-62 | 
| Fullbogons | begins with the traditional bogon prefixes. Team Cymru then adds the IP space allocated to the RIRs, but not yet assigned by them to ISPs or other end users. This provides a much more granular and enumerative view of IP space that should not appear on the internet. Fullbogons are available for both IPv4 and IPv6. Due to the fragmented nature of IP allocations and assignments, the fullbogons feed is much larger than the traditional bogon feed.  Changes Daily | 2.62 | 
| bogon filter | configured on the external (internet-facing) interface of an edge router or firewall, dropping traffic sent from the internet with a matching source address. For companies that use non-private IP addresses on their internal networks, add those addresses to the bogon filter as well. This will drop spoofed external traffic sent from the internet, with a forged (internal) source address. | 2.63 |
| Team Cymru | maintains a list of secure templates for a variety of devices and services, including Cisco IOS, Juniper, BIND, NTP, and others. They include bogon blocking templates (where applicable, such as on routers or firewalls) | 2.62-63 | 
| Open Dynamic Block Lists |  or External Dynamic Lists (EDLs) from https://opendbl.net/. These lists can be imported into any device that accept blocklists with standalone ipaddressess (x.x.x.x) and ranges (x.x.x.x-y.y.y.y) and can also be imported in NGFWs or proxies. | 2.63 |
| External Dynamic Lists (EDLs) | from https://opendbl.net; These lists can be imported into any device that accept blocklists with standalone ipaddressess (x.x.x.x) and ranges (x.x.x.x-y.y.y.y) and can also be imported in NGFWs or proxies. | 2.63 |
| Bogon Filter, Cisco IOS Configuration | The complete list of bogons is shown on the previous "Bogon Filtering slide" and is also available from Team Cymru, **view on slide** | 2.64 | 
| Blackholes and Darknets | Googling "darknet" usually returns sites relating to the newer definition: dark websites accessed via TOR hidden nodes (a platform for providing anonymous internet services). Silk Road is the most famous "dark web" site, which openly sold illegal drugs (and more). Wired Magazine has a great summary of law enforcement's takedown of the original Silk Road. | 2.69 |
| Darknet (IP) | referring to unused IP addresses/network blocks. Most organizations simply ignore network blocks that they own but do not use. That amounts to a missed opportunity: it's better to route traffic to unused networks to a device that will count and/or analyze it, and then drop it. | 2.66 |
| Darknets (IP), Public |  are used to collect internet attack data (and sometimes to sinkhole aggressive malware such as worms). External IP darknets are usually less actionable than internal IP darknets because worms and other forms of malware hit your external firewall all day long, while the same is (hopefully) not true for your internal networks | 2.67 | 
| Darknet monitoring | public and private can give insight to traffic, potentially id'ing malware or some other bad shit | 2.67 | 
| Witty Worm | Discovered by Team Cymru using IP dark Net | 2.68 | 
| Darknet Architecture | Route all IP darknet traffic to a dedicated darknet router.oMonitor this traffic via SNMP.•That router forwards traffic to a “packet vacuum” sensor.oThis sensor sniffs and drops the traffic. | 2.69 | 
| packet vacuum, IP Darknet | contains two physical interfaces: the sniffing interface and the management interface. All traffic sent to the sniffing interface is dropped, while Network Security Monitoring (NSM) tools are used to monitor the traffic. Options include Security Onion, or any of the tools used by it, including Snort, Suricata, Bro, SiLK, Argus, etc. The management interface runs SSHD for remote access. Traffic may also be captured with netsniff-ng, tcpdump, etc., for further analysis. | 2.69 | 
| IPv4 workarounds | Slow the need for IPv6 adoption, includes CIDR addresses, NAT, and carrier-grade NAT (discussed next). In reality, CIDR and NAT have historically helped stem the tide but can no longer keep up with the growing demand for internet-connected devices. | 2.76 |
| IPv6 | 128 bits long add, w/ 340 undecillion addresses (340^36); Born out of need of IPv4, 4.2B IP exhaustion. <br> Makes up *over 40% of internet backbone* traffic. Many companies ignoring IPv6, but using it; <br> **Offers:** massively larger address space; Cleaner routing (simpler, but larger header) ; Flexible embedded protocol support; Stateless autoconfiguration <br> - *Microsoft recommends **not** to disable*; it is included/enabled in Standard Win Svc and app testing during OS dev;  *Used in MS OS'es since MS Vista+*; Functions may **not** work if disabled.  **Examples:*** Windows Remote Assistance, HomeGroup, DirectAccess, and Windows Mail all use IPv6.  Can Reduce performance on some MS Apps; | 2.77,78 | 
| IPv6 Header | **Version (4 bits)** - Set to 6 - IPv4 uses 4 <br>**Traffic Class (8 bits)** - Sets the priority of the packet <br>**Flow Label (20 bits)** - used to associate multiple packets in the same stream, such as a video transfer <br>**Payload Length (16 bits)** - length (in bytes) of the payload <br>**Next Header (8 bits)** - describes the IPv6 extension header (if used) or the Layer 4 header (TCP, UDP, etc.) <br>**Hop Limit (8 bits)** - renamed from IPv4's "Time to Live" field <br>**Source and Destination IP addresses (128 bits)** | 2.79 | 
| IPv6 checksum | is ommitted assumes that damaged or altered packets will be detected at another layer (such as Layer 4 for UDP or TCP, which calculate checksums). This offloads the checksum verification from the router to the receiving system, which simplifies (and lowers) processing performed by a router. | 2.79 | 
| IPv6 Flow Label | allows routers to recognize associated packets (such as a video stream) to route subsequent packets with fewer resources.  packets in stream, session, or flow share a common flow label valuue; easily recognizable, which is in a stream or session, is often useful for Quality of Service (QoS) mechanisms | 2.79 | 
| IPv6 Hop Limit | Renamed from Time to Live to more accurately describe use.  RFC 791 origianlly described TTL in time (seconds) | 2.79 | 
| IPv6 Extension Headers | First header is always 40 bytes long.  Headers have one fixed header *and zero or more optional (extension) headers*. **Every extension header is 8 bytes long** which may be used for options like routing, fragmentation, authentication, encapsulation, Ect. <br> Multiple extension headers may be used in one packet, chained together, with no chain limit; Can lead to interesting attacks, including denial of service; Many use ACLs to drop packets containing extension headers | 2.81 |
| IPv6 Extension Headers Mitigations | Chain limiting Attacks; *DoS* & *IPS Bypbass* ** Many use ACLs to drop packets containing extension headers - since most drop and don't use, little incentive to fix creating a barrier to extension header addoption; Cisco has rate limiting of packets that are diverted from HW to SW to prevent DoS.  | 2.81-83 |
| IPv6 Addresses | colon-separated hexadecimal values;  Repeated zeros may be summarized as “::”.Address below is:•fe80:0000:0000:0000:020c:29ff:fec0:f094•Summarized to: fe80::20c:29ff:fec0:f094 <br> common to have multiple address types, plus a mix of temporary and permanent (“secured”) addresses. Secured addresses do not change and are not based on the adapter's MAC address; <br> **Link-local addresses**: think 169.254.0.0/16...Used on the local subnet only,  begin with "***fe8, fe9, fea, or feb***" or "has a network prefix of ***fe80::/10***; All IPv6-enabled systems have<br> **Unique local addresses (ULA)**; May be used on privately owned networks, addresses begin with "***fd***" (***network prefix fd00::/8***); *Not routed publicly*. Some organizations do not use these addresses; <br> **Global unicast addresses**: Routed publicly; Systems may have multiple unique local and global unicast addresses. | 2.84-86 | 
| Link-local addresses, IPv6 | think 169.254.0.0/16...Used on the local subnet only,  begin with " |fe8, fe9, fea, or feb |" or "has a network prefix of  |fe80::/10 |; All IPv6-enabled systems have | 1.86 |
| Unique local addresses (ULA), IPv6 | May be used on privately owned networks, addresses begin with " |fd |" ( |network prefix fd00::/8 |); *Not routed publicly*. Some organizations do not use these addresses; can add a layer of defense-in-depth protection (in addition to firewalls, etc.); Example: SMB Svc listen only to ULA == no internet access | 1.86 |
| Global unicast addresses, IPv6 | Routed publicly; Systems may have multiple unique local and global unicast addresses.  | 1.86 |
| link-local addresses, IPv4 | 169.254.0.0/16, described in RFC3927; typically only seen when DHCP configuration has failed. ZeroConfig or Bonjour use also;. 169.254.169.254 is used by AWS, GCP, and Azure for instance metadata services of cloud IaaS  | 2.86 |
| IPv6 Address Format | Primary format difference between Global Unicast Addresses (GUA) and unique local addresses (ULA) is the use of Global ID in ULAs<br> **Prefix:** 7bits FC00::/7 prefix to identify Local IPv6 unicast addresses.<br> **L:** Set to 1 if the prefix is locally assigned. Set to 0 may be defined in the future. <br> **Global ID**: 40-bit global identifier used to create a globally unique prefix. <br> **Subnet ID**:16-bit Subnet ID is an identifier of a subnet within the site. <br> **Interface ID**: 64-bit Interface ID. | 2.87 | 
| IPv6 Local Global ID | RFC 4193 describes the process of generating a unique local address: **MUST** be generated with a pseudo-random algorithm... It is important that all sites generating Global IDs use a functionally similar algorithm to ensure there is a high probability of uniqueness.   The use of a pseudo-random algorithm to generate Global IDs in the locally assigned prefix gives an assurance that any network | 2.88 |
| Stateless Address Auto Configuration **(SLAAC)** | Can independently determine address, with no additional infrastructure or servers needed. “Stateless” means no requirement to maintain server or table of addresses unlike DHCP <br> SLAAC o*riginally used the MAC address for address (privacy issues resultant)*; other commonly used schemes exist including *“privacy extension addrs”*; <br> System listens for IPv6 global prefix router advertisement: Link-local prefix **“0xfe80”** is used for the link-local address. <br> 48-bit MAC address is split in half; Constant “0xfffe” inserted in the middle <br> The 7th bit of MAC address is flipped for universal addresses <br> Note that static or DHCPv6-assigned addresses may also be used. | 2.89-90 | 
| SLAAC Addr, Privacy Extensions | Link Local SLAAC generated addresses that is not based on the MAC address; Most systems use privacy extension addrs for unique local and global unicast addrs and continue to embed the MAC address in the link-local address; <br> Most systems also create two addresses for each unique local and global unicast address; temp addr is preferred communications; adds additional layer of privacy since not tied to MAC and change freq.; Default behavior on current Win and MacOS systems; Older Nix Ubuntu <14.04 distros do not use as default, but can be enabled in sysctl. Ubunut 16.04+ support by default | 2.91 | 
| Privacy extension, IPv6 SLAAC Addr | Link Local SLAAC generated addresses **not** based on the MAC address; Most systems use privacy extension addrs for unique local and global unicast addrs and continue to embed the MAC address in the link-local address; <br> Most systems also create two addresses for each unique local and global unicast address; temp addr is preferred communications; adds additional layer of privacy since not tied to MAC and change freq.; Default behavior on current Win and MacOS systems; Older Nix Ubuntu <14.04 distros do not use as default, but can be enabled in sysctl. Ubunut 16.04+ support by default <br> Requires the use of Duplicate Address Detection (DAD) and will generate a new random host address if the current one is in use on the network| 2.91-93 | 
| Duplicate Address Detection (DAD) | SLAAC Priv. Ext. check that will generate a new random host address if the current one is in use on the network | 2.93 | 
| IPv6 Private/Valid Lifetime | Temp Addrs generated by Priv Extensions w/ SLAAC,  have a preferred lifetime and a valid lifetime. <br> Preferred lifetime: once expired, the system will use a new temporary address for new connections. <br> Valid lifetime: the system will continue to accept connections from existing connections on this address for this period of time.You may view the lifetimes with these commands:•Windows: netsh interface ipv6 show address; Linux: ip a•macOS: ifconfig -L | 2.93 | 
| Router Advertisement Daemon (radvd) | IPv6 Deamon that can override the local systems’ default preferred and valid lifetimes: *radvd defaults to 1-day valid lifetime* and *4 hours preferred lifetime*, which is considerably shorter than the default OS settings. Linux/Unix IPv6 clients with the '*radvdump*' command installed can check those settings | 2.94 | 
| privacy-enhanced IPv6 addresses |  used when systems use SLAAC to generate an IP address, see Privacy Extension, SLAAC | 2.91-93 |
| /64 IPv6 subnet | allows 18,446,744,073,709,551,616 over 18 quintillion hosts | 2.90-94 | 
| RFC 4941 | Privacy Extensions for Stateless Address Autoconfiguration in IPv6 | 2.91-95 |
| RFC 4193 | sections describe the process of generating a unique local address, unique local address formats,  | 2.88 | 
| RFC3927 | a section describes link-local addresses, IPv4 169.254.0.0/16 | 2.86 | 
| RFC 2460 | IPv6 Extension Headers are explained in this RFC | 2.83 | 
| RFC 791 | Time to Live (TTL) as using seconds was originally descibed in this rfc | 2.79 | 
| RFC 1918 | O.G. IPv4 Private IPs | 2.67 | 
| RFC 1305 | NTP | 2.54 | 
| RFC5425 | TLS for Syslog, Secure logging based on based on this RFC should be used for SYSLOG. Adds authentication to client and server, encryption of the data, and integrity verification. | 2.19 | 
| RFC 15 | 1969, Described how telnet was used to run on the pre-IP ARPANET, using a Layer 3/4 protocol called NCP (Network Control Protocol) | 2.15 | 
| RFC4191 | introduced router preference options, such that a RA (rtr adv.) could carry one of three router preference values: high, medium (default), or low. By default, these RA messages will be set to medium priority. | 2.115 |
| preferred lifetime, IPv6 Priv. Ext. SLAAC ADDR | Preferred lifetime: once expired, the system will use a new temporary address for new connections. default IPv6 preferred lifetime is 1 day, and the **default valid lifetime is 7 days**; View the lifetime setting commands: Windows: *netsh interface ipv6 *show address; Linux: *ip a*; macOS: *ifconfig -L*; <br> View local default lifetimes commands: Windows: *netsh interface ipv6 show privacy*; Linux: *sysctl -a \| grep net.ipv6.conf.all.temp*, macOS: *sysctl -a \| grep net.inet6.ip6.temp*  <br> Value can be overridden by IPv6 route advertisements: ***overwrite with radvd*** use *radvdump* to view | 2.93 |
| valid lifetime, IPv6 Priv. Ext. SLAAC ADDR | the system will continue to accept connections from existing connections on this address for this period of time.  <br> View the lifetime setting commands: Windows: *netsh interface ipv6 *show address; Linux: *ip a*; macOS: *ifconfig -L* <br> View local default lifetimes commands: Windows: *netsh interface ipv6 show privacy*; Linux: *sysctl -a \| grep net.ipv6.conf.all.temp*, macOS: *sysctl -a \| grep net.inet6.ip6.temp* | 2.93 | 
| fc00::/7 | is reserved for unique local addresses. Equivalent to IPv4 RFC1918 addresses (such as 192.168.0.0/16, 10.0.0.0/8, etc.) <br> fc00::/7 is further divided into two /8 subnets: fc00::/8 and fd00::/8; While reserved, usage of fc00::/8 is not yet defined | 2.95 |  
| fd00::/8 | sites use to assign unique local addresses, | 2.95 | 
| ff00::/8 | network prefix for multicast addresses. | 2.96 |
| IPv6 Multicast Addresses | IPv6 does not support broadcast addresses and uses multicastaddresses to perform a similar function to IPv4's broadcastaddresses;  Broadcast addresses are used for one -> all c ommunication; Multicast addresses are used for one -> many communication.•IPv6 uses the ff00::/8 network prefix for multicast addresses.  Two important IPv6 multicast addresses: **ff02::1** - All local nodes (cannot be routed) <br> **ff02::2 **- All local routers (cannot be routed)| 2.96 |
| ff02::1 | multicast add:  All local nodes (cannot be routed) | 2.96 | 
| ff02::2 | multicast add All local routers (cannot be routed)| 2.96 |
| ff02::5   | Multicast Addr, OSPFIGP | 2.96 | 
| ff02::6   | Multicast Addr, OSPFIGP Designated Routers | 2.96 | 
| ff02::7   | Multicast Addr, ST Routers | 2.96 | 
| ff02::8   | Multicast Addr, ST Hosts | 2.96 | 
| ff02::9   | Multicast Addr, RIP routers | 2.96 | 
| ff02::a   | Multicast Addr, EIGRP routers | 2.96 | 
| ff02::c   | Multicast Addr, Simple Service Discovery Protocol (SSDP) | 2.96 | 
| Ff02::16  | Multicast Addr, All MLDv2-capable routers | 2.96 | 
| ff02::1:2 | Multicast Addr, All-dhcp-agents | 2.96 | 
| ff02::1:3 | Multicast Addr, Link-local Multicast Name Resolution (LLMNR) | 2.96 | 
| ff05::1:3 | Multicast Addr, All-dhcp-servers | 2.96 | 
| ff0x::fb  | Multicast Addr, Multicast DNS | 2.96 | 
| ff0x::101 | Multicast Addr, Network Time Protocol | 2.96 | 
| RFC 6106 | (Router Advertisement Options for DNS Configuration) describes RDNSS  It is not supported by most Windows operating systems. However, Windows 10 Fall Creators Update does (finally) support RDNSS | 2.97 | 
| Router Advertisement Options for DNS Configuration (RDNSS) | It is not supported by most Windows operating systems. However, Windows 10 Fall Creators Update does (finally) support RDNSS <br> Router Advertisement daemon cannot assign settings such as DNS to some operating systems. radvd supports a "RDNSS" (Recursive DNS Server) setting but, "This feature is not very widely implemented" in clients.| 2.97 | 
| DHCPv6 | Preferred way to assign addresses, Stateless (SLAAC) and Stateful, DHCPv6 cannot assign the default gateway.  SLAAC, RA deamon assigns addresses to include cateway and other opts (DNS) | 2.97 |
| NIST SP 800-119 |  "Guidelines for the Secure Deployment of IPv6," In June 2022, the US National Security Agency (NSA)3published updated guidance | 2.99 | 
| IPv6 Security, NSA Guidance |  Assign addresses to hosts via DHCPv6 server to mitigate the SLAAC privacy issue,  - <br> Disable tunneling protocols (6to4, Teredo, etc.) where possible. Tunneling protocols canbe allowed if required during a transition, but limited to only approved systems where usage is well understood and explicitly configured. - <br> dual stack configuration: orgs should implement IPv6 cybersecurity mechanisms in parity with their IPv4 or better. For any mechanism implemented for IPv4,  corresponding should be implemented for IPv6, with the IPv6 mechanism addressing any differences for IPv6. For example, firewall rules that filter higher level protocols (suchas TCP or UDP) should be applied to both IPv6 and IPv4 protocols. <br> Carefully review ACLs to ensure they deny all traffic by default, so only traffic from authorizedaddresses are permitted through the firewalls and other security devices. Ensure all traffic is logged and reviewed regularly <br> Learning the IPv6 protocol and knowing how to configure IPv6 effectively are the most critical things.  NSA recommends ensuring all networkadministrators have received the proper training and education to adequately administer IPv6 | 2.10O |
| IPv6 Security Issues | Every organization with modern Operating Systems are using IPv6 right now.oMost are ignoring it.oMalware festers in the darkness.<br> Some firewalls may not be able to process IPv6 at all (or do it incorrectly). <br> Scanning IPv6 is challenging (and quite different than scanning IPv4).<br> IPv6 offers robust tunneling options that can evade filtering and detection.<br> Attackers with internal access can advertise IPv6 routes to internal systems. | 2.101 |
| IPv6 Scanning | size prohibits (would take 584 billion years to scan all 18+ quinitllion), IPv6 doesn't use ARP | 2.104 | 
| targets-ipv6-multicast-echo.nse | NMAP, Sends an ICMPv6 echo request packet (ICMPv6 Type 128) to the all-nodes link-local multicast address (ff02::1) to discover responsive hosts on a LAN without needing to ping each IPv6 address individually | 2.105 | 
| targets-ipv6-multicast-mld.nse | NMAP Attempts to discover available IPv6 hosts on the LAN by sending an MLD (multicast listener discovery, (ICMPv6 Type 130) query to the link-local multicast address(ff02::1) and listening for any responses. | 2.105 | 
| Virginia Tech, IPv6 | currently a leader in a large-scale production deployment of IPv6, with nearly thirteen years of experience and thousands of native IPv6 clients. In 2010, the university was ranked by Google as one of the largest deployments worldwide, behind only nations like France and China. Globally reachable by IPv6, Virginia Tech faculty are able to conduct research around the world using IPv6 only neworks | 2.105 | 
| ipv6_neighbor_router_advertisement | Metasploit IPv6 scanner to "Send a spoofed router advertisement with high priority to force hoststo start the IPv6 address auto-config. Monitor for IPv6 host advertisements and try to guess the link-localaddress by concatenating the prefix, and the host portion of the IPv6 address. Use NDP host solicitation todetermine if the IP address is valid.” | 2.106 | 
| ipv6_neighbor |  Metasploit IPv6 scanner to "Enumerate local IPv6 hosts which respond to Neighbor Solicitations  with a link-localaddress. Note, that like ARP scanning, this usually cannot be performed beyond the local broadcastnetwork.” | 2.106 | 
| IPv6 Discovery tools | MSF modules for ipv6_neighbor_router_advertisements, ipv6_neighbor.  NMAP - targets-ipv6-multicast-echo.nse, targets-ipv6-multicast-mld.nse, ZEEK, Firewall logs, NetFlow, IDS, ACLs (log match), SNMP MIBs | 2.107 | |
| IPv6 Tunneling Options | There are a wide variety of IPv6 tunneling options, including:; 6to4, 6in4 and 6over4; 6rd; 4 over 6; Teredo; ISATAP; GRE; The wide variety and types of IPv6 tunnels make both preventing and detecting them difficult. These tunnels can also be used to evade or bypass controls such as IDSes and IPSes | 2.109 | 
| Zcat | is a command line utility for viewing the contents of a compressed file without literally uncompressing it. | 2.107 |
| RFC 7059 | ("A Comparison of IPv6-over-IPv4 Tunnel Mechanisms"1) has a great summary of the various IPv6 tunneling mechanisms | 2.109 | 
| IPv6 tunnels 6to | Note that 6to4, 6in4, and 6rd cannot traverse NAT gateways without work-arounds;  NSA Guidance: Disable tunneling protocols (6to4, Teredo, etc.) on all devices where possible. Tunneling protocols can be allowed if they are required during a transition, but they should be limited to only approved systems where their usage is well understood and where they are explicitly configured.| 2.109 |
| 6to4, IPv6 Tunnel | Tunnels IPv6 packets via IPv4 networks, without setting up a tunnel | 2.109 | 
| 6in4, IPv6 Tunnel | Uses pre-configured tunnels to carry IPv6 traffic via IPv4 | 2.109 | 
| 6over4, IPv6 Tunnel | Similar to 6in4, requires IPv4 multicast. Designed for intranet (private) use | 2.109 | 
| 6rd (rapid deployment), IPv6 Tunnel | Based on 6to4, used to carry IPv6 packets via private IPv4 networks | 2.109 | 
| 4over6, IPv6 Tunnel | Tunnels ipv4 packets via IPv6-only networks | 2.109 | 
| Teredo, IPv6 Tunnel | Similar to 6to4 and considered an improvement. Carries IPv6 packets via UDP (and IPv4). Able to traverse NAT gateways. It's considered high cost due to packet overhead. | 2.109 | 
| ISATAP (Intra-Site Automatic Tunnel Addressing Protocol) | IPv6 Tunnel similar to 6over4, uses DNS instead of multicast. Designed for intranet (private) use | 2.109 | 
| GRE, IPv6 Tunnel | Can tunnel both IPv4 and IPv6 traffic | 2.109 | 
| IPv6 SSL/TLS VPN | most solutions (including OpenVPN) can tunnel both IPv4 and IPv6. | 2.109 | 
|  IPv6 Tunneling Detect/Prevention | Many forms of IPv6 via IPv4tunnels carry IPv6 where TCPor UDP would normally be.oThe Layer 3 header "Protocol"field would be 41 (IPv6) in thiscase.•Configure Next-GenFirewalls, IDSes, and/or IPSs to block/alert protocol 41.  Snort syntax: *ip_proto:41* | 2.11O | 
| Teredo Tunneling | •Teredo was originally developed by Microsoft and is standardized in RFC 4380.  It uses UDP port 3544 by default, but other UDP ports may be used.•The Wireshark display filter "teredo" will detect Teredo tunnels via any UDP port. See notes for the Snort rule. | 2.111 | 
| RFC 4380 | Teredo was originally developed by Microsoft and is standardized in RFC 4380. • Uses UDP port 3544 by default, but other UDP ports may be used. • The Wireshark display filter "teredo" will detect Teredo tunnels via any UDP port. See notes for the Snort rule. | 2.111 | 
| IPv6 RA Guard | Cisco feature provides support for allowing the network administrator to block or reject unwanted or rogue RA guard messages that arrive at the network device platform. RAs are used by devices to announce themselves on the link. The IPv6 RA Guard feature analyzes these RAs and filters out RAs that are sent by unauthorized devices.  Compares L2 device with info found in RA frame, once L2 Device validates, forwards the RA. If not validated, drops it | 2.113 | 
| IPv6 RA Rouge attack | One of the easiest ways to prevent a rogue RA attack is to have all routers send their RA messages with high priority. For CISCO IOS 12.4(2)T and 12.2(33)SB or higher, this requires: Intf0/0# ***ipv6 nd router-preference high*** | 2.115 | 
| Hurricane Electric IPv6 | Free service allowing up to five IPv6 tunnels via IPv4;  Static IPv4 address is preferred on the local tunnel broker, but a dynamic address maybe used. Provides free Cert | 2.116 | 
| Application-aware Defenses, segmentation | NSA Talk about how to deploy application aware defenses, using segmentation, references app-aware firewalls, VLANs, ect to make it harder to pivot; lateral movement, ect.   | 2.122 | 
| Segmentation | reduces the ability for an adversary to reach and exploit other systems; Access controls should not stop at the network. Access controls should include user and device authentication and validation; access restrictions between different types of systems are easier to manage, control, and monitor if they are logically grouped together. Is Highly effective in hybrid environments; Sementation DOESNT stop at network, needs to include Auth and Access; needs to be combined with applicaiton-aware defenses | 2.122 |
| Access Segmentation vs Network | **Network Controls access** based on: MAC, IP,Applicationo; **Access Controls** Limit access based on credentials: Device, User, MFA| 2.124 |
| Network Controls access |  based on: MAC, IP,Applicationo; involve router or firewall rules to control which devices can access other devices. NGFW use app-awaare controls | 2.124 | 
| Access Controls | Limit access based on credentials: Device, User, MFA; | 2.124 |
| Conditional access | takes security signals from multiple platforms and correlates them with additional context, facilitating better decisions assuring that people logging in are genuine | 2.124 | 
| Segmentation Principles | should facilitate prevention and detection. - Systems and data with different classification levels (tiers) must reside in different zones. <br>- Control points are implemented at "gates," where all ingress and egress traffic is inspected, and access control policies enforced. <br>- Balance security with usability. <br> Once properly segmented, appropriate application-aware defenses can be utilized to isolate and secure each network segment. **Essential to blocking** an adversary’s **lateral movement through the network**; instills the principle of least privilege on network devices <br>- **Higher segmentation adds complexity and administrative burden.**;   *Insufficient segmentation* can make the network indefensible. <br> Limiting device communication between segments enables better monitoring and visibility into an adversary’s attempts to spread from one segment to another. | 2.125-130 | 
| NIST 800-141 | Guidelines on Firewalls and Firewall Policy describes DMZs | 2.126 |
| Firewall Architecture | Simple networks with no public services can use a two-legged design, with internet (often labeled WAN) and LAN ports.<br> Simple networks offering limited public services may use a three-legged firewall(adding a DMZ port). DMZ (demilitarized zone) networks area "no-man's land" between untrustedand trusted networks where publicservers are located; DMZ networks facilitate the use of outbound proxies; More complex networks require morecomplex designs (and more ports) | 2.126 | 
| DMZ Design | The risk of a compromised DMZ system pivoting into internal systems (or other DMZ systems) must be mitigated. <br> Untrusted->DMZ access should be tightly filtered, plus DMZ->trusted <br> DMZs with multiple servers should be broken up into individual zones (or separate DMZs).<br> Private VLANs may also be used.; Promiscuous port: the firewall DMZ interface; Isolated ports: DMZ servers that only need to send traffic via the firewall; Community ports: when multiple DMZ systems need to communicate with each other (and via the firewall) | 2.128 | 
| DMZ containment | common to have DMZ networks containing multiple servers with no need to communicate with each other; Makes a private VLAN an ideal (and simple) solution; PVLAN on DMZ switch with Promisc. port | 2.128 |
| Virtual segmentation | bears similarities to physical segmentation but utilizes software features on network devices to perform the segmentation. These software features include VLANs, VPNs, VRFs, and VLAN Access Control Lists (VACLs) | 2.130 | 
| VLAN Access Control Lists (VACLs) |  VLANs logically separate hosts and endpoints by creating separate subnets and utilize network layer and application aware filtering devices to prevent segments from communicating with each other based on a configured policy.  VACLs can be implemented to restrict, allow, or redirect the flow of intra-VLAN traffic on switching devices. Utilizing a combination of VACLs, network layer and application-aware filtering devices provides a defense in depth strategy.  | 2.130 | 
| proper filtering rules | used with  policy implemented at the border of each segment, physical segmentation is the most secure method of segmentation and provides the most protection against adversary lateral movement. Can be expensive as it requires the use of separate infrastructure for every subnetwork and requires extensive out of band network management. | 2.130 |
| Physical segmentation, ZT | uses the configuration and placement of physical devices like routers and switches to create network segments based on functional importance and/or levels of access. Each segment can be configured to be physically isolated or connected using application-aware detection devices. With proper filtering rules and policy implemented at the border of each segment, it is the most secure method of segmentation; provides the most protection against adversary lateral movement. Can be expensive as it requires the use of separate infrastructure for every subnetwork and requires extensive out of band network management. | 2.130 | 
| Purdue model reference architecture | illustrate the level of effort needed, with yellow representing low effort and red representing high effort, for attackers to breach and navigate an  unsegmented network versus a highly segmented network.  | 2.130 | 
| VRFs, Segmentation | can also be deployed to virtually segment devices by creating separate routing domains on layer 3 devices. In order for subnets in separate VRFs to communicate, routes between VRFs must be deliberately shared. Benefit of VRFs over VLANs is that VRFs are not susceptible to VLAN hopping attacks. | 2.130-131 | 
| VPNs, Segmentation |  provides a secure communication channel—or tunnel—through a network. A VPN establishes a one-for-one, or gateway-to-gateway connection between an endpoint and a network resource, or two network segments; <br> Encrypted VPNs can provide confidentiality, integrity, and authentication; makes it difficult for an adversary to access; | 2.131 | 
| Virtual segmentation | all methods require attention to the details of implementation and the filtering policies between segments; Attention must be payed to how protocols like SMB, NetBIOS, and RPC services are configured. Constraints on these protocols will limit the damage of pass-the-hash and SMB relay attacks. Ensure implemented in accordance with approved policy. One way of better defending privileges and accounts. | 2.130-131 |
| OT/IT boundries | creating boundaries between the operational technology (OT) and information technology (IT) networks reduces many risks associated with the IT network, such as threats caused by phishing attacks. | 2.131 | 
| Tiers – Based on Criticality and Business Impact | Tier 1:-Critical components to maintain operations, includingdomain controllers, exchange servers, and networkinfrastructure devices-Tier 2:-Internal systems containing PII and associated data,including databases, SharePoint servers, and other webservers-Tier 3:-External facing data-providing services | 2.132 | 
| SOC Zones | Archeticte with zones and levels in mind to defend; SOC Zones to defend your organization allows for both IT and business context to simplify building effective use cases, as well as setting the stage to build efficient processes around zones, categories, severity, sensitivity, and tiers for response process. Zoning should be implemented in a way that reflects the business-critical capability | 2.133 |
| security zone | is a portion of a network that has specific security requirements set. Each zone consists of a single interface or a group of interfaces, to which a security policy is applied. These zones are typically separated using a layer 3 device such as a firewall. | 2.133 | 
| Network Segmentation Issue | pure network controls are not sufficient to block high-risk events from occurring, Examples show segmentation issues | 2.134 | 
| Login Segmentatin |  involves implementing access controls via authentication and local system access controls. Access into or out of assets can be controlled with login policies and rights. Even the ability to launch processes can be enforced per user with file access controls, application control suites, and other technologies.  Can also exist by implementing proxies or authenticated flows such as using jump boxes or administrative workstations. The goal is to limit damages by implementing the principle of least privilege to only what is necessary. By doing so, stolen credentials are limited | 2.135 |
| Segmentation | A form of risk reduction and should be a routine design and process.•Commonly associated with network designprincipals •Applies to more concepts, such as loginsegmentationGoal is to lower damages and mitigate impact by limiting overall access, slowing down the attacker, and creating more opportunities for detection | 2.136 | 
| Application Layer Security | Layer 7 security refers to application layer security.•Means security based on full network protocol knowledge•And mainstream use of standard network protocols•Example: Microsoft Update uses HTTP (TCP/80) and HTTPS (TCP/443).1Use of application layer security differs by product and implementation.•Necessary to balance network and host protection | 2.139 | 
| application-level inspection | a security decision is made with the full knowledge of what an application is and does. Take for instance Microsoft Update. Microsoft Update is an application, but it operates using specific DNS domains and makes connections on top of HTTP and HTTPS. | 2.139 | 
| Microsoft Update | an application that operates using specific DNS domains and makes connections on top of HTTP and HTTPS. <br> Uses TLS (443/tcp); Update Metadata is exchanced - results in updates (app/driver, ect) Device Decides what /when to download from list;  Once Downloaded, via Deleivery Optimizaiton over mixed standard of HTTP and Secure Peer-to-Peer Calls (7680/tcp), method used is based on config/GPOs, when going over the p2p network, content is integrity validated upon reciept of from each peer, if requested contint is unvailable, will download over http | 2.139 | 
| Application Proxies | A proxy is a system that brokers traffic between systems.•Type of proxy is specific to the application•Example: HTTP, SMTP, SOCKS, FTPThe goal is to funnel traffic through a proxy, so it can:•Control the flow of data•Analyze traffic for unauthorized or malicious use•Cache contentDeployment and direction of proxy changes use | 2.14O |
| Proxy Types | ForwardSystems request access through a proxy to access a resource•Example: Web ProxyReverseService protected by forcing connections through a proxy•Example: Web Application Firewall/Load Balancer|2.141 | 
| Zero Trust Network Access (ZTNA), | also known as the software-defined perimeter (SDP), is modern approach to securing access to applications and services both in the cloud and on-premises. Can be product or service that creates an identity and context-based, logical access boundary around an application or set of applications. The applications are hidden from discovery, and access is restricted via trust broker (in other words Layer 7 proxy). The broker verifies the identity, context, and policy adherence of the specified participants before allowing access and prohibits lateral movement elsewhere in the network. This removes application assets from being publicly visible and significantly reduces the surface area for attack. | 2.142 |
| Software-Defined Perimeter | also known as Endpoint-Initiated ZTNA; As the name implies, in an endpoint-initiated zero trust network architecture the user initiates access to an application from an endpoint connected device, similarly to an SDP. An agent installed on the device communicates with the ZTNA controller, which provides authentication and connects to the desired service. | 2.142 |
| Endpoint-Initiated ZTNA | AKA SDP (Software-Defined Perimeter), As the name implies, in an endpoint-initiated zero trust network architecture the user initiates access to an application from an endpoint connected device, similarly to an SDP. An agent installed on the device communicates with the ZTNA controller, which provides authentication and connects to the desired service. | 2.142 |
| Reverse-proxy architecture | In a service-initiated ZTNA, the connection is initiated by a broker between application and user; requires lightweight ZTNA connector to sit in front of the business applications that are located either on-premises on at cloud providers. Once the outbound connection from the requested application authenticates the user or other application, traffic will flow through the ZTNA service provider, isolating applications from direct access via a proxy. no agent is required on end user devices; more attractive for unmanaged or BYOD devices/for consultant or partner access. <br> aka,, Application- or Service-Initiated ZTNA. | 2.142 | 
| Service-initiated ZTNA | aka reverse-proxy arch;  the connection is initiated by a broker between application and user. This requires a lightweight ZTNA connector to sit in front of the business applications that are located either on-premises on at cloud providers. Once the outbound connection from the requested application authenticates the user or other application, traffic will flow through the ZTNA service provider, isolating applications from direct access via a proxy. The advantage here is that no agent is required on end user devices, making it more attractive for unmanaged or BYOD devices for consultant or partner access. | 2.142 | 
| Reverse Proxies, ZTNA and SASE | Reverse-proxies are central to the new network architectural strategies: Secure Access Service Edge (SASE) and Zero Trust Network Architecture (ZTNA).•ZTNA is a product or service that creates an identity-and context-based, logical access boundary around applications, often used to replace VPN and secure multicloud access. •SASE is an even newer approach that builds on ZTNA and that incorporates SD-WAN, Next Gen Firewall as a Service, Secure Web Gateways, and CASB/DLP, among others. •Notice how endpoint agents will be needed in most cases. | 2.142 |
| SASE | ZTNA Small Subset of SASE; restricts access of all edges—sites, mobile users, and cloud resources—in accordance with ZTNA principles. In other words, SASE’s NGFW and SWG capabilities are how SASE restricts access; ZTNA is the degree to which SASE edges have access restricted; <br> - SASE bundles Zero Trust Network Access, NGFW, and other security services along with network services such as SD-WAN, WAN optimization, and bandwidth aggregation into a cloud-native platform.| 2.142 |
| Web Proxy | A web proxy acts as an intermediary for web access.•Primarily used to protect internal assets•Often underutilized and completely underestimated; Use of web proxy **forces analysis** of web traffic; <br> 2 seperate connection, endpoint connection terminates at the web proxy, and the web proxy has full visibility into the web connection request and response.  Allows security decisions to be made by the proxy on behalf of the endpoint system. <br> Can use X-Forwarded-For, or XFF; this helps keep track of connections; XFF field contains the originating client’s IP address. The XFF field is not mandatory, but web proxies almost universally support it. Important that it is removed at the perimeter so that it does not give away information about internal systems and IP spaces to external systems| 2.144 |
| Web Proxy Capabilities | Inspection of web traffic includes filtering based on:; Site category; URLs; File contents; Data loss prevention; MIME Types; User agents; Global reputation; Status codes; Cookies; Form values; Protocol anomalies; Certificates; AV signatures; Sandbox analysis; <br> will break connections if protocol is not used appropriately.  Also looks up sites for reputation based scores | 2.145 |
| Site Categories | Web proxies are used to apply content filtering. Content filtering blocks sites using a website's reputation and category. New sites fall into an unknown category. Established sites fall into a category based on the site's content.  Categories make allowing or blocking simple.  Security Admins may be over confident with category allowances | 2.146 | 
| Bypassing Site Categories | Domains often go up for auction.•Businesses close, or sites are no longer needed.Adversaries buy these and use them for phishing.•Great for buying pre-categorized sites; or publish your own; can submit for review to speed up | 2.147 |
| Website Allow Lists | More secure approach than site cats; Whitelist; more work, one way to get started is to add every site accessed today to an allow list.•May include evil inside but starts the allow listAllow listsprovide a significant security boon | 2.148 |
| Web Proxy Alternatives | Can be applied per user/group; Terms and Conditions and Authenticationcan be required either entirely or conditionally.•Malware highly likely to fail when against both of theseCould be required before internet access works•Some organizations require human interaction for web access.•Or could be applied to unknown or unauthed sites <br> Key advantage malware doesn't know who to traverse;  | 2.149 | 
| forward proxy | protects systems that are connecting out to another system. An example of this is a web proxy.Both a forward proxy and a reverse proxy can be deployed in one of two modes: transparent or explicit. | 2.150 | 
| reverse proxy | is an opposite in that it protects the asset systems are connecting to. An example of this is a web application firewall. Both a forward proxy and a reverse proxy can be deployed in one of two modes: transparent or explicit.| 2.150 |
| explicit web proxy | requires endpoints to be configured to use the proxy. A transparent proxy sits inline on the internet and does not require endpoints to know it exists. As such, transparent proxies are easy to deploy and maintain.An explicit proxy provides significant advantages simply because it requires endpoints to know it exists and to require configuration to use.An explicit proxy works best when it is the only method to access websites found on the internet. All attempts to access websites directly need to be blocked by a firewall. Requiring web access to funnel through a web proxy alone is enough to stop a large percentage of malware. | 2.150 |
| Proxy aware |  means a program, whether benign or malicious, is programmed to inherit proxy settings from the operating system or manually specifies a proxy. | 2.150 | 
| Explicit Proxy,  Advantages | Delegated DNS: -  In an explicit proxy setup, DNS query is performed by the proxy:  User types www.sec530.com/530.htmin the browser; If it matches an entry in the bypasslist, theclientusesits own DNSto resolve the name, and thenclient connects directly to the target IP addressand port<br> - GET /530.htm HTTP/1.1Host: www.sec530.comoIf no bypass list entries match, browser connects to its configured proxy, and sends a request with the full domain name <br> - GET http://www.sec530.com/530.htm HTTP/1.1oThe proxy resolves that host nameusingits ownDNS and then connects to the target site.<br> - Clients can now resolve internal comms (i.e., AD) through an internal DNS server that doesn’t provide a forwarder to external resources, such as websites. All lookups for external websites are delegated to the proxy.| 2.152 |
| web proxies, BBP | should require authentication and be deployed in explicit mode. Combining these two achieves strong malware protection. A majority of malware is not proxy aware. Those pieces of malware that are proxy aware often fail to connect through a web proxy that requires authentication. For malware to successfully do this would require automated intelligence to steal credentials and then use them as a proxy prior to attempting any outbound internet access. | 2.153 |
| Web Proxy Access Options | ideal goal is to use an explicit web proxy. The problem is some assets cannot specify a proxy and other assets are constantly coming into and out of an organization’s network. Devices that cannot specify a proxy require the use of a transparent web proxy and/or placement into a segmented network. A segmented network makes controlling and protecting assets that have limited controls an easier task. | 2.154 | 
| mobile device proxy access | can be through the use of an always-on VPN tunnel, a cloud-hosted proxy service, or a DMZ internet-facing web proxy, use an explicit proxy in 1 of 3 ways, AO-VPN, Directly (cloud or port forwarding through corp. fw), | 2.154 |
| always-on VPN (AOVPN) connection | If a laptop uses an always-on VPN, then it can point to the proxy server directly using the proxy's internal IP address. unless traffic between devices and external services is explicitly protected for this first hop to the internet, you shouldn’t remove your AOVPN. | 2.154 | 
| Squid | is an open-source web proxy that supports both transparent and explicit mode deployment options. Squid runs on commodity hardware or virtualization platforms and includes the ability to perform antivirus checks, web caching, optional SSL interception, and the ability to make calls to an Internet Content Adaptation Protocol (ICAP) server.Commercial web proxies are much more mature and feature rich in comparison to Squid. However, Squid is free | 2.156 |
| Internet Content Adaptation Protocol (ICAP) | ICAPis used to extend the capabilities of a proxy.•Offloads tasks to another system for processing•Typically includes antivirus and malware analysis•Often includes multiple antivirus enginesCustom integrations can be built using the ICAP service.•Recommend sticking with commercial solutions•ICAP requires advanced knowledge and programming.Squid uses ICAP to establish filtering with SquidGuard. | 2.157 | 
| Internet Content Adaptation Protocol (ICAP) | ICAPis used to extend the capabilities of a proxy.•Offloads tasks to another system for processing•Typically includes antivirus and malware analysis•Often includes multiple antivirus enginesCustom integrations can be built using the ICAP service.•Recommend sticking with commercial solutions•ICAP requires advanced knowledge and programming.Squid uses ICAP to establish filtering with SquidGuard. | 2.157 | 
| SquidGaurd | Internet Content Adaptation Protocol (ICAP) Squid uses ICAP to establish filtering with SquidGuard. | 2.157 | 
| Malware Detonation |  a great complement to web proxies.•Many SaaS vendors run sandboxes behind the ‘scenes’•The system usually is a virtualized system focused on behavioral detection that issues a verdict for binaries, scripts and URLs | 2.159 | 
| sandboxing techniques | Includes Malware Detonation, by using organizations can achieve a more layered and comprehensive defense strategy against sophisticated malware and advanced persistent threats. | 2.159 |
| SMTP proxies | focus heavily on prevention. Prevention is important because a majority of email is spam. However, a good SMTP proxy prevents and identifies a targeted attack. This module focuses on key features that SMTP proxies deploy. The features include statistical analysis through Bayesian Analysis, sender verification to prevent spoofing, special ways to identify targeted phishing domains, and key ways to modify emails to empower your end users. | 2.165 | 
| Machine learning | is either unsupervised learning, which deals with classifying data sets without any prior knowledge, or supervised learning, which involves feeding known good and known bad data to learn how to classify new data | 2.166 | 
| Bayesian Analysis | is an old yet highly effective way to identify spam or malicious email. Bayesian Analysis operates by performing an ongoing statistical analysis, which results in a probability score that something is going to happen. Analysis considers various keywords, header information, and any other metadata over time, the scoring system adapts over time. The adaptation is exactly what is necessary to keep up with evolving spam. However, adapting to changes also means given enough persistence, an adversary will get an email in | 2.166 | 
| Sender verification | is the process by which a domain owner establishes rules dictating who or what can send emails from a given domain. uses SPF to do so; Sender Policy Framework requires two things to work. First, Sender Policy Framework requires a DNS TXT record that specifies which IP addresses or domains can send emails from a domain. Second, Sender Policy Framework requires an SMTP proxy or email system that enforces SFP checks. Many SMTP proxies enable Sender Policy Framework by default. Sender Policy Framework then prevents emails that originate outside of the systems specified in the DNS record for the domain. | 2.167 |
| Sender Policy Framework | requires two things to work. First, Sender Policy Framework requires a DNS TXT record that specifies which IP addresses or domains can send emails from a domain. Second, Sender Policy Framework requires an SMTP proxy or email system that enforces SFP checks. Many SMTP proxies enable by default. Sender Policy Framework then prevents emails that originate outside of the systems specified in the DNS record for the domain. <br> It’s important to note that SPF protects the Envelope Sender Address only. <br> SPF *doesn’t guarantee protection against spoofing the display name or “header from” address*; also, *Fowrwarded messages dont* have protection, *not inherited by subdomains* either; *must have SPF record for every A record* | 2.167-168 |  
| Envelope Sender Address | also known as return-path, is usually hidden from the end user and used by the mail server. | 2.167-168 | 
| Header Sender Address | is displayed to the user. It’s the field “Sender” or “From” that you can see when open your email program. | 2.167-168 | 
| DomainKeys Identified Mail (DKIM) | Digital Signature, PKI (Symettrical/Assemeatrical) signing validation of email | 2.169 |
| DMARC policy | dictates what happens if an email fails. For an email to fail, one of two conditions must happen. If both SPF and DKIM fail, then DMARC fails a message. If either SPF or DKIM pass but the reply to the domain does not pass the DMARC alignment mode, then the email will fail. A huge benefit of DMARC is that a failed message automatically gets logged, quarantined, or rejected depending on the policy; Both Prenventive and Detection control | 2.171 |
| Sender Authentication | Destroying spoofed emails before they cause damage is why sender authentication exists. However, sender authentication only helps with emails spoofing domains an organization owns | 2.172 |
| dnstwist / typosquatter | SMTP proxy can protect against cousin domains.•You can add all possible domains into a proxy.•Should configure to blockor quarantine and alert•Requires identifying all possible domain permutationsdnstwist1and its new iteration, typosquatter2, calculates permutations against a given domain.•Also checks to see if any domains have been registered•And provides additional information about the domainUse dnstwist with scripting to handle deal with evil cousins | 2.173 | 
| Combating Open-Source Intelligence | A good architect protects an organization.•A great architecture raises the bar against attackers.Try creating email accounts for users that do not exist.•Possibly register these accounts for online services.Any attempt to access or email these accounts = BAD•Scripting can automatically ban email senders.•Or at a minimum, spam appliance can generate an alert.| 2.175 | 
| Rate Limiting | Too much of something is a bad thing.<br> - Rate limiting protects by slowing down mass email.<br> - Both inbound and outboundRate limiting thresholds can be adjusted per sender.<br> - SMTP proxy has a default threshold based on solution.<br> - The mass email usually from business partners<br> - Inbound rate limiting could be early detection or noise.; oubound rate limit is a comprimise | 2.176 |