| keyword | description | page | 
| -----   | ----- | ----- |
| Perimeter security | has a major failing: it was not built with assume breach in mind, yet a compromise is inevitable. Inside access is not always benign. Modern attacks are inside out. A trusted system brings attacker in. Internal access is loosely regulated. Assets wont be 100% controlled. | 5.3 |
| Zero trust, Basic Princilbles | Network is always hostile: assume breach; Internal and external threats are always present.; Internal network does not equal trusted; Every device, user, and network flow must be proven.; Log and inspect all traffic. | 5.4 |
| Zero Trust Architecture | developed by Forrester's John Kindervag in 2010; **Data-centric focus** <br> **Basic principles of zero trust:**; Network is always hostile: assume breach; Internal and external threats are always present.; Internal network does not equal trusted; Every device, user, and network flow must be proven.; Log and inspect all traffic. | 5.4 |
| Network school of thought, ZT | doubled down on using network controls for security by creating smaller network segments and measuring trust of devices before network controls allow access to resources. While promising, this approach was highly complex and saw limited uptake outside a few bright spots like Googles BeyondCorp. | 5.5 | 
| Identity School of thought, ZT | Another approach, advocated by the Jericho Forum, pushed to move away from network security controls entirely with a ***de-perimeterzation approach***. This approach was largely beyond the reach of technology available at the time but planted important seeds for the Zero Trust of today. | 5.5 ||
| Zero Trust Tenets | **1. Network is hostile**<br> -Traffic must be authenticated.<br> -Traffic must be encrypted.  <br> **2. Least privilege must be enforced**.<br> -Trust must be factored into least privilege.<br> -Trust is no longer binary (yes or no).<br> -Access is granted per-session basis based by dynamic policy. <br> **3.** All data flows must be known and controlled. <br> **4.** All assets must be scanned, hardened, and rotated.   <br> **Trust Nothing Verify Everything** | 5.6 |
| Identity = User + Device + Context | Forresters original ZT research used the concept of a network agent for access.  In that model a network agent is a user and device combined.This new type of identity (user+device+context) is used to determine authorization. <br><br> User + corporate laptop = what access?<br> >User + personal laptop = what access?<br> User + corporate phone = what access? <br> Access to data is based on variable or dynamic trust | 5.7 |
| Identity management | goes a long way in tightening controls and limiting access to data. <br> The issue with identity management is that most solutions focus entirely on the user. User authentication, whether with username and passwords or multifactor authentication, is often attributed to the identity. Yet identity should be based on both the user and device being used. <br> The combination of the user and device equates to what the original zero trust model refers to as a network agent. Access to data should be controlled based on the combined identity of a network agent. | 5.7 |
|  Zero Trust, Purpose |     To understand and control how users, processes, and devices interact with data. | 5.7 |
|  Tuple, zero trust |  A combination of the user, device, and other security-relevant contextual information (e.g., location, time of day, previous behavior). Used to make an access decision. <br> Authentication: Explicit authentication of both the user and the device is required for a reliable tuple.  | 5.7|
| Zero Trust Decision Engine | ; Examines the tuple in the access request.; Compares it to the security policy for the requested data/resource.; Makes a risk-informed decision on whether to allow access. | 5.7 |
| Varible Trust | With a zero trust architecture, trust must be earned and can change dynamically. For example, a user accessing a PCI database needs enough trust to gain access. It is possible to quantify the trust requirements such as by giving user points for logging in with a username and password and using a known device and location. Yet access is not simply yes and no. | 5.8 | 
| Rotation, Trust over time | With zero trust, trust is earned or lost. One concept is that assets can lose trust simply due to time. The reasoning behind this is that the longer a machine has been in production, the more likely it is compromised or deviates from the baseline. This applies to more than systems; user, service, applications that utilize credentials and/or certificates. The longer these are in production, the more likely they are to be stolen and used. As a result, rotation is a necessary control within a zero trust architecture. | 5.9 |
| Remote Exploitation/Insider Threat, ZT Example | *SEE SLIDE:* a malicious cyber actor compromises a users device through an internet-based mobile code exploit. While a level of compromise occurs, damage is limited, and the time for defensive systems to detect and initiate appropriate mitigating responses is greatly reduced. | 5.1O |
| NIST SP 1800-35B |  Implementing a Zero Trust Architecture, builds up on NIST SP 800-207. This NIST Cybersecurity Practice Guide explains how 65 commercially available technologies can be integrated and used to build various ZTAs (see notes). TL/DR: no solution can provide full 100% ZT! | 5.11 |
| Policy Engine (PE) | The PE handles the ultimate decision to grant, deny, or revoke access to a resource for a given subject. The PE calculates the trust scores/confidence levels and ultimate access decisions based on enterprise policy and information from supporting components. The PE executes its trust algorithm to evaluate each resource request it receives.  | 5.11 |
| Policy Administrator (PA) | The PA executes the PEÂ’s policy decision by sending commands to the PEP to establish and terminate the communications path between the subject and the resource. It generates any session-specific authentication and authorization token; or credential used by the subject to access the enterprise resource. When combined, the functions of the PE and PA comprise a PDP. The PDP is where the decision as to whether or not to permit a subject to access a resource is made. These are essentially identity management solutions, access and credential management technologies supporting SSO and MFA, federated identity solutions, and identity governance solutions like Okta, Azure AD with Conditional Access. | 5.11 |
| Policy Enforcement Point (PEP) | The PEP guards the trust zone that hosts one or more enterprise resources. It handles enabling, monitoring, and eventually terminating connections between subjects and enterprise resources. It operates based on commands that it receives from the PA | 5.11 |
| Network-level PEPs |  such as: routers, switches, firewalls, reverse proxies, web application firewalls, software-defined networking, etc. Typically, network-level PEPs, such as routers, switches, and firewalls, do not integrate directly with Identity, credential and access management (ICAM) solutions but some are identity aware. <br> endpoint protection solutions in general do not typically integrate directly with ICAM solutions. However, some of the endpoint protection solutions considered for use in the builds have out-of-the-box integrations with the MDM/UEM solutions used, which provide the endpoint protection solutions with an indirect integration with the ICAM solutions. | 5.11 |
| Unified endpoint management (UEM) tools |  Tools for Policy Enforcement Point (PEP): The PEP guards the trust zone that hosts one or more enterprise resources. | 5.11 | 
| Endpoint ACLs via DLP | host-based firewalls, data rights management or any other technology connections between subjects and enterprise resources, Network Pep | 5.11 | 
| Zero Trust Maturity Model | is one of many roadmaps that agencies can reference as they transition towards a zero trust architecture. The maturity model aims to assist agencies in the development of zero trust strategies and implementation plans and to present ways in which various CISA services can support zero trust solutions across agencies. |  5.13 |
| zero trust model implementation | will be a journey through multiple stages for most organizations, not a one-step process, one that will vary organization to organization based on your business priorities, budget, personnel, regulatory environment and risk appetite among other things. | 5.13 |
| OMB, Office of Public Mgmt | shared some of their priorities in a public document that details their ZT journey: - Removing implicit trust of connections between systems, starting with HTTP and DNS - Deprecate decryption in transit with long-lived keys to favor context-aware decisions about visibility vs attack surface - Shifting away from traditional intranet/VPN model - Moving authentication to the application layer and use of phishing-resistant authentication methods - Treating everything as internet-accessible - Big emphasis on first/third-party testing (see new SEC568: Combating Supply Chain Attacks with Product Security Testing) | 5.15 |
| Zero-trust mindset | includes the importance of being able to develop a holistic picture of the major areas of risk of an organization, while at the same time being prepared to zero-in on the risks introduced by a particular device or a specific product and answer a key question: what is the risk to introduce this product? How will it increase my attack surface? How can I mitigate those risks with actionable defensive countermeasures | 5.15 |
| CIS Controls (version 8) | This new version refined previous recommendations. It adjusted prioritizations of some Controls and Safeguards based on expert consensus and validated by current threats to have the most impact in reducing risk.Within each of the 18 Controls, there is a set of Safeguards. The Safeguards comprise the more fine-grained recommendations to address the associated threats for that Control. Each Safeguard is categorized into one of three Implementation Groups (IGs), providing the prioritized recommendations that span the 18 CIS Controls. Controls v8 supports a zero trust architecture, while also aligning to the recommendations for built-in security, pervasive encryption, allow-list functionality, and supply chain security risk reduction called out specifically in the Cybersecurity Executive Order published in May 2021 | 5.17 |
| ZT Review | Least privilege should be founded on zero trust.; All access should be authenticated and verified.; Trust should be earned and dynamically adapt.; Know thy network is a must.Implementations should start with the basics.; Securing systems with critical data; Server to server communication (easier to start with); Always prioritize and balance based on high-value assets and security risk | 5.18 |
| Identity as a Perimeter | Probably one of the most important transformations for any organization that wants to implement ZT. Â•  It requires a short and long-term approach to managing: Identity, Authentication, Authorization:  Across people, devices, networks, workloads and data. <br> Identity/Authentication/Authorization: People, Devices, Networks, Workloads, Data | 5.2O | 
| Identity Management, ZT | Ensuring that information is accessed by the right users, at the right time, and for the right purposes is paramount. Doing this requires a strong way to verify the usersÂ’ identity when they attempt to access systems. This often requires consolidating the means of authenticating as much as possible and practicable. <br> Using centrally managed systems to provide enterprise identity and access management services reduces the burden on staff to manage individual accounts and credentials. It also improves knowledge of user activities, enabling better detection of anomalous behavior, allowing to more uniformly enforce security policies that limit access, as well as quickly detect and take action against anomalous behavior when needed. <br> A well-designed enterprise identity management system performs these functions and integrate into as many applications as possible. They should also be capable of supporting human authentication through non-graphical user interfaces, such as scripts and command line tools. <br> <br> For most enterprises, the **starting point is a Windows Server AD being replicated to the cloud Azure AD (now Entra ID)** using Azure AD Connect or the new Azure AD Connect cloud sync in a sort of hybrid identity. <br> *These solutions create a common user identity for authentication and authorization to all resources, regardless of location.* | 5.21 |
| Azure AD Connect cloud sync |  is a new approach for the synchronization of users, groups, and contacts to Entra ID. It accomplishes this by using a lightweight provisioning agent instead of the old school Azure AD Connect application that is based on MIM. Cloud Sync is not feature complete when compared with AAD Connect, namely it is missing the ability to sync devices, custom attributes, and perform device/group writeback. It does however support Password Hash Sync. | 5.21 |
| Password hash sync (PHS) | is a sign-on method used to accomplish hybrid identity. AAD connect syncs a hash of the hash, of a users password from on-premises AD to Azure AD. Password Hash Sync also enables leaked credential detection for these hybrid accounts. If username/password pairs are found in public breaches, the associated account is moved to high risk and conditional access policies can kick off to take action on the user. | 5.21 | 
| Identity Federation | Allows users to access resources across multiple domains or organizations with a single set of credentials...e.g., Dropbox, Salesforce, ServiceNow | 5.23 |
| Entra ID auth | supports provisioning users into applications hosted on-premises or in a virtual machine, via protocols like SCIM, LDAP, SQL, REST, SOAP or just simply PowerShell. | 5.23 |
| System for Cross-domain Identity Management (SCIM) | specification provides a common user schema to help users move into, out of, and around apps. SCIM is becoming the de facto standard for provisioning and, when used with federation standards like Security Assertions Markup Language (SAML) or OpenID Connect (OIDC), provides administrators an end-to-end standards-based solution for access management. | 5.23 |
| Security Assertion Markup Language,|  an XML standard for exchanging authentication and authorization data between applications.
| SAML SSO |  To implement SSO with SAML, two entities are involved, an identity provider and a service provider. The IdP is responsible for authenticating users and providing them with a SAML assertion, which is a signed XML document that contains information about the user's identity and attributes, while the service provider is the application that the user is trying to access. The SP trusts the IdP to authenticate users and will grant access to the application based on the information contained in the SAML assertion. A SAML assertion (also known as SAML tokens) carries sets of claims made by the IdP about the principal (user). It contains authentication information, attributes, and authorization decision statements. | 5.25 |
| Entra ID Attack Vector | Example shows how a rouge DHCP server, ARP Spoofing, or IPv6 RA can trick server into being the gateway for microsoft login and have MiTM Certificate trust by ADCS to recieve clear text creds | 5.27-29 |
| Entra ID, Attack Mitigations |   On-prem is still in most cases the weakest link. <br> Layered defense is vital, including: - Endpoint security and secure workstations 1, 2 - Network segregation and monitoring - Hardening against L2 attacks (e.g., ARP spoofing, DHCP, IPv6 RA) increases the attackers cost. <br> Privileged Access Management - Implement PAM solutions to enforce secure administrative access to the AD Connect server. - Monitor for abnormal activity. <br> Restrict access to certificate templates that allow server authentication and monitor enrollment. | 5.31 |
| Path of Least Resistance | Attackers are lazy! - You need to continue working on securing your on-prem identity management systems, implementing less implicit trust as these are often the weakest link, and the target of attackers. - This includes: User passwords (yes, we still have those),  Service accounts | 5.32 |
| NIST 800-63B | NIST 800-63B is on Digital Identity Guidelines: Authentication and Lifecycle Management. NIST clearly states password rotation is not recommended. "Verifiers SHOULD NOT require memorized secrets to be changed arbitrarily (e.g., periodically). However, verifiers SHALL force a change if there is evidence of compromise of the authenticator."1 Based on studies that show password rotation increases the likelihood of poor passwords | 5.33 |
| Password Policies | A major concern with password rotation is that end users who are forced to change passwords once a month or even once every couple of months end up choosing easier to guess passwords or permutations of previous passwords. This greatly increases the likelihood that an adversary can guess passwords or re-obtain previously compromised credentials. The results of this are primarily due to having poor password policies. | 5.34 |
| Fine-grained password policies | allow password policies to be set per user or group so long as that user or group is a global object in Active Directory. Server 2012 and Windows 8 and later can set a fine-grained password policy via the Active Directory Administrative Center. In Active Directory, you can manage fine-grained password policies (PSOs) using Powershell as well, but the Active Directory PowerShell module must be installed on the computer in order to do so. | 5.34 |
| Third-Party Password Policy Management | Microsoft's password policy allows weak passwords.Â• Winter2023! is susceptible to cracking and guessin; But meets complexity requirements <br> Third-party solutions provide granular policy requirements; Cannot contain dictionary term; Disallow characters at beginning or end of passwor; Present GUI breakdown of rule; Disallow passwords using common permutationsLinux pluggable authentication module (PAM) has granular support <br> <br> Some third-party solutions allow the installation of a client-side component that replaces the default password change GUI to include the password policy rules.| 5.35 |
| passfilt.dll. | This DLL handles password policy enforcement. When a third-party solution is used, then password policies become significantly more granular. Extra capabilities include but are not limited to the ability to block passwords that are an exact or partial match to a dictionary list, that begin with or end with certain characters, such as special characters or numbers, or that use common permutations that password crackers automatically attempt. | 5.35 |
| Password policy general rule | the more controls enabled in a password policy, the more training end users should have received. Also, it is important to explain why and notify users that it is to protect them and that they should follow the same rules in their personal life.  | 5.35 |
| Entra Password Protection | Users often create passwords that leverage common words or phrases that are generally aligned to their workplace, sports team, celebrity, or season/year...ect... <br> - These passwords are easy to guess and susceptible to brute force and password spray attacks. Entra Password Protection provides a global and custom banned password list for that purpose that gets applied to all Entra users by default. A password change request fails if there's a match found in the banned passwords list.  | 5.36 | 
| Banned password list, Custom | Used with Entra Password protection; focuses on organizational-specific terms can also be created, containing, for example: - Brand names - Product names - Locations, such as company headquarters - Company-specific internal terms - Abbreviations that have specific company meaning | 5.36 |
| Password Auditing | Passwords should be evaluated for weaknesses. <br> - Consider doing it before the adversary does.Possible to intentionally dump hashes and test them <br> - Get-bADpasswords can automate the process <br> - Hashes can be pulled from volume shadow copy <br> - Linux hashes in /etc/passwd and /etc/shadow <br> Hashes can be sent to system with GPUs: - Low-cost solution for password auditing | 5.37 |
| rainbow table | is the result of pre-computed password hashes saved in a database so that they can be quickly used to look up cleartext passwords.  The reason a strong password policy is necessary is to prevent passwords that are easy to guess or crack | 5.37 |
| Password cracking Solutions | If using to do auditing, it should be hardened and heavily segmented. If the system ever were to be compromised, an adversary would have access to company-wide password hashes. Also, the system should use graphics cards for password cracking. The math computations performed by a graphics card are thousands of times faster than CPUs, and so a system with one or more graphics card is more efficient. Lastly, you should have permission to implement this solution. Some countries or legal departments may object to the use of a password auditing solution | 5.37 |
| Service accounts | often are purpose-built for a specific application. Because of this service account, passwords often are never changed for fear of breaking the application. This can lead to problems, as service accounts often have elevated privileges and are not locked down or monitored appropriately.  ROTATE THEM | 5.38 |
| Local Admin Account | is recommended to be disabled, but organizations commonly enable it for troubleshooting purposes. Administrator account password is often the same across an organization. This typically is because the system was deployed using a gold image or master image, such as using Microsoft SCCM to deploy workstation images. | 5.38 |
| LAPS - Local Administrator Password Solution |  is a free tool capability from Microsoft. <br> - Newer version is now built into Windows since April 2023 <br> - Automatically rotates local admin password <br> - Can back up passwords to Entra ID Active Directory, encrypt passwords in AD and store password history in case you need to log back into restored backup imagesLAPS is centrally controlled via Active Directory but can also now be managed via a Configuration Service Provider (CSP) to administer Entra ID policies, and via Intune. | 5.39 |
| LAPS | part of the OS capabilities since the 2023-04 Cumulative Update for Windows update or later installed, for the following Windows editions:<br> - Windows 11 Pro, EDU, and Enterprise<br> - Windows 10 Pro, EDU, and Enterprise<br> - Windows Server 2022 and Windows Server Core 2022<br> - Windows Server 2019 <br> - Windows LAPS inherits many design concepts from the older Microsoft LAPS product which has been rebranded as Legacy LAPS. Legacy LAPS. A key difference is that Windows LAPS is an entirely separate implementation that is native to Windows. Windows LAPS adds many features that arent available in Legacy LAPS. <br> - The latest iteration can back up passwords to Azure Active Directory, encrypt passwords in Windows Server Active Directory, and store your password history. <br> The new LAPS also provides support for Microsoft Intune including the ability to rotate passwords. With this policy you can have devices automatically rotate the local admin account passwords on a schedule. You can also use the Intune admin center to manually rotate the password for a device as a device action. | 5.39 |
| LAPS Group Policy | Windows LAPS includes a new Group Policy Object that you can use to administer policy settings on Active Directory domain-joined devices. To access the Windows LAPS Group Policy, in Group Policy Management Editor, go to Computer Configuration > Administrative Templates > System > LAPSThe template for this new Group Policy object is installed as part of Windows at %windir%\PolicyDefinitions\LAPS.admx.| 5.40 |
|  MSA, managed service account  | is a type of domain account created and managed by the domain controller. It is assigned to a single member computer for use running a service. An MSA has the ability to register a Service Principal Name (SPN) within Active Directory when given read and write servicePrincipalName permissions. An MSA is named with a $ suffix, for example `DOMAIN\ACCOUNTNAME\$ | 5.41 |
| gMSA, group-managed service account (gMSA) | is an MSA for multiple servers. Windows manages a service account for services running on a group of servers. Active Directory automatically updates the group-managed service account password without restarting services. A gMSA solves many of the issues associated with MSAs. For example, a gMSA can be used across multiple hosts. This capability alone enables advanced use cases such as with clustering or load-balanced farms. Also, gMSAs can be used with scheduled tasks and mainstream applications such as Microsoft SQL 2014 or later. Also, gMSAs work with scheduled tasks. <br> <br> The use of gMSA requires an AD schema of Server 2012 or higher and a domain controller with the Microsoft Key Distribution Service enabled.| 5.41 |
| gMSA, group-managed service account creation |  to create, a KDS root key must first be created on a domain controller. To do this, the command Add-KdsRootKey needs to be run within PowerShell. After this command, you must wait 10 hours for the key to be replicated to all domain controllers. Then PowerShell can be used to create a managed service account and then PowerShell can be used on each host the managed service account is going to be used on. <br> The use of gMSA requires an AD schema of Server 2012 or higher and a domain controller with the Microsoft Key Distribution Service enabled.| 5.41 |