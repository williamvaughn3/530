| keyword | description | Page |
| --- | --- | --- |
| data-centric approach | focuses in on how to secure key data. For example, if you have a large database containing patient healthcare records, then that database needs more security controls than a database containing web server logs. Basically, a data-centric approach identifies key data and applies purpose-built technologies to help protect it. | 4.4 |
| network-centric | defense builts security moat | 4.4 |
| full stack security |  all components in an application stack need to be identified and secured. | 4.5 |
| three-tier app | that has a front end, a middle app tier, and a database. Traditionally, this app might be deployed in three different virtual machines. In a microservices architecture, the same app is broken into multiple components | 4.6 | 
| microservices |  instead of having every resource in the same code base, we will have those resources decoupled and assigned to individual services, with each service exposing an API that can be used by another service.1The APIs can be RPC-based, REST, or anything else really. Instead of executing a function call to access or change the state of a resource, we can execute a network request. | 4.6 | 
| Monolithic | Deployment: Simple and fast deployment of the entire system: <br> Scalibility: It is hard to maintain and handle new changes; the whole system needs to be redeployed <br> Agility: Not flexible and impossible to adopt new tech, languages, or frameworks <br> Resiliency: One bug or issue can affect the whole system <br> Testing: End-to-end testing <br> Security: Communication within a single unit makes data processing secure <br> Development: Impossible to distribute the team's efforts due to the huge indivisible database | 4.7 |
| Microservices | Deployment: Requires distinct resources, making orchestrating the deployment complicated <br> Scalibility: Each element can be scaled independently without downtime <br> Agility: Integrate with new technologies to solve business purposes <br> Resiliency: A failure in one microservice does not affect other services <br> Testing: Independent components need to be tested individually <br> Security: Interprocess communication requires API gateways raising security issues <br> Development:A team of developers can work independently on each component | 4.7 |
| Application Problems, Custom | Custom applications/websites are problematic. -Prior technologies like deep packet inspection fail. -No signatures for custom applications -No application control for custom applicationsThere is a need for custom security integrations. -Turnkey solutions do not exist for custom applications. -Products are available but require lots of adjustments. | 4.8 |
| Custom Application Problem | Custom applications/websites are problematic. -Prior technologies like deep packet inspection fail. -No signatures for custom applications -No application control for custom applicationsThere is a need for custom security integrations. -Turnkey solutions do not exist for custom applications. -Products are available but require lots of adjustments. | 4.8 |
| web application firewall (WAF) |  is a security control that focuses on securing web applications. A WAF is typically set up as a reverse proxy but can be a locally installed program or module on a web server. A reverse proxy setup allows for securing multiple sites and web servers in a centralized fashion; Needs additional security controls, most custom applications once in production never get code updates. Not having code updates effectively means never patched. | 4.11 | 
| Verizon Data Breach Report |, According to the report; web attacks remain the 2nd most common breach pattern. IPS or NGFW mitigate basic versions of the top 10 attacks. | 4.12 |
| OWASP Top 10, WAFs | WAF has strong focus on mitigating OWASP Top 10; List of 10 most critical web vulnerabilities; Such as injection and broken authentication or access controls; Perfect worldall code would be secure; Yet web applications are increasingly targeted. According to 2023 Verizon Data Breach Report, web attacks remain the 2ndmost common breachpattern. *IPS or NGFW mitigate basic versions of the top 10 attacks.; But are not designed to handle HTTP as deeply;* Due to complex payloads using the HTTP protocol | 4.12 |
| CSPs WAF solutions | AWS WAF; Azure WAF; Google Cloud Armor | 4.13 | 
| WAF deplyment, Cloud, fully managed service | The WAF runs in the cloud as a fully managed service. Users simply turn it on and configure it, with no management required other than setting up the desired networking policies. | 4.13 | 
| WAF deplyment, Cloud self-managed | The WAF is hosted in the cloud, but users are responsible for deploying, configuring and managing it. | 4.13 | 
| WAF deplyment, Cloud auto-provisioned | The WAF is hosted in the cloud. Although users have to configure and manage it, its automatically populated with networking rules designed to match the cloud environment. This approach offers a middle ground between fully managed and self-managed WAF options. | 4.13 | 
| WAF deplyment, On-premises advanced WAF | The WAF is hosted by on-premises infrastructure. On-prem involves more setup effort, and businesses have to provide the host infrastructure for the WAF. The tradeoff is greater control over how the WAF is configured. | 4.13 | 
| WAF deployment, Agent based or agentless host-based |  The WAF runs on host servers or application containers. Users may need to deploy agents to each server to host the web application firewallservice, but agentless approaches with firewall rules enforced are available | 4.14 |
| DDOS Scrubbing, WAF |  Commercial cloud WAF solutions offer DDOS scrubbing.; Scrubbing is a cloud service for preprocessing data.Simplest form is using DNS to route traffic first to cloud serviceCloud service integration possible at the enterprise level as well; Often consists of BGP and/or GRE tunnel integration; Can always be on or dynamic, but goal is to route traffic to vendorCloud Service | 4.15 |
| modSecurity | is an open-source web application firewall; Can be deployed as reverse proxy or local to serve; Allows for fine-grained control and do-it-yourself WAFCommercial solutions provide a nice GUI to work with; But may not be as flexible as ModSecurit; Rule syntax format as follows: *SecRule VARIABLES OPERATOR \[ACTIONS\]; <br> Example: *Deny Empty Host HeaderSecRule REQUEST_HEADERS:Host "^$" "deny,phase:1"* | 4.17 |
| ModSecurity phases |  Phase 1: Request Headers Phase 2: Request Body Phase 3: Response Headers Phase 4: Response Body Phase 5: Logging | 4.17 |
| WAF Challenges | WAF is not completely foolproof. Methods exist to identify a WAF is in place (fingerprinting). Multiple techniques exist to bypass WAF security. <br> Potential WAF issues: Each web server reacts differently to various requests. Many encoding techniques exist that are valid. Operating systems interpret paths differently.  *Default Settings may likely fail for some attacks* |4.18 |
| WAF Evasion | Putting in basic rules and failing to verify them against more advanced attacks is a common implementation flaw for WAF solutions. <br> ***SecRule REQUEST_FILENAME "@streq /admin.php" \"chain,phase:2,deny" SecRule ARGS:user "!^[a-zA-Z0-9]+$"*** <br> Rule looks for request to /admin.php with invalid user parameter; If user field does not match regex, deny the request; Bypass examples: */./admin.php, /abc/../admin.php, /./abc/../admin.php/, admin.php/abc/ADMIN.php, /AdMin.php* | 4.19 | 
| WAF Normalization | A WAF should attempt some level of normalization:; Against paths, variables, and everything else: <br> *SecRule REQUEST_FILENAME "@beginsWith /admin.php" \"chain,phase:2,t:none,t:normalizePath,deny"* <br> *SecRule ARGS:user "\!\\^\[a-zA-Z0-9\]+\\$\"* <br> @beginsWith allows path to include other valid data like PATH_INFO.<br> **t:normalizePath** tries to abstract encoding and evasion techniques from path.Recommended read: Ivan Ristic has great article on evasion called Protocol-Level Evasion of Web Application Firewalls1 (paper is defense-oriented) | 4.2O |
| Ivan Ristic | has great article on evasion called Protocol-Level Evasion of Web Application Firewalls | 4.2O |
| WebSockets | Not support by WAF, they represent a standard for bidirectional real-time communication over HTTP. Even if support is included, what level of inspection and understanding does the WAF have? Proper integration can be difficult even for age-old content types like XML or JSON. | 4.21 | 
| WAF Protocols | Web application firewalls are fairly mature.; Yet new protocols may not be supported by every vendor.; For example, many WAF solutions still do not support Websockets; Need support for newer protocols or technologies in use; Includes protocol support (HTTP 3.0/QUIC, WebSockets); Application content types (XML/JSON), WAF should include all capabilities your custom applications use <br>**The goal is not necessarily to support everything. Instead, the goal should be to have strong controls and capabilities for the services and feature sets used in your organization's custom web applications** | 4.21 | 
| WAF Manual Deployment | *manually**. This likely involves following a wizard and selecting the underlying operating system, web services, and databases in use. After the wizard, many additional settings have to be set. Manual implementation is extremely time-consuming, especially for granular security. For instance, you may have to add every single variable and the expected character sets for them. Extremely TIME CONSUMING | 4.22 |
| WAF automated Learning Mode | Website traffic is funneled through the WAF for a period of time, such as 30 days; WAF automatically identifies any variables, the submitted character sets, the max lengths, web methods, content types in use, expected status codes, and much more. Based on observed traffic, the WAF generates a policy that would allow future traffic that was within the constraints of the observed traffic. Statistical data such as length checks may be padded to minimize false positives. <br> *Learning mode runs the risk of learning bad behaviors, and it likely will not apply granular level controls to a site. Once a site has been learned, the site is flipped to either block or monitor mode. Also, it is possible to add custom settings to a learned policy* | 4.22,23 |
| WAF Allow Listing | More secure to allow only what is expected charaters, parameters, lenths, urls, and any vars, cookies, ect. have to hardcode everything, takes time | 4.23 | 
| Centralized protection, WAF | Possible to apply security policies across web servers; Examples: Add HSTS headers; Fine-grained control of error pages; Content routing; Multifactor authentication integration; CAPTCHA and rate limiting; Third-party scanner integration | 4.24 | 
| WAF Centralized protection | Possible to apply security policies across web servers; Examples: Add HSTS headers; Fine-grained control of error pages; Content routing; Multifactor authentication integration; CAPTCHA and rate limiting; Third-party scanner integration | 4.24 | 
| Vulnerability web scanners | are specific to web servers; Enterprise scanners can integrate with a WAF; Example: Acunetix, HCL AppScan, Invict; Process can be automatic or manual <br> Vulnerability reports can be imported into WAF solutions; Provides ***virtual patching*** of vulnerability; Automatic integration geared toward minimal false positives; *Which means vulnerability may still be exploitable* | 4.25 | 
| Virtual patching | uses a WAF to mitigate the risk without recoding the application.; True fix is to fix the vulnerable code; Virtual patching should be temporary.;  Often ends up being permanent; Problem is bypass may be possible; should be applied but only as a ***temporary Band-Aid solution.*** | 4.26 |
| WAF, Dynamic Actions | The higher the risk identified, the more restrictions applied; High traffic rate pops a CAPTCHA request.; Odd character submissions require email validation to continue.; Account or checkout lockouts requiring a phone call or chat | 4.27 |
| Dynamic Actions, WAF | The higher the risk identified, the more restrictions applied; High traffic rate pops a CAPTCHA request.; Odd character submissions require email validation to continue.; Account or checkout lockouts requiring a phone call or chat | 4.27 |
| Content Routing. WAF | can dynamically route traffic among web servers.; Capability intended for performance and load balancing; Can be used to add content to existing servers virtually; WAF is also capable of modifying requests/responses on the fly. | 4.28 |
| WebLabyrinth | is a PHP application that infinitely creates webpages.; Design is to confuse or break automated scanners; Supports automated alertingNormally would require setup on each server and require PHP; WAF can integrate WebLabyrinth into every web serverWorks best with robots.txt | 4.29 |
| robots.txt file |  is a file used to control automatic web crawlers. It is used to advise web crawlers such as Google what content should or should not be scanned. Weblabyrinth tool can help break / deter scanners | 4.29 |
| Traditional Web Security |  Castle and moat approach; Incoming requests will adhere to well-defined protocols that are mostly static; Clients will be using a web browser; Attacks can be detected by examining the requests | 4.3O |
| API Security |  The castle has lots of openings, and no moat; Incoming request formats can change frequently; Clients will probably not be using a web browser; Attacks are not necessarily detectable within the incoming requests | 4.3O |
| WAAP, Web App / API Sec | solutions combine the traditional WAFs capabilities discussed earlier, with advanced API features like discovery of web applications. | 4.32 |
| Web APIs | integral to numerous applications, allowing data exchange and functionality sharing; Many examples in notes, Secure With WAAPs | 4.32 |
| open-appsec | is a new WAAP open-source initiative powered by a supervised and an unsupervised machine learning model It can be deployed as an add-on to Kubernetes Ingress, NGINX, and API Gateways. <br> effective against zero-days attack such as Log4Shell, Spring4Shell and the recent Text4Shell - blocking them using the default settings and with no update. Of course, our experience recommends approaching these statements with caution as we know 100% is not feasible and machine learning models are prone to false positives and false negatives like every other security solution. | 4.33 |
| Runtime Application Self-Protection (RASP) | While WAF protects the applications from the network, RASP provides protection from the **inside** of the application itself. RASP complements  WAF as an additional data-centric control in a defensible security architecture. RASP are deployed as an agent or linked library that secures an individual application in real time, becoming part of the application, thus potentially affecting application performance. | 4.34 |
| RASP - Runtime Application Self-Protection | While WAF protects the applications from the network, RASP provides protection from the **inside** of the application itself. RASP complements  WAF as an additional data-centric control in a defensible security architecture. RASP are deployed as an agent or linked library that secures an individual application in real time, becoming part of the application, thus potentially affecting application performance. | 4.34 |
| WAF Detection | detection capabilities outweigh prevention.  Public sites are going to be attacked; Detection helps identify who, what, whereBest detection capabilities are for On-prem Server; Near impossible to attack a web server without flaggingWAF prevention will ultimately fail, so detection is a must. | 4.35 | 
| Database Monitoring and Controls | Critical data is often stored in a database. - Database security is different than web security.Database security primarily deals with: - Controlling who can access data - Applying limits to data access - Identifying sensitive data locations - Heavy detection focus | 4.41 |
| Database Logging | Most databases have logging disabled by default; May have generic service logs but missing logs on who did whatBuilt-in logging capabilities can be enabled.**Change tracking**: Record change logging; **Common compliance criteria**: Success and failure events; **Trigger logs**: Custom logging events; **Query logs**: Record SQL statementsEach can cause performance issues.; Logs are difficult to deal with and miss key information. | 4.42 |
| Database Security | Built-in security is decently strong.; Supports local or centralized authentication; Access can be restricted to databases, tables, or columns.;  Some databases even support record-level access.; Supports groups and custom roles; Defines ownership and privilege granting...Usually, supports custom views; Stored query to limit visibility | 4.43 |
| Database Security Issue | Databases are commonly paired with web servers.;  Web server can pass-thru user authentication to database; But it is common for a **service account** to be used. Creates a key security issue; User1 logs into web server to run report; Web server logs into database with svc_webserver; What privileges and access does User1 have? Either requires changing to pass-thru or custom code| 4.44 |
| pass-through authentication, Database | Pass-thru authentication is where user credentials from Windows single-sign-on are passed directly from a web service back to the backend database server. Pass-through authentication is usually enabled in a configuration file that is application specific.  Fixes security issues when end user is authenticated to the database directly or use an advanced authentication solution such as with a database firewall.  | 4.44 |
| Content Discovery | Securing data requires knowing where data resides. Certain fields usually intended for sensitive data *SSN, credit card numbers, driver's license*;  Other fields are not supposed to but have sensitive data, *Comments, additional info, notes*;  You must perform content discovery on a regular basis. Involves crawling through databases and filesystems looking for data where it should not be; see Identity Finder tool | 4.45 |
| Identity Finder | tool that searches selected areas of your computer for sensitive data and provides tools to protect or securely dispose of this information. Sensitive data includes, but is not limited to, passwords, social security numbers, credit card numbers, and bank account numbers. | 4.45 |
| Data Masking | Possible to show partial matches or entirely mask data; Data masking hides actual values from certain users.One user sees social security number 123-45-6789 The second user sees social security number XXX-XX-6789 <br> Masking allows certain business processes to continue.; While potentially limiting risk of stolen dataProblem is many database solutions do not support masking; And service account use interferes with masking implementation. | 4.47 |
| Dynamic data mask exampl | *ALTER COLUMN [Social Security Number] ADD MASKED WITH (FUNCTION = 'partial(0,"XXX-XX-",4)')* |4.47 |
| Record Limits | Large data breaches are occurring more often; Commonly a web service with massive database stolen; Zeek can provide traffic monitoring and integrate with a SIEM (example: mysql.log)Even if prevention controls do not exist using record limits; Alert on records pulled by source or app that exceed threshold <br> Threshold per single session; Threshold per aggregate sessions within a time frame; Potentially threshold alert per all sources per time frame | 4.48 |
| Database Security Strategies | <br> - Conduct database-centric vulnerability scans with database authentication<br> - Specialized database security audit and assessment tools (i.e., Trustwaves AppDetectivePRO)1provide a more focused analysis<br> - Microsoft baseline security analyzer (MBSA)2can also perform checks on SQL server<br> - The Center for Internet security (CIS) benchmarks3provide hardening guidance up to SQL Server 2022<br> - Dont stop with baselines and compliance. Conduct robust penetration testing on all of the attack surface. | 4.49 | 
| Microsoft Baseline Security Analyzer (MBSA) | can also perform checks on SQL Server. For database hardening, Microsofts Security Baselines and the Microsoft Security Compliance Toolkit offer valuable guidance for SQL Server | 4.49 | 
| Ponemon Study | estimates average cost per record $146; In 2023, the average cost of a data breach in the United States amounted to 9.48 million U.S. dollars, up from 9.44 million U.S. dollars in the previous year. <br> Encryption at rest protects data from disclosure; Significantly decreases costs and risk of data breach; Implementation varies based on what is being encrypted. | 4.52 |
| Data Cost | USB drive with 10,000 records could result in costs between $710,000 and $3,800,000 if those records were not encrypted. <br> **Ponemon Study** estimates average cost per record $146; In 2023, the average cost of a data breach in the United States amounted to 9.48 million U.S. dollars, up from 9.44 million U.S. dollars in the previous year. <br> Encryption at rest protects data from disclosure; Significantly decreases costs and risk of data breach; Implementation varies based on what is being encrypted. | 4.52 |
| Cost, Data | USB drive with 10,000 records could result in costs between $710,000 and $3,800,000 if those records were not encrypted. <br> **Ponemon Study** estimates average cost per record $146; In 2023, the average cost of a data breach in the United States amounted to 9.48 million U.S. dollars, up from 9.44 million U.S. dollars in the previous year. <br> Encryption at rest protects data from disclosure; Significantly decreases costs and risk of data breach; Implementation varies based on what is being encrypted. | 4.52 |
| Database-level Encryption | Encrypts entire database (file) at rest Encryption handled with symmetric key; Key protected by certificate or extensible keymanagement (EKM) module| 4.54 |
| Table-level Encryption | Encryption per table Encryption handled with symmetric key; Key protected by certificate or extensible keymanagement (EKM) module| 4.54 |
| Cell-level Encryption | Encrypts data per specific **columns**. <br> Encrypting only specific columns is believed to perform better than table and database encryption. However, cell-level is often slower due to the way it operates. Usually, cell-level encryption is only a better option if queries are optimized to exclude encrypted data whenever possibl Encryption handled with symmetric key; Key protected by certificate or extensible keymanagement (EKM) module| 4.54 |
| extensible key management (EKM) | module or hardware security module (HSM). These are special hardware solutions and software interfaces that secure the methods and the symmetric key that performs data encryption | 4.54 |
| hardware security module (HSM) | These are special hardware solutions and software interfaces that secure the methods and the symmetric key that performs data encryption | 4.54 |
| Encrypted File System (EFS) | a built-in capability to encrypt files or folders on an NTFS partition. Often EFS is underrated. It uses strong encryption algorithms and when implemented properly is unlikely to be decrypted. In fact, EFS has a major issue in that if it is not properly deployed, access to data can be lost permanently. EFS uses AES encryption and is part of the NTFS filesystem. <br> If a Windows public key infrastructure is available, the asymmetric keys are generated using the internal PKI. Using an internal PKI is the ***recommended solution***, as the certificates are held and replicated through Active Directory domain controllers, and multiple recovery key agents can be authorized for private key recovery;  | 4.55 |
| PKI, EFS | Internal PKI Windows - the asymmetric keys are generated using the internal PKI. Using an internal PKI is the ***recommended solution***, as the certificates are held and replicated through Active Directory domain controllers, and multiple recovery key agents can be authorized for private key recovery; <br> No Internal PKI infra: self-signed certificate is created and used for protecting the symmetric key. In this instance, the local administrator of a box is the only key recovery agent.  Attacker can gain access  | 4.55 |
| Full Disk Encryption (FDE) | Instead of encryption files, folders, and databases, why not just encrypt everything?; Multiple hardware/software solutions; Performance impact <10% and usually < 5%; Mandated by most cyber insurance and compliance standards; Depending on solution, disk encryption requires user interaction.; User PIN or password common; USB key can act as unlock key; Trusted Platform Manager (TPM) may allow automatic boot.  **FDE Can Protect against BootKit Attacks** | 4.56 |
| Disk encryption solutions, (FDE) | use symmetric keys to secure data, but the symmetric key is protected by an asymmetric key that is locked by one or more means of authentication. Commonly, this authentication is in the form of a user PIN or password. However, USB keys or TPM can be used. | 4.56 |
| Kon-Boot | is a hacking tool used by booting to a USB or CD.; System boots to Kon-Boot, which hooks BIOS; Then Kon-Boot modifies Windows kernel in memory.; Works on all versions of Windows from XP to Windows 11, and Mac OS; Now authentication verification is bypassed.Can log in to any local or domain cached account; Or can log in to local administrator; *All without modifying end system.* **Prevent with FDE or locking down BIOS** | 4.57 | 
| VeraCrypt | is an open-source disk encryption solution. Supports full disk encryption with passwords or key files Supports dual boot operating system deployments Allows creation of hidden operating systems Works on Windows, Linux, Unix, and MacCan also create encrypted containers Container is an encrypted file mounted as a drive Intent is to dismount drive when not in use | 4.58 |
| BitLocker | Windows 11 Pro, Enterprise and Education include BitLocker.; Applies to Windows 10 as well.BitLocker supports full disk AES-256 encryption; Can encrypt USB drives (BitLocker To Go); Supports password and smart card unlock as well as auto unlockEncrypting disk generates 48-character emergency recovery keys; Keys can be backed up to Active Directory or Entra ID.; Supports scripting and native to asset management platformsRequires Trusted Platform Module for automatic boot handling | 4.59 |
| FileVault, Apple | works much like BitLocker and can also be used with Intune and EntraID. Entra ID can also handle encryption keys for Linux systems as well. | 4.59 |
| Azure Disk Encryption, | it employs Key Vault to store the key instead of a TPM. | 4.59 |
| Transparent Encryption | refers to a method of encrypting data at rest, where the encryption and decryption process is transparent to the user and the application. This means that the user or application does not need to take any explicit action to encrypt or decrypt the data. | 4.59 |
| Trusted Platform Module (TPM) | Uses full disk encryption uses a symmetric key for data encryption. The symmetric key is protected by a volume master key, and that volume master key can be protected in a few different forms. Commonly, the user uses a PIN or password at boot time to unlock the volume master key. However, if a trusted platform module (TPM) is integrated into the motherboard, the volume master key can be protected by it. | 4.6O | 
| BitLocker Network Unlock | Server 2019/Windows 10 and later support network unlock.; Allows TPM + PIN without user intervention; Requires UEFI firmware and proper DHCP settings; Also requires Windows Deployment Services (WDS)WDS uses asymmetric keys to secure DHCP communication.; Public key distributed to network unlock clients; Public key of WDS encrypts second copy BitLocker volume key; Client encrypts this with WDS public keyB |  4.62 | 
| WDS Network Unlock  | Server 2019/Windows 10 and later support network unlock.; Allows TPM + PIN without user intervention; Requires UEFI firmware and proper DHCP settings; Also requires Windows Deployment Services (WDS)WDS uses asymmetric keys to secure DHCP communication.; Public key distributed to network unlock clients; Public key of WDS encrypts second copy BitLocker volume key; Client encrypts this with WDS public keyB |  4.62 | 
| Data governance | greatly impacted by:; File classification; Data loss prevention; Information policy enforcement | 4.66 |
| File Classification | To control and audit sensitive files requires classification.D:\pci_share\530_backup.xlsx <- Contains PCIMaybe files in pci_share are expected to have PCI data; File server is properly segmented and intended for PCI....Yet user with read access can copy it to local boxAssume you saw a file called 530_backup.xlsx on a desktop.; Would you assume it had credit card data?; File classification adds tags to identify and control files. | 4.68 | 
| Win File Classification Infr | Server 2008 R2 and later support file classification; Requires File Server Resource Manager (FSRM) roleAllows assigning properties to files; Properties can be anything.; Clearance required; Level of PII; Whether something is PCI or EPHI; Date something occurred; Impact of disclosure; 2012+ has prepopulated properties, to enable go to ADAC/Dyanamic Access COntrol/ Resource Properties | 4.69 |
| Update-FsrmClassificationPropertyDefintion |  File Property tool, it typically will not work immediately after updating a property in Active Directory. Be patient. The property or properties will show up on file servers | 4.7O |
| Alternate Data Streams (ADS) | File classifications are stored in alternate data streams. Feature of NTFS that allows data to be attached to existing data; <br> get-content -path C:\test\sec530.txt -Stream "FSRM{ef88c031-5950-4164-ab92-eec5f16005a5}" | 4.71 | 
| Automatic Classification Rules | Multiple methods to set properties on files; **Manual**: User sets properties on one or more files at a time; <br> **Location-based**: Automatically sets properties if file exists in a folder (folder classifier); **Content-based:** Automatically set properties based on content or regex pattern within file (content classifier)Automatic classification can run in *continuous mode or on schedule.*; Continuous mode is not real-time but fairly quick. Regex and basic pattern matching are used to set classification rules. | 4.72 | 
| PowerShell classifier | is one of the options to select for automatic classification. What it does is run PowerShell code against files as they are created or modified. PowerShell code used as a classifier can do anything. An example of PowerShell code that could be integrated as a PowerShell classifier is included in your course media file, in a script called ocr.ps1. | 4.73 | 
| Data Expiration | More data you have, the higher the risk <br> File management tasks integrate with FCI;    Data expires based on conditions:;Days since creation;Days since modified;Days since last accessed;One or more file properties;    Supports email pre-notifications | 4.74 |
| Optical Character Recognition (OCR)  | File classification supports OCR of TIFF (faxes and scans).; Vendor solutions have more file support and OCR capabilities.Possible to live off the land with  PowerShell; Find certain files such as JPG; OCR scan them looking for sensitive data; If sensitive content found, add file property; Can be integrated into automatic classification | 4.73 | 
| OCR | File classification supports OCR of TIFF (faxes and scans).; Vendor solutions have more file support and OCR capabilities.Possible to live off the land with  PowerShell; Find certain files such as JPG; OCR scan them looking for sensitive data; If sensitive content found, add file property; Can be integrated into automatic classification | 4.73 | 
| Windows FCI  | supports automatic data expiration. The expiration policy supports notifying individuals in advance of data expiration and instead of deleting data can move it into a staging folder. Automatic expiration can be set based on file classification policies as well as how long it has been since the file was created, modified, or last accessed. | 4.74 |
| Data Expiration | Windows FCI supports automatic data expiration. The expiration policy supports notifying individuals in advance of data expiration and instead of deleting data can move it into a staging folder. Automatic expiration can be set based on file classification policies as well as how long it has been since the file was created, modified, or last accessed. | 4.74 | 
| File classification, Windows | stores properties using alternate data streams. Because of this, file properties will be lost if the file is moved to a file system that is not running NTFS. Fortunately, files copied to office 365 or SharePoint systems do not lose their properties. | 4.75 | 
| Purview | (formerly Azure Information Protection) Microsoft FCI is out of support now, but Office 365 and SharePoint Online can still integrate with it. Microsoft has replaced it with *Purview Information Protection* (formerly AIP).; Similar to AD Rights Management Services (RMS) (on premise); *Neither Purview nor AD RMS are free*...can also classify and label data like FCI...properties and content are handled completely different.  Can work both onprem and in cloud | 4.76 |
| Purview |and Windows Rights Management support a better method of classifying and protecting documents.  Classification process and data are being protected with encryption. Every new file has a random AES key generated that encrypts a file's content. The AES key is then encrypted by the organization's public key, which belongs to either Azure Information Protection or the Rights Management server. Also, the file is signed using the private key of the user classifying the file. <br> During the encryption process, the file contents are encrypted, and the policy restrictions on who can access the file become part of the file. Putting the file classification and policy settings on each file allows protections even if a file leaves the organization | 4.77 |
| Sensitivity Labels |  part of the Microsoft Purview Information Protection...Anyone with an Office 365 license can read documents or emails protected by labels. Users require Office 365 E3 or above to apply a label manually, while automatic policy-driven application of labels requires Office 365 E5 or the Microsoft 365 E5 compliance licenses. <br> Works with all office, Sharepoint, M365, on outlook / teams... | 4.79 |
| Purview Information Protection Scanner | Information Protection can scan and label files across on-premises file servers, Azure, S3 buckets, and SQL databases.  Once you have configured the scanner to scan the locations where you store your files, you can create a content scan job to scan the files and apply sensitivity labels. | 4.8O | 
| SITs | SITs are used to detect sensitive information in an organizations documents, files, emails, chats, etc. Policies can be created to take an action if the SIT gets a match. For example: <br> Could tag an Excel Workbook with the sensitivity label Highly Confidential <br> Warn a user that they may be trying to share something inappropriately <br> Block a user from sharing a document containing something sensitive <br> Could prevent the sensitive information from being displayed in a Teams chat <br> Be set up to perform a regulatory compliance scan to safeguard against potential insider trading | 4.81 |
| Sensitive Information Types / SITs | SITs are used to detect sensitive information in an organizations documents, files, emails, chats, etc. Policies can be created to take an action if the SIT gets a match. For example: <br> Could tag an Excel Workbook with the sensitivity label Highly Confidential <br> Warn a user that they may be trying to share something inappropriately <br> Block a user from sharing a document containing something sensitive <br> Could prevent the sensitive information from being displayed in a Teams chat <br> Be set up to perform a regulatory compliance scan to safeguard against potential insider trading <br> Every SIT has a Name, Description, and a Pattern. The **Pattern is the definition of what the SIT is looking for and can be expressed as a regular expression**. | 4.81 |
| Data Loss Prevention (DLP) | Data loss prevention focuses on protecting data from unauthorized access or placement.Combination of content inspection and file context, such as file classifications <br> **Network:** Detects and blocks network use of data <br> **Data at res:** Discovers and deals with unauthorized data placement <br> **Endpoin:** Detects and blocks endpoint use of dataPrevention in  | 4.87 | DLP ignores emphasis on detection | 4.87 | 
| Network-Based DLP | Network systems capable of performing content inspection; Next-generation firewalls; Secure web gateways ; Secure email gateway; Intrusion detection system; ICAP integration can integrate vendor DLP solutions;  Example: NGFW and web proxy likely support ICAP; Be careful of encryption blindness.; Web application firewalls; Database firewalls; Network security monitors | 4.88 | 
| data preprocessors, DLP. | Snort example for the preprocessors... These preprocessors have native capabilities to look for things like credit card numbers, social security numbers, and driver's licenses. What is unique to the sensitive data preprocessors is that they can be configured to mask sensitive data that may be logged within packets associated with alerts. Masking sensitive data is important, as full data disclosure is not necessary to chase down alerts. | 4.89 |
| DLP with NGFW | NGFW positioned well for network inspection; Gateway to the internet + potential TLS inspection; IPS engine can be used just like IDS; DLP built in; DLP likely using IPS engine; But has support for firewall agentsFirewall agents may be extra cost; Sometimes are free | 4.9O |  
| DLP with IDS | IDS/IPS rules can look for specific content <br> *'alert tcp any any -> any any (pcre:"/4\d{3}(\s\|-)?\d{4}(\s\|-)?\d{4}(\s\|-)?\d{4}/"; <br> msg:"DLP PCI Visa number in clear text"; sid:1053000; rev:1;)'* <br> <br> IDS usually includes sensitive data preprocessors.; Native capabilities to detect credit card numbers or other sensitive data such as social security numbers; Can be configured to only monitor certain hosts or networks; Can mask sensitive data in alert data and packet captures | 4.89 | 
| DLP multiple purposes. | One of the most important aspects of DLP is to train users on what they can and cannot do and what they should and should not do. Network-based DLP aids in completing this task. DLP also is designed to prevent unauthorized exfiltration of data. An adversary attempting to steal data may try just to shove it out the firewall. In this case, network DLP will detect and prevent it. The attacker can then change tactics and eventually get the data out, but hopefully the time between initial detection and response is minimized to prevent or lower damages. | 4.91 |
| DLP, CLoud | Apps may have DLP built in, Sharepoing O365, ect. | 4.92 |
| File Relocation, DLP | Files end up in unauthorized locations.; Scripts can be scheduled to find and handle exceptions.; DLP agents do the same with centralized management. <br> Exception handling: Move file to authorized locationReplace the previous location with shortcut or text file to new location Notify user of policy violation and request cleanup <br> Ability to report on policy violations is underrated | 4.93 | 
| DLP, File Relocation  | Files end up in unauthorized locations.; Scripts can be scheduled to find and handle exceptions.; DLP agents do the same with centralized management. <br> **Exception handling: M**ove file to authorized location; Replace the previous location with shortcut or text file to new location Notify user of policy violation and request cleanup <br> Ability to report on policy violations is underrated | 4.93 | 
| policy violations DLP  |  can be dealt with by warning the user and notifying them that they have a certain time frame to move data to an authorized location before being reported to human resources or attempting automatic cleanup. Cleanup usually includes moving files to trusted locations or purging them (usually with some form of backup). | 4.93 |
| Stubbing DLP  | involves moving the file to a new location and then leaving either a shortcut or a text document that references the new location. | 4.93 |
| DLP Agents | Agents provide a lot of capabilities for protecting data. <br> Automatic file classification and recommendations <br> Provide on-screen notifications and policy violations <br> Can require user to provide reason for odd behaviorRequires agent deployed and running on all systems <br> Agent capabilities provide data policy enforcement. | 4.94 |
| Agents DLP | Agents provide a lot of capabilities for protecting data. <br> Automatic file classification and recommendations <br> Provide on-screen notifications and policy violations <br> Can require user to provide reason for odd behaviorRequires agent deployed and running on all systems <br> Agent capabilities provide data policy enforcement. | 4.94 |
| DLP Agent Bypass | Administrator access can disable, uninstall, or bypass agent;     Motivated adversary will be capable of bypassing agent; Content can be written with encryption or encoding.; Partial data reads and writes can evade DLP monitoring.; Shadow copiesDefense with DLP is still significantly improved.;     Why is service not running or agent uninstalled?;     Why did multiple sensitive files just have policy violations? | 4.95 |
| Agent Bypass, DLP | Administrator access can disable, uninstall, or bypass agent;     Motivated adversary will be capable of bypassing agent; Content can be written with encryption or encoding.; Partial data reads and writes can evade DLP monitoring.; Shadow copiesDefense with DLP is still significantly improved.;     Why is service not running or agent uninstalled?;     Why did multiple sensitive files just have policy violations? | 4.95 |
| Data policies | control who, when, and where data is used.; Should include how data MUST be protected; Enterprise data control requires a combination of: Proper file classification; Data loss prevention capabilities; Ability to implement and enforce data policies; Knowing thyself <br> For successful data governance, a data policy must be enforceable. Typically, file classification will identify file properties to associate a data policy, and either a DLP agent or built-in operating system capability will enforce a data policy. | 4.99 |
| Access-Denied Assistance | Example of a simple data control is notifying users of violations; Windows has built-in access-denied assistance; Visually notifies user of policy violation; Configured via Group Policy Object (GPO) and PowerShell | 4.10O | 
| access-denied assistance | This capability allows administrators to customize the error message individuals receive when accessing a file for which they do not have permission. The error message can be customized to warn the user they are attempting to access a file they are not authorized to see, and it can also provide them a form to request access if they feel they should have access. | 4.10O | 
| Dynamic Access Control (DAC) | Simple access control lists are insufficient.; Group membership is hard to control and inflexible.; Other details need to factor into access.; What device is being used?; Who is accessing device, and what attributes do they have?; How does this apply to file classifications?Access controls need to be calculated on-the-fly; In the past Microsoft used Dynamic Access Control; Microsoft removed DAC from Windows Server 2022 and Windows 11 and recommends moving to Role-Based Access Control (RBAC) | 4.101 | 
| Entra ID and RBAC | Entra ID utilizes role-based access control (RBAC) to authorize entities based on roles. It uses three elements to do so: <br> 1.  Security principal: an identity that gets thepermissions. Could be a user, a group, aservice principal or a managed identity.<br> 2. The role: specifies the permissions that thesecurity principal has. <br> 3. Scope: a scope defines the set of MicrosoftEntra resources the role member has accessto. The most common scope is organization-wide (org-wide) scope. | 4.102 | 
| Entra ID, Conditional Access | Entra ID and RBAC allow some unique features including:    <br> Dynamic membership rules for groups <br> Just in-time access through the Privileged Identity Management serviceThis can put you on the road to implement conditional access policies.     <br> For example, when a user attempts to access applications, conditional access policies can ensure a user has seen and agreed to the terms of use prior to being able to access an application. | 4.103 | 
| Conditional access | allows businesses to set and implement policies depending on the context and conditions of access requests for apps and resources. It facilitates authentication and authorization based on both risk and attributes.  When a user tries to access a particular resource, the system analyzes the request's context, such as the user's location and the device being used. Based on these identity-related indicators, a decision is made. <br> Conditional Access *acts as the decision-making entity,* assessing these signals to determine if the access can be granted, needs to be denied, or if additional verification is necessary. The request is then directed to the relevant enforcement mechanism to execute the determined action. | 4.103 |
|  Just in-time access | can be used with conditional access stuff, through the Privileged Identity Management service | 4.103 | 
|  time restrictions | To secure using Windows logins, *Computer Configuration -> WindowsSettings -> Security Settings -> LocalPolicies -> Security Options*, the setting forces SMB connections to disconnect if the Active Directory user is not allowed to work during certain time periods. This group policy setting must be applied in the Default Domain Policy. | 4.104 | 
| Cloud Time Restrictions |  tendency to focus on always-on data access. Operationally, this is great, but from a security perspective, it is horrible. For example, most cloud-based applications do not support limiting when data can be accessed in terms of time. For example, Microsoft allows login time restrictions for on-premise solutions, yet their cloud applications do not support the same capability. This holds true unless logins are integrated with on-premise authentication and control. OPtions such as scripting, API stuff may help implement, some 34d Party ZTNA solutions can offer restrictions too.| 4.105 |
| Time Restrictions w/ NGFW | can also help time enforcements as well as the direction data is permitted to travel. Previous slides show that NGFW is capable of DLP. This capability is primarily preventive control used for data leaving the organization. However, an NGFW can be used to implement time constraints on when devices can move data between internal assets or the internet.Given an NGFW also can incorporate per user and per device constraints, an NGFW can act as a data flow switch. Specifically, an internal firewall use can be used to enforce data boundaries. These boundaries can be basic Layer 4 boundaries or can drill down into application-specific boundaries. Organizations often focus on outbound access, which is critical, but internal to internal access should restrict the flow data can take. | 4.106 |
| Removable Media, DLP  | Data copied to removable media poses a massive risk. <br> DLP solutions support lockdown of external hardware. <br> Includes storage and other devices like webcamsAble to block unauthorized and unencrypted portable storage by default <br> Using BitLocker To Go and the below GPO settingDeny write access to removable drives not protected by BitLocker. Can be set to only allow BitLocker drives from specific organizations <br> *Computer Configuration\Administrative Templates\Windows Components\BitLocker Drive Encryption*| 4.107 |
| BitLocker To Go | which encrypts portable media and can block write access to all noncorporate portable storage devices and even corporate devices not using BitLocker <br> Windows systems can access BitLocker drives with read-only access if a GPO enables the setting called "Allow access to BitLocker-protected removable data drives from earlier versions of Windows.  - *Computer Configuration\Administrative Templates\Windows Components\BitLocker Drive Encryption* | 4.107 |
| Data Protection Policies | Multiple technologies available to apply policies to data; <br> RMS and Information Protection help with discovery,classification and protection.; <br> Start migrating from DAC to RBAC.; <br> Group policy can enforce certain settings.Third-party solutions may provide a more holistic approach.; <br>  Such as Mobile Device Management | 4.108 |
| BYOD Centralized Approach| The** most common approach to BYOD implementations**, untrusted devices to access resources within a corporate data center remotely.  With this model, *data stays centralized to the corporation and is intended never to be stored on the device being used.* <br>  The BYOD system uses a remote application to access a terminal server, a virtual desktop, or a streamed application.User input and data manipulation occur at the remote system | 4.112 |
| BYOD Centralized Security Approach | When using untrusted devices with a remote application, it is critical that remote access is locked down. Specifically, data should not be able to go from the data center to the untrusted device. To apply this solution, you need to disable local device drive mapping and disable the copy and paste clipboard or limit the clipboard to only systems within the corporate network. <br> Multifactor authentication is also recommended...any public-facing remote access method should use multifactor authentication. SMS and voice callback are popular multifactor options. But in the context of BYOD, those authentication mechanisms do not make sense. Having them is still better than normal username and password authentication only, but if the device is compromised, then authentication codes sent to the BYOD device will be intercepted. <br> Some carriers like Verizon allow you to read all your text messages online, breaking the assumption of "something you have; also, NIST has said you should not use SMS. | 4.113 | 
| Mobile malware | undermines security with: **Keyloggers**, Username/passwords and data stolen by: <br> **keystrokeScreen scraping**: Recording screen or taking screenshots <br>**TLS Spoofing**: Install evil CA certificate and monitoring traffic; Certificate pinning helps but adds its own risks. | 4.114 |
| Keyloggers |  Username/passwords and data stolen by: byod, mobal malware risks | 4.114 |
| keystrokeScreen scraping |  Recording screen or taking screenshots byod, mobal malware risks | 4.114 |
| TLS Spoofing | Install evil CA certificate and monitoring traffic; Certificate pinning helps but adds its own risks. byod, mobal malware risks | 4.114 |
| Mobile Device Management (MDM) | Device providers such as Android and IOS provide mobile device management (MDM) APIs.; Some standalone capabilities; Primarily designed for third-party use.  Abstracts corporate resources from personal use and access; Uses either corporate workspace approach; Or application containerization <br> MDM solutions work by allowing either complete or partial control of devices. This control allows the establishment of security standards in order to access corporate resources. | 4.115 |
| Workspaces, MDM | MDM may force the use of workspaces.; Allows user to switch between personal and corporate profiles; Similar to having two separate phones or personalities; *Corporate workspace policies typically require password or PIN*; Entering unlocks encrypted partition of device; Policy requirements and restrictions only affect corporate assets. **Personal Workspace**; No security; ** Corporate Workspace**: Policy enforced; Limited apps | 4.116 |
| Application Container | Containerization is the process of abstracting applications from the mobile device. Putting an application in a container allows applications to have completely different security requirements and data policies. Can be run for personal reasons but then when called from a corporate protected container, must store data in a separate location that is encrypted and follows corporate data policies.  End user experience is identical to normal phone use. <br> - The only difference is that when opening a corporately controlled application, additional security mechanisms may be enforced, such as a separate authentication mechanism.Application containerization is not to be confused with Docker containers. In this instance, an application container is referring to an abstraction of mobile applications from the operating system. | 4.117 |
| Microsofts Mobile Device Management Platform | Intune App Protection Policies for BYOD. Helps protect corporate data on unmanaged devices by allowing for a bring-your-own (BYO) scenario. The main distinction here is that MAM is about managing/protecting the apps and their associated data and MDM is about managing/protecting the device itself. | 4.118 |
| Microsofts Mobile Device Management Platform device enrollment | Device enrollment secures the device so that it aligns with the organization's policies. Intune deploys and enforces policies through a management profile, which is installed on the device during the enrollment process. The main distinction here is that MAM is about managing/protecting the apps and their associated data and MDM is about managing/protecting the device itself. | 4.118 | 
| MDM Example | example on slide | 4.12O |
| Intune with Conditional Access | Conditional Access works with Intune to enforce policies based on device risk.  This can be calculated based on signals  like user, location, device and application details or real-time risk score. <br> | 4.121 | 
|  MDM solutions, Byod | make a bad situation better.... Policy enforcement can require password/PIN requirements.... Force app scanning and antivirusMDM security fails in comparison to traditional system... MDM device visibility and logging not even close to traditional Windows/Mac/Linux desktop/laptop... Prevention technologies not as mature... Use of personal and corporate fails secure workstation model <br> If possible, production applications such as browsing the internet and reading emails should be segregated from core business activities. The former system is likely to get compromised, and the latter is not. With BYOD, all access is funneled through an untrusted device. Even if antivirus or other solutions are included for free to the end user, the level of security cannot match internal assets, mainly due to tuning and lack of visibility to both the endpoint and network (NSM, logging, allow listing, etc.). Therefore, if BYOD is going to be used, additional precautions such as locking down the remote application's access or implementing BYOD with data access policies and encryption for workspaces or containers should be in use. | 4.122 |
|  BYOD, MDM Solutions | they make a bad situation better.... Policy enforcement can require password/PIN requirements.... Force app scanning and antivirus...MDM security fails in comparison to traditional system... MDM device visibility and logging not even close to traditional Windows/Mac/Linux desktop/laptop... Prevention technologies not as mature... Use of personal and corporate fails secure workstation model <br> If possible, production applications such as browsing the internet and reading emails should be segregated from core business activities. The former system is likely to get compromised, and the latter is not. With BYOD, all access is funneled through an untrusted device. Even if antivirus or other solutions are included for free to the end user, the level of security cannot match internal assets, mainly due to tuning and lack of visibility to both the endpoint and network (NSM, logging, allow listing, etc.). Therefore, if BYOD is going to be used, additional precautions such as locking down the remote application's access or implementing BYOD with data access policies and encryption for workspaces or containers should be in use. | 4.122 |
| Private Cloud | Organizations likely using private cloud in data centers;   Cloud = Cool sounding word that means nothing;   Mostly used to describe virtualization platformsHypervisor abstracts hardware and shares among virtual operating systems | 4.126 |
| cloud | is overused and misunderstood. Cloud can refer to websites, applications, platform as a service, internet connectivity, and many other things. Originally, the push for the cloud was based on hypervisor platforms, with the main difference being a locally ran hypervisor is usually referred to as a private cloud, while using an online provider that provides a hypervisor platform as a service is referred to as a public cloud. The concept and differences are interesting, as many organizations are in a rush to move to the cloud when they already are running a private cloud. | 4.126 |
| Hypervisor Networking | Networking breaks down into high-level functions: ; Virtual machine networking ; Storage network ; Migration network ; Management network.......Network segmentation not required but highly recommended ; Segmentation can be physical or VLANs | 4.127 |
| Storage networking | is what allows a hypervisor to access shared disks. These disks are usually provided by a storage area network (SAN) or network-attached storage (NAS). These devices use either ISCSI, NFS, or SMB to allow a hypervisor to access disks. | 4.127 |
| management network and migration networks, Hypervisors | The management network is dedicated to remote access of a hypervisor and should be dedicated to administrators or centralized management servers. Migration networks consist of one or more networks dedicated to moving virtual machine traffic and memory between hypervisors as well as storage migrations.Designing a secure hypervisor must consider the proper segmentation of each of the above network components. | 4.127 | 
| Network Storage | One of the most critical networks to segment for hypervisors is the storage network. Having access to the storage network means having access to all data on all virtual machines. Even if the SAN or NAS supports whole disk encryption, the data is unlocked because the system is powered on and in use. Therefore, an adversary who gains access to a SAN or NAS has almost complete access and control over an organization's data. | 4.128 | 
| storage network | should be physically segmented. Physically segmented does not mean using VLANs across core switches. It means literally dedicated physical switches and even dedicated network ports for the hypervisors. The cost of adding the additional switches and ports is negligible in the grand scheme of things. Also, the process of upgrading a SAN or NAS can be done in an offline fashion without major overhead. | 4.128 |  
| Hypervisor Migration | Hypervisors are capable of migrating live virtual machines (VM) from one hypervisor to another.;     Includes memory and network connections; Changes registration for VM on completion;     Traffic is cleartext; Encrypted migration available in vSphere 6.5 and later1; Adds CPU overhead (approximately 1 core per 10 Gb traffic)Separate physical NICs ideal or dedicated VLAN | 4.129 |
| Virtual Switch Security | Common virtual switch security capabilities include:<br> **Reject MAC address changes**:  Rejects traffic from any MAC address not issued by hypervisor;  Required for virtual clusters or load balancing; <br> **Reject forged transmits** : Verifies source MAC to VM;  <br> **Traffic mirroring support**: Controls VM support of promiscuous mode or mirroringImplementation varies by hypervisor | 4.13O | 
| Reject MAC address changes |   Rejects traffic from any MAC address not issued by hypervisor;  Required for virtual clusters or load balancing; Virtual Switch Security, Implementation varies by hypervisor. MAC address changes monitor for MAC addresses in use that are not issued by the hypervisor. When set to disabled, the hypervisor will drop any MAC address not issued by itself  | 4.13O |
| Reject forged transmits |  Verifies source MAC to VM;  Virtual Switch Security, Implementation varies by hypervis; fororged transmits involve monitoring the source MAC address of a packet against the MAC address assigned to the virtual machine sending the traffic. If a match is not found, the packet is dropped  | 4.13O |
| Traffic mirroring support |  Controls VM support of promiscuous mode or mirroring Virtual Switch Security, Implementation varies by hypervisor  | 4.13O |
| Port mirroring, hypervisor switch | is set in one of two ways. Either traffic per VM is mirrored, or control of the capability to enter promiscuous mode can be configured. | 4.13O | 
| Virtual Network Visibility | A VM in promiscuous mode can see all host traffic.; Visibility limited to virtual switch; Should be disabled by default; Override for special VMs;  Such as virtual IDS/NSM systems, Same host VM traffic does notaccess physical switches | 4.131 | 
| VMware port group  VLAN 4095 |  means all VLANs in this implementation. Setting to promis. mode means a virtual IDS or NSM sensor can be deployed that can see all traffic to or from the same virtual switch. If a sensor needs to be able to capture traffic from other virtual switches, then the sensor would need another virtual NIC with the same port group set up per each virtual switch. | 4.131 |
| VM to VM Traffic| VM to VM traffic must leave virtual switch if: VMs are on different hosts; VMs are on different VLANs or across a gateway deviceMethods to see VM to VM traffic include:; Deploying sensors/network capture device to every host; Configuring policies to keep VMs on separate hosts; Implementing virtual switch port mirroring; Purchasing virtual tap software | 4.132 | 
| virtual switch port mirroring | Depending on the hypervisor and license in use, it may be possible to mirror virtual traffic to a physical NIC. If any of the above solutions are not sufficient or more granular traffic mirroring is needed, then consider purchasing a virtual tap solution. A virtual tap is a purpose-built traffic monitoring solution that works for virtual switches. | 4.132 | 
| Hypervisor Security | *Simplplest method of securing the hypervisor is proper segmentation.* Gaining admin access to a hypervisor grants full access.; Management network access needs to be protected.;  Use hypervisor firewall and authentication restrictions;  And network-based firewalls <br> Forms of hypervisor compromise:; **Weak passwords; Service exploitation; VM escape** | 4.133 | 
| VM Escape | Regardless of vendor claims, VM escape is real. <br> VMware (ESXi,Workstation/Fusion) = CVE-2022-317051 <br> Microsofts Hyper-v CVE-2021-284762<br> Xen 4.6 and earlier CVE-2017-89053Some exploits use RPC calls from guest tools.<br> Guest tools are not required.Some exploits attack flaws in virtual drivers or memory handling.<br> Fix is to establish a routine for continuous patching | 4.134 | 
| Hypervisor Physical Separation | Separate hypervisor deployments should be considered based on:; - Data sensitivity; - Compliance requirements; - Risk of VM compromise <br> Separation includes: - Different root passwords; - Different cluster membership; - Potentially different management server for high-risk shops | 4.135 | 
| TLS Offloading | Reverse proxy design often includes TLS offloading.Clients establish TLS connection to reverse proxy; Then reverse proxy establishes connection to server using HTTP; End-to-end encryption is supported.Proxy inspection has full access to every request and response.; Similar to TLS inspection on NGFW but with fewer politics | 4.16 |
| VMware lockdown mode | prevents root-level remote access.; Only allows vCenter to maintain root-level remote access....The same concept can be achieved with other platforms; Remote administration actions should come from management server; Exception is during network issues or troubleshootingConsole access always has full administrative rights;  Hypervisors usually have remote out-of-band management.L | 4.136 |
| Hypervisor Hardening | Standard system hardening should be followed: **SSH**: Limit access, implement lockdown mode <br> **SNMP**: Disable if not in use <br> **TLS**: Enforce newer versions of TLS <br> **Remote** logging : Send logs to remote logging solution <br> **Passwords**: Use strong passwords <br> **Certificates**: Replace self-signed certificatesMultiple hardening guides available online | 4.137 |
| Central Management Lockdown | Management platforms support multiple APIs and services. - Higher likelihood of exploitation - Lockdown services to service use <br> Segmentation with firewalls is necessary but difficult. - By design, more users access management servers. - User access needs to be strictly controlled. <br> TLS communication should not be self-signed. - Web services could benefit from WAF protection. | 4.138 | 
| Hyper-Converged Storage | New platforms create software disk clusters for high speeds. -  Disks are controlled by a VM -  Usually with SSH supportGaining access to one controller providesfull disk access. -  Solution- Limit SSH to only other controllers. | 4.139 | 
| hyper-converged solutions | include:Nutanix , Cisco HyperFlex , Red Hat OpenStack Platform (RHOSP) hyperconverged infrastructures (HCI) , Azure Stack HCI  | 4.139 |
| VM Interaction, Central Mang Plat | The below abilities need to be carefully limited:; Copy and paste - Possible use of data exfiltration; Clone - Allows creating offline copy of systems; DVD/USB  - Autorun attacks or mounting malware; Snapshots - Denial of service to storage space; View console - Gaining local administrator accessWhen in doubt, think evil; None of the above seem inherently evil | 4.14O |
| CVE-2010-25681 | VM interaction, this cve, which dealt with malware abusing .lnk files to run on Windows....attacks in the past that executed malware with autorun of media disabled,  At a minimum, allowing a virtual DVD to be mounted provides a read-only copy of malware that antivirus cannot remove. | 4.14O |
| Virtual Machine Tools | Installing guest virtual machine tools recommended by vendor; Provides virtualization optimized drivers<br> -Reduces memory consumption<br> -Improves disk and CPU performance<br> -Supports system quiescing for snapshots and backups<br> -Supports automatic restarts and clean shutdowns; Provides host to VM capabilities such as copy and paste<br> -Individual settings can be disabled on host or inside VMsAre risks of additional drivers and capabilities worth added risks? | 4.141 |
| Hypervisor-Based Endpoint Protection | Security vendors offer hypervisor integrated solutions. - Example: VMware Endpoint Security and third-party vendor <br> Endpoint security solution installed as virtual machine - Hooks into hypervisor and performs file, memory, and processscanning - Offloads performance from VMs (protects against AV storms) - No need for agents within virtual machines (except guest drivers)Capabilities fail in comparison to agent within VMs. - Ask the vendor which is more secure and verify with testing. | 4.142 | 
| scan storm, hypervisor enpoint protection | is an overload of CPU and disk usage due to antivirus and malware scans, use centralized hypervisor solution to prevent | 4.142 |
| VMware hypervisor mitigations | recommended: -Enable secure boot; -Enable VMkernel network adapters on the isolated management network only; -Decoupling ESXi and vCenter Servers from Active Directory and use vCenter Single Sign-On; -Enforce multi-factor authentication (MFA) for all management access to vCenter Server instances and store all administrative credentials in a Privileged Access Management (PAM) system; -Implement lockdown mode; -Implement centralized log management (via SIEM) | 4.143 |
| Docker | Docker uses the capabilities of the host OS kernel (Linux or Windows) to run an application in what is called a container. <br> Abstracts software to run on minimal operating system <br> Like a virtual machine but without all the overhead <br> Consumes less CPU, memory, and disk <br> Large deployments need basic scripting or orchestration tools.Docker1is one of the more common container solutions. <br> Common for microservice deployments <br> Works in private and public clouds | 4.147 |
| container engine | using one, such as Docker allows hooking into the Linux kernel to piggyback off the kernel to run binaries and libraries and thus ultimately a service. With containerization, binaries and libraries can be loaded within a controlled container process so that a service can run without the overhead of a full operating system | 4.148 |
| container on Windows | many different features were added to the operating system over the years and this all culminated in the Windows kernel being able to, essentially, run multiple instances of user-mode without the use of a hypervisor. As with Linux, the concept of a container does not exist inside of the Windows kernel as there is no singular object that you can refer to as the go-to container type. Windows containers are created by combining features from the Windows-equivalents to control groups and several different types of namespaces (process, network, time, etc.). | 4.148 |
| docker commands | docker pull, docker run, ect. | 4.149 | 
| Container Impact | **PROs**:  -Quickly add/remove nodes; -Uses less CPU, memory, andhard drive space; -Simplifies patchingBoth software and OS; -Can be more secure; -Isolation of applications <br> **CONs:** -Significantly more complex; -Requires staff training; -Security relies on OS kernel; -Requires Linux *; -Overkill for smalldeployments | 4.15O |
| Containers, Windows Server  | are isolatedenvironments that run on a Windows Server host. They share the host's kernel and resources, but they areisolated from each other and from the host operating system | 4.15O |
| FreeBSD jails, Containers | are isolated environments that run on a FreeBSD host. They share the host's kernel and resources, but they are isolated from each other and from the host operating system. | 4.15O |
| grsecuirity | a kernal hardening patch, may help prevent container escape | 4.151 |
| Container Escape/Privilege Escalation | Risk of privilege escalation is greater with containers; Container shares host kernel; Container lives in namespace(s) available on host; Possible to escape out of container into host...And further possible to escape one namespace to another | 4.151 |
| Container Escape Prevention | Run containers as standard Linux users. -u flag can force the container to run as a specific user. <br> Run services in containers as standard Linux users.<br> Example: *RUN useradd -ms /bin/bash service_account USER service_account* <br> REmove SUID and SGID use in container images. Simple adjustment to Dockerfile or image build: *RUN for i in `find / -perm +6000 -type f`; do chmod a-s $i; done* | 4.152 |
| CGroups | Containers can consume entire host resources; Makes them vulnerable to denial of service. **Possible to limit resources on a per container basis**:  <br> *docker run -m 512m --memory-swap 1g* <br> *docker run -m 512m --memory-swap 512m* <br> *docker run --cpus="1.5"* <br> *docker run --storage-opt size=100G* <br> *docker run --ulimit nofile=10000:10000* | 4.153 |
| Docker Hub | is free and allows community images. Images can contain malicious content, so trust is an issue.;  Use **Docker Content Trust** (defaults to on for Docker 1.9+): *export DOCKER_CONTENT_TRUST=1;* Only allows signed docker containers to run; Alternative to signing is using Automated Build images; | 4.154 |
| Container Secrets | Secrets, Passwords, encryption keys, and other sensitive data may be necessary for a container.; Containers often span multiple hosts.; Secure transmission and storage is necessary. Docker swarm, Docker compose, and Kubernetes support secrets.   Sensitive data is stored by management service; Data is encrypted during transit to container and at rest | 4.155 |
| Container Auditing and Logging | Containers are short-lived, making auditing more important. **docker diff** shows container changes from its image. <br> Log collection requires mounting folder to container...*docker run -v /logs/nginx1:/var/log/nginx/ nginx*. Syslog or collection agent on host can ship off logs....**docker commit** can make a snapshot for incident response. | 4.156 |
| Docker Diff | shows changes from image | 4.156 |
| docker commit | creates a snapshot of container, can be useful for IR | 4.156 | 
| Reverse Proxy | A reverse proxy handles incoming requests.; Then routes them to appropriate backend service; Clients are not aware of reverse proxyCan be either an on-premise solution or cloud solution; All major CSPs have cloud-based WAF solutions | 4.13 |
| Kon-Boot | is a hacking tool used by booting to a USB or CD.; System boots to Kon-Boot, which hooks BIOS; Then Kon-Boot modifies Windows kernel in memory.; Works on all versions of Windows from XP to Windows 11, and Mac OS; Now authentication verification is bypassed. Can log in to any local or domain cached account; Or can log in to local administrator; *All without modifying end system.* **Prevent with FDE or locking down BIOS** | 4.57 | 

