| slide title | description | Page |
| --- | --- | --- |
| NGFW, What they are | Next-generation firewalls (NGFWs) are deep-packet inspection firewalls that move beyond port/protocol inspection and blocking to add application-level inspection, intrusion prevention, and bringing intelligence from outside the firewall."; basically, a firewall+++   Confusing, as lots of built-in capabilities and features   Effective and affordable | 3.4 |
| NGFW Capabilities | Intrusion prevention; Deep packet inspection;  Dependent on TLS interception; Network-based antivirus; DDOS protection; Malware sandboxing; User-based rulesets; TLS/SSH inspection; URL filtering;  Use as a web proxy;  Data loss prevention;  Threat feed block lists;  DNS filtering and sinkholing;  Reporting capabilities;  Strong logging support;  Geolocation rulesets;  Scripting/SDK support | 3.5 | 
| URL filtering | analyzes HTTP specific fields to identify hostnames, MIME types, and other web-related data. Application control analyzes payload data to identify common patterns or use cases to identify which application is in use. | 3.6 | 
| Application control (NGWF) | analyzes payload data to identify common patterns or use cases to identify which application is in use. **application control signatures vary from vendor to vendor**; May require multiple characteristics to achieve high fidelity,| 3.6 - 8 | 
| NGFW Rulesets | Both a traditional and next-generation firewall's goal is only to allow authorized connections. Allowing only authorized connections on a traditional firewall is difficult. The difficulty of creating allow lists of authorized connections is significantly harder for a next-generation firewall because of all the granular control and added security services. Also, vendor implementation and administration of security services are different from one vendor to another.  | 3.1O | 
| NGFW Rule implementation | 1. Port Based (Outbound deny), 2. Quick wins: URL Category Filtering, Deny all outbound by user/subnet, Enable Antivirus, Easy App rules, Geos, DNS Sinkholing, 3. Longterm: IP/FQDN by  buisn need, authenticate all outbound by subnet/user, URL allow lists, App rules for everything | 3.11 |
| Rule Counters | rule counter increments each time a firewall rule has a match. Effectively, rule counters provide a simple reporting mechanism to identify if a rule triggers. | 3.12 | 
| TLS Interception | Encryption breaks deep packet inspection. - No application control - No antivirus - No intrusion prevention - Limited URL filtering; Many buy an expensive NGFW only to leave it blind. - **Chrome users spend 99% of their browsing time on HTTPS pages.** | 3.13 | 
| Google's Transparency Report | 99% of the browsing time on Chrome is spent on HTTPS pages.2Without TLS interception, a next-generation firewall is unable to perform deep packet inspection of web traffic that uses TLS encryption. | 3.13 |
| TLS certificate inspection | Better than nothing, it still leaves you blind to the packet payload when compared to TLS interception. Also, as we will see, newer versions of TLS wont allow us to see the X.509 certificate without breaking the encryption | 3.13 |
| NGWF Quick Wins | Network Antivirus; Users; Svc accounts/priv users; Subnets; Servers/ key workstations | 3.14 | 
| Network antivirus | can be added in detection mode.  Then flip to deny after cleaning up false positives. Consider detect-only before blocking mode | 3.14 | 
| NGWF Auth. Services (AD/LDAP) | Integration with authentication services such as Active Directory or LDAP. When integrating with authentication services, try to reduce the account privilege to the minimum possible. Vendors may request domain administrator rights to minimize the likelihood of installation errors, when all that might be needed is standard user access | 3.14 |
| SSH, NGWFo Considerations | SSH can be used to create encrypted tunnels, allowing users or malware to bypass; tunneling protocols through SSH=evasion; especially if NGFW doesnt decrypt/inspect SSH traffic. Allowing any outbound port unnecessarily increases the potential points of interaction (or attack surface) with external system | 3.15 | 
| Ports, NGWF | Allowing any outbound port unnecessarily increases the potential points of interaction (or attack surface) with external systems. Limiting outbound connections to only necessary ports based on business needs minimizes this exposure | 3.15 |
| OFAC countries | Sanctioned countries, Financial companies may need to block using Geo Blocking | 3.16 | 
| Sanctioned countries | Financial companies may need to block using Geo Blocking | 3.16 | 
| Geolocation Blocking, NGWF | If organization does not do business with organizations in foreign countries, then it may be a good idea to block all connections to or from a given country. By blocking foreign countries, the attack surface of organization shrinks; *NOTE: Consider CDNs, Cloud Hosting, Buis Partners may* | 3.16 | 
| External Dynamic Lists (EDLs) | aka - Dynamic Block Lists (DBLs) or simply Dynamic Lists, allow administrators to integrate dynamic threat intelligence feeds or other lists into their firewall policies; can be hosted externally and can be automatically and periodically fetched by the firewall to update InReal time | 3.17 | 
| Dynamic Block Lists (DBLs) aka - Ext. Dyn. Lists  | allow administrators to integrate dynamic threat intelligence feeds or other lists into their firewall policies; can be hosted externally and can be automatically and periodically fetched by the firewall to update InReal time | 3.17 |
| DNS filtering, NGWF |  is the process of using the Domain Name System (DNS) to block or allow domain name resolutions based on a predefined list or policy.  | 3.19 |
| DNS sinkholing, NGWF |  is a specific type of DNS filtering where requests to malicious domains are redirected to a "safe" or controlled IP address (often called a "`sinkhole") rather than being simply denied. especially useful for malware analysis and containment to catch C2 beacons | 3.19 |
| authentication rule (NGWF) | can prevent all internet access by default but generate an authentication pop-up when internet access is required. A system user simply authenticates and then internet access is authorized. Malware would be unaware of the pop-up or would likely be unaware of proper credentials to bypass this restriction. | 3.2O |
| Application/Port Rules, NGWF | Over time, firewall rules should include applications. Application control is especially important for outbound connections. A mature next-generation firewall only allows connections that are to authorized ports and applications | 3.21 | 
| allow listing ports/apps | is time-consuming and difficult. One way to build is use siem or scripting for reporitng and reporting on exceptions and tuning | 3.21 | 
| Inbound Rules (NGWF) | Lock down all inbound service requests. Including ports, apps, antivirus, and intrusion prevention; <br> - Intrusion prevention helps against untrusted sources.; <br> - Monitor for performance being impacted (backups).; <br> - Tune or disable security services as necessary.Apply to lock down one system or application group at a time; <br> - It is ***not an all or nothing change*** | 3.22 |
| Inbound Connections, NGWF | should occur only over specific ports and applications. Specifically, each inbound connection is to a service your organization has. Application control and port rules tend to be easy to implement.<br> - Network antivirus, intrusion prevention, and other services need consideration; can have dire performance consequences. | 3.22 |
| APIs and SSH (NGFW) | NGWFs support full automation. Scripting support means automatic firewall rule provisioning, automatic scripting response capabilities, and even help with troubleshooting firewall connections. | 3.23 |
| Scripting NGWF | NGWFs support full automation. Scripting support means automatic firewall rule provisioning, automatic scripting response capabilities, and even help with troubleshooting firewall connections.  | 3.23 |
| Automation, NGWF | is a key skill a defender needs in his or her tool belt. Some of the most secure operations automate small tasks that free up significant amounts of time. Some organizations even use the API or SSH support to provision new firewalls or migrate between vendors.| 3.23 |
| Infrastructure as Code (IaC) | a methodology used to manage, provision, and configure IT infrastructures through code instead of traditional manual processes. By using scripts, templates, or specific domain-specific languages, you can automate the deployment and management of servers, databases, networks, and other infrastructure components. | 3.24 | 
| Declarative Language | IaC approach; means defining the desired state of the system without detailing the steps to achieve it. Contrast to the imperative approach, where you provide specific commands to attain the desired outcome, the declarative approach simply states what the final state should look like, and the system itself figures out how to get there;  Makes code more readable and easier to maintain; consistent configuration;  | 3.24 | 
| Iac NGFW |  automate the deployment of instances, especially in cloud or virtualized environments. This ensures a consistent configuration across multiple instances or locations | 3.24 |
| firewall policies as code | ensures consistent application of security rules; Ensures consistent and reproducible update process. can also use version control systems like Git to provideclear history of changes, roll backs to previous configs, and collaborative management; can be integrated into a CI/CD pipeline for testing and deployment | 3.24 | 
| Terraform | Is Open Source, is platform agnostic, uses Declartive Language (HCL), uses simple syntax to provision infrasturcture, allows for management of infrastructure, platforms, and softoware on Days 1 and Days 2+N | 3.25 |
| mutable infrastructure | infrastructure can change to accommodate changes such as a middleware upgrade or new storage server, danger is config drift | 3.25 |
| configuration drift | as the changes pile up, the actual provisioning of different servers or other infrastructure elements drifts further from the original configuration, making bugs or performance issues difficult to diagnose and correct | 3.25 | 
| immutable infrastructure | with each change to the environment, the current configuration is replaced with a new one that accounts for the change, and the infrastructure is reprovisioned. Even better, previous configurations can be retained as versions to enable rollbacks if necessary or desired, ensures no config drift |  3.25-26 | 
| workload-centric micro-segmentation | Fundementally simplified NW measures that are performed at layers 3 and 4 (filtering based on IPs and ports), rather than functioning as full-fledged application-layer firewalls.  Used in cloud specific tools, AWS Sec Groups, Azure Network Sec Groups, or GCP FW regulations; <br> For adv. capabilities use svcs like AWS WAF, or Azure FW | 3.28 |
| Cloud NGFW (1) | Most organizations will use a hybrid architecture that uses both cloud-compatible and on-prem firewalls, along with cloud-native network controls (i.e., security groups)<br> -   Most NGFW vendors have virtual appliances available in thecloud provider marketplaces<br> -   Many cloud-native network security controls are simpler(equivalent to stateful inspection firewalls) and workload-oriented controls, that complement rather than replace a NGFW Layer 7 virtual appliance:<br> - AWS security groups<br> - Azure network security groups<br> - GCP firewall rules | 3.28 |
| Cloud L7 virtual appliances |- AWS security groups; - Azure network security groups; - GCP firewall rules; are workload oriented | 3.28 |
| Cloud NGWF mixed strategy | incorporating traditional on-site firewalls with cloud-integrated virtual devices and an assortment of cloud-native access controls. Provides a balance of flexibility and comprehensive protection. Main challenges lie in the added costs and the increased operational effort for setup and regular monitoring. For a vast majority, a blended strategy is both logical and advisable | 3.28 |
| Cloud NGWF Management | CSPs introduced centralized management tools simplify the management of these hybrid archs; <br> AWS support for Palo Alto in Firewall Manager tocentrally provision & manage your NGFWs across multiple accounts and Virtual Private Clouds (VPCs). This allows Palo Alto cloud NGFW for AWS to decrypt network packets, do deep packet inspection, and identify applications using signatures, protocol decoding, behavioral analysis, and heuristics. It also gives you the ability to implement fine-grained, application-centric security management that is more effective than simpler models that are based solely on ports, protocols, and IP addresses. | 3.28 |
| Palo Alto cloud NGFW | Central Management and provisioning in AWS; allows AWS to decrypt network packets, do deep packet inspection, and identify applications using signatures, protocol decoding, behavioral analysis, and heuristics. Can do fine-grained application-centric security management; more effective than simpler models that are based solely on ports, protocols, and IP addresses. | 3.28 |
| cloud-native security isolation/Access control| Tools like Network Security Groups or Security Groups, must be enabled judiciously;  Only Accommodate L3/4 controls; treat like stateful inspection/host based firewall rules | 3.3O | 
| Tufin | tool to ingest rules and policies, and track them as the number of rules grows. another option is  AlgoSec | 3.3O | 
| Cloud NGFWs | enable for all north-south traffic to and from the cloud subscriptions or accounts in all virtual private clouds (VPCs) or virtual networks. Services like Azure Firewall and AWS Network Firewall can also play a role in centralized network defense. | 3.3O | 
| AMIs Cloud NGFW | Include: Palo Alto Networks VM-Series; Cisco Adaptive Security Virtual Appliance (ASAv); Fortinet FortiGate; Check Point CloudGuard; Sophos XG Firewall; Barracuda CloudGen Firewall; SonicWall NSv; | 3.3O |
| Cloud NGFW  AMIs  | Include: Palo Alto Networks VM-Series; Cisco Adaptive Security Virtual Appliance (ASAv); Fortinet FortiGate; Check Point CloudGuard; Sophos XG Firewall; Barracuda CloudGen Firewall; SonicWall NSv; | 3.3O |
| Palo Alto Networks VM-Series | Palo Alto Networks offers a VM-Series NGFW that you can deploy as an AMI in AWS <br> - It provides advanced security features and integrates with the Palo Alto Networks ecosystem | 3.3O | 
| Cisco Adaptive Security Virtual Appliance (ASAv) | Cisco offers ASAv as an NGFW solution in a virtual appliance form <br> - It supports various security features and can be deployed as an AMI in AWS3 | 3.3O | 
| Fortinet FortiGate | Fortinet provides FortiGate virtual appliances that offer NGFW capabilities <br> - You can find FortiGate AMIs in the AWS Marketplace and choose the appropriate instance size based on your  | 3.3O | 
| Check Point CloudGuard | Check Point offers CloudGuard as a virtual NGFW solution that can be deployed in AWS <br> - It provides advanced threat prevention and centralized management | 3.3O | 
| Sophos XG Firewall | Sophos XG Firewall is available as an AMI in AWS <br> - It combines advanced security features, including web filtering, IPS, application control, and more | 3.3O | 
| Barracuda CloudGen Firewall | Barracuda Networks offers the CloudGen Firewall as a virtual appliance that provides NGFW capabilities <br> - You can find Barracuda CloudGen Firewall AMIs in the AWS Marketplace | 3.3O | 
| SonicWall NSv | SonicWall offers the NSv series as virtual NGFW appliances that can be deployed in AWS <br> - They provide features such as threat prevention, TLS inspection, and VPN connectivity | 3.3O | 
| WatchGuard Firebox Cloud | is a virtual NGFW solution that can be deployed in AWS;  It offers advanced security services, including web filtering, network discovery, and application control | 3.3O | 
| AWS Network Firewall | AWS itself provides Network Firewall as a managed firewall service. Although its not an NGFW from a specific vendor, it offers essential firewall capabilities and integrates well with other AWS services. | 3.3O | 
| Juniper Networks vSRX | Juniper Networks offers vSRX as a virtual NGFW solution that can be deployed in AWS. It provides advanced security features, including intrusion prevention, application visibility, and unified threat management. | 3.3O | 
| NGFW Review | Application-layer controls greatly increase security.; Defines what traffic is truly expected inbound/outbound; Provides both prevention and detectionHeavy emphasis placed on outbound rules; Balance number of rules with the quality of rules; Remember, Layer 7 controls take more resources.Use a hybrid architecture that uses both cloud-compatible and on-prem firewalls, along with cloud-native network controls (i.e., security groups) | 3.32 | 
| Network security monitoring | deals with data in motion and is more than intrusion detection. Network monitoring is now an evolution of network security monitoring, or NSM. NSM comprises related capabilities to provide a complete picture; gives context around alerts;  By Switching evil mentatility into context enrichment and data gather, NW Sec monitoring provides complete tool set | 3.34 | 
| evil mentality, NSM | Dont think like this, but switch to context enrichment and data gathering mentatlity when using NSM, will ensure network security monitoring provides a complete tool set. NSM helps organizations learn more about their environments while providing capabilities to look for alerts and anomalies. | 3.3O | 
| NSM solutions  |  not alert centric but data centric | 3.35 |
| Snort | traditional signature based IDS | 3.35 | 
| Alert Driven Workflows | Tunnel Vision, No Context; Most security operations teams live in an alert driven world; Alerts provide only the initial point for an investigation, but often additional context is needed to determine what to do next. | 3.35 |
| Data-Driven Workflows | Most NSM are data driven - provides additional data needed to *pull a thread* (go, hunt, explore) vs reactively waiting for an alert. Hypothisis and Questions | 3.35 | 
| pull a thread |go, hunt, explore, vs reactively waiting for an alert. Hypothisis and Questions | 3.35 |
| Anton Chuvakin | said Network security monitoring still matters because you can monitor unmanaged devices (BYOD, IoT, ICS, etc.), detect threats with no agents, offer broad coverage from a few points, and be out of band | 3.35 |
| port mirroring/network tap | required for implementing Out of Band NSM; Doesn't affect prod.  | 3.36  |
| Out-of-Band NSM | 1 of 2 options for NSM Monitoring (IDS); Entire purpose is detection; Requires network tap or port mirror; Does not affect production; | 3.36 | 
| Inline NSM | 1 of 2 options for NSM Montiring (IDS/IPS); Purpose is detection and prevention; Traffic must go through IPS; Can affect production traffic; a poten. point of failure, usually has fewer rules enabled | 3.36 | 
| Switch SPAN/Mirror Ports | Managed switches typically offer mirror ports; allows frames to be forwarded from one or more switch ports to another; Cisco calls these SPAN (Switched Port Analyzer) ports. | 3.37 |
| Mirror ports | offer organizations a simple way to sniff traffic, typically using existing equipment. | 3.37 |
| Network taps | are a better all-around solutions, but mirror ports are reasonable for smaller environments; They also do not introduce another point of failure (as network taps can), which is a benefit. | 3.37 |
| Switch mirror ports | can sanitize traffic, dropping malformed frames (which may be used in Layer 2 attacks; This sanitization can blind IDSes to these attacks. | 3.37 | 
| netstat -s | or netstat -statistics' ('-s' does the same) will show dropped packets:$ netstat -s | 3.38 | 
| Network taps | Network taps offer a more robust network sniffing option  -Taps will send all frames to the monitoring port(s), including malformed frames.<br> -Higher-end taps offer tap buffers, which can cache traffic that bursts above the interface bandwidth threshold.<br> -Taps can present an additional point of failure, which should be considered; Some taps are designed to fail open in the case of a power outage: they will continue to pass traffic, but not send traffic to the monitoring interface(s).o  Higher-end taps have two power supplies, which should be connected to separate electrical circuits. | 3.39 |
| fail open, nw tap |  option that in event of fail condition, will continue to pass traffic, but not send traffic to the monitoring interface(s).o  Higher-end taps have two power supplies, which should be connected to separate electrical circuits. | 3.39 |
| Aggregation Taps, NW Tap | combines both duplexes and send to one monitoring port;  Lower-end taps send each duplex to a separate monitoring port.; Multi-aggregation taps (shown on theright) send both duplexes to multiplemonitoring ports.; Allows sending traffic to separate IDSes, oran IDS and a full packet capture device, forexample | 3.4O | 
| External-facing sensor | could be helpful for research and for reporting how often an organizations external IPs are attacked. But most often the volume of alerts and noise generated by this activity is not worth the effort of managing such a sensor | 3.41 | 
| Sensor Placement | Network monitoring is dependent on the location of network sensors. Value of the data and alerts that a sensor generates requires proper placement. <br> Network sensor between the internet and edge firewall provides visibility into external attacks as well as outbound traffic from an internal system. *Downsides*: external attacks will happen/not practical to investigate; the internal traffic would be visible but not with internal IP addresses, external IP of the edge firewall would show due to NAT. Could be useful for intel, but very noisy / high volume makes it gen. inpractical. <br> Configure each subnet that is visible to have Internal Outbound Monitoring, can ID C2, Malware activity, phishing, ect; <br> Intenral Monitoring is important, but often overlooked, can ID anaomalies and pivoting activity <br> . If the segmentation was done correctly, and the systems in each zone share similar attributes (OS, purpose, etc.), we will be able to tune those NSM sensors accordingly and avoid high false positives (FPs) and high false negatives (FNs)| 3.41 |  
| Outbound Monitoring, NSM | is key, can ID C2, Malware activity, phishing, ect, for all subnets;  | 3.41 | 
| Internal monitoring vs Outbound | is also important but usually overlooked. Internal monitoring requires sensor customization and tuning to pull off but can identify anomalies and pivoting activity. | 3.41 |
| Security Onion | Linux distro by Security Onion Solutions, LLC; Full-fledged open-source network security monitor; With enterprise central management of sensors; Easily handles hundreds of NSM sensorsContains Zeek, Snort3/Suricata, full PCAP storage, and many other features and tools ( Go John and Brian, 255S Power! ) | 3.42 | 
| packet captures | have immense forensic value, and packet captures also provide tremendous value in investigating alerts. Assuming that we are intercepting TLS and were able to see the decrypted traffic, of course. Alerts are often non-descript and provide nominal information. Having additional information such as packet capture helps disprove or approve investigative theories. Problems: can be intesive to evaluate full; can be extreemly large for | 3.43 | 
| Zeek / BrO | Offered by Corelight, it is Both an IDS and NSM; creates logs based on observability; visibility beyond traditional sig-based detection, protocol decoding; requires sensor placement and traffic vis; <br>  IDS++: a **Network Programming Language**;  <br> Provides full context of all activity related to network events. Provides a flexible framework that facilitates customized, in-depth monitoring beyond traditional IDS. <br> capabilities allow for data-driven workflows based on event-driven traffic analysis. Instead of focusing on providing alerts for anomalous or malicious traffic, it logs events and records of summarized **connections**<br>Effectively, Zeek is a network metadata logging utility. Zeek log stays consistent and works even when HTTP services are upgraded or changed for new services. Switching Squid to BlueCoat,still have all the logs via Zeek. <br> Zeek data is one of the number one data sources if not the number one for network monitoring and alerting. <br>- zeek adds visibility to the network layer in the same fashion that Sysmon1 adds visibility to the endpoint | 3.45-48 | 
| Network Metadata | studying this data and then using scripts or a SIEM to put rules around this allows for manual or automated alerting. Example: looking at all the new domains observed by an organization is likely to include domains used for phishing or drive-by malware <br> metadata can be consumed by detection or analytics products to build supervised or unsupervised models, statistics, rules, etc.; - Or by SIEM devices to produce signals. These can be at the same time enriched and correlated with IDS alerts coming from signature-based engines like Suricata, as well as consumed by other solutions that automate or orchestrate certain responses, speeding up investigations and incident response workflows | 3.47 | 
| dhcp.log | can be analyzed for hostnames that do not match the organizations naming standard or MAC address list of company devices. Other logs such as software.log can be used to find vulnerable operating systems or applications through passive identification. tools like freq.py, freq_server.py, domain_stats.py, ect can help | 3.47 |
| Conn logs | zeek logs can be crawled back in time to look for connections that reoccur on frequent intervals in the same way that command and control activity does. DNS logs can be inspected for new domain requests or randomly named domains or cousin domains, or anomalous DNS requests based on duration and volume, request and answer size, DNS request type, and unique queries per domain. | 3.47 |
| Decentralized via Script | NW Logs; Automation via scripts is low budget; Allows data manipulation; Custom alerting and actionsScripts can do:; Before-and-after comparisons; Newly observed domains 1; Apply data science; Discover C2 beaconing; scripting does not scale as well as other solutions.| 3.49 |
| Scripting NW Log Operations |  Automation via scripts is low budget; Allows data manipulation; Custom alerting and actionsScripts can do:; Before-and-after comparisons; Newly observed domains 1; Apply data science; Discover C2 beaconing; scripting does not scale as well as other solutions.| 3.49 |
| SEIM, Cenralized NW Log Ops | SIEM requires up-front labor and money investment,; Built for data manipulation; Built for automated alerting; Data science hooks built in; Correlate with disparate dataCapabilities similar to scripting; But purpose-built for analysis | 3.49 |
| Johannes Ullrich Bash Script | crawls across Security Onion sensors to find new domains that were accessed in the last 24 hours. | 3.49 | 
| RITA | Real Intelligence Threat Analytics consume Zeek data to find command and control beaconing. Since scripts are used, almost anything can be done. H | 3.49 | 
| Berkeley Lab Cyber Security Team | brought their 100G-capable network monitoring system online in January 2015. They created a technical document to help other security teams, architects, engineers, and Zeek enthusiasts learn about the components and configuration that they used to create this monitoring system. | 3.51  |
| frontend flow distributor | could be hardware (i.e., cFlow or cVu device from cPacket) or software based (like PF_RING or AF_PACKETS) | 3.52 |
| Zeek Cluster Components | The componets are the ***Worker*, Manager, and the Proxy*** <br>- **Workers**: do heavy lifting by sniffing traffic, reassembling it into strings, and protocol analysis; Equivalent to a sensor in a traditional IDS. Spec out fastest memory and CPU core speed due to parse ops. Storage isn't a concern; very little is written to disk. <br> - **Manager**: entral log and notice collector, creating a single log for all the traffic collected by the workers, de-duplicating notices and acting as a chokepoint. <br> - **Proxy**: a Zeek process that manages the synchronized state. Variables can be synchronized across connected Zeek processes automatically. Help workers by alleviating need for all tje workers to connect directly to each other. | 3.52 | 
| Standalone deployment, Zeek | a worker, manager, and proxy are set up on the same host. | 3.52 |
| Cluster, Zeek | a worker or a number of workers can be set up in separate hosts depending on the traffic volume and the type of hardware available for network collection. A rule of thumb commonly followed is to ***allocate approximately 1 core for every 250 Mbps of traffic that is being analyzed.*** The frontend flow distributor allows this model to scale. <br> Example:  if your traffic peaks around 2 Gbps (combined) and you want to handle traffic at peak load, you may want to have 8 cores available (2048/250 = 8.2) | 3.52 |
| Zeek Architecture | Zeek is not multithreaded, but its possible to scale by spreading the workload across many hosts using a cluster (worker + manager + proxy). <br> Allocate approximately 1 core for every 250 Mbps of traffic that is being analyzed.| 3.52 |
| Zeek Event Engine | (or core) reduces the incoming packet stream into a series of higher-level events; events reflect network activity in policy-neutral terms, they describe ***what has been seen***, but **not** *why*, *or if significant*;  Event Engine does not Preform ***Interpretation***, that is done by other component, Script Interpreter | 3.54 |
| Zeek Script Interpreter |  executes a set of ***event handlers*** via custom scripting language, they caan express a sites security policy, ***what actions to take*** when the monitor detects different types of activites.  Can derive any desired properties and statistics from the input traffic | 3.54 | 
| Zeek Programming Language | Used by the Script interpreter, comes with extensive domain-specific types and support functionality; <br> **Script Interpreter** Allows scripts to maintain state over time, enabling them to track and correlate the evolution of what they observe across connection and host boundaries. <br> Bro scripts can generate real-time alerts and execute arbitrary external programs on demand, for example, to trigger an active response to an attack. | 3.54 |
| libpcap, zeek usage | used to sniff and filter packets in zeek, AF_PACKET and PF_RING can be used to improve perf. of the sniffing process acting as a host load balancing, directing traffic streams to different cores where there are multiple Zeek workers sharing the same host | 3.54 |
| AF_PACKET and PF_RING |  mechanisms to access raw packets from the Linux network stack. AF_PACKET is integrated into the Linux kernel, meaning there's no need to install additional software or maintain custom kernel modules, which is one of the reasons why its often preferred as it can be easier to maintain and from a compatibility perspective; Used by Zeek and Security Onion (which also uses zeek..) | 3.54 | 
| Zeek -C | event engine will discard packets that dont have valid checksums. Locally generated/captured traffic on a system that offloads checksumming to the network adapter haven't had checksums evaluated yet by the NIC, Need to use -C to ensure they arent discarded | 3.55 |
| Zeek CLI | Live or offline traffic analysis can be done from the command line by using the Bro binary: <br> ***zeek -i <network interface> <list of scripts to load>***  <br> ***zeek -r <pcap file> <list of scripts to load>*** <br> Example ***zeek -r /labs/3.2/capture.pcap /labs/3.2/analysis.bro *** <br> -C tells Zeek to ignore bad checksums (see notes) | 3.55 | 
| Zeek -C | event engine will discard packets that dont have valid checksums. Locally generated/captured traffic on a system that offloads checksumming to the network adapter haven't had checksums evaluated yet by the NIC, Need to use -C to ensure they arent discarded | 3.55 |
| Zeek scripting language | is inherently event-driven: Instead of writing scripts that sequentially process data, custom scripts written to react to events. Zeek scripting comes with a vast library of built-in functions tailored for network analysis. - Includes functions to handle common tasks; managing data structures, string operations, ect. Can be integrated with other tools/platforms; Can be fed to ElasticSrch; Kafka, ec to enrich data; | 3.56 |
| detonation API script integration | try to build out so that files are only submitted if they have not been analyzed. <br> Prior to sending a file, query the API to see if the hash of the file has been previously analyzed; is a Yes or No, send if not seen <br> Only transferring the file if it is a new file keeps internal bandwidth optimized and helps to lower resource consumption of the detonation device. | 3.57 |
| Zeek File Extraction/Detonation Sandboxes | capable of doing automatic file extraction.; As files cross the network, Zeek carves them out.<br> File extraction and sandbox API submission = ***Full Automation***; Network sensors data gets a major boost.Detonation devices keep a record of each analysis.; Helps prevent repeat analysis and wasted resources; Tracking is done by keeping the hash of files and name of URLs. |3.57 |
| Kubernetes with Zeek |  Kubernetes environments can be monitored with Zeek using a sidecar per monitored container. Once the traffic is mirrored, it may be analyzed at the sidecar (per container) itself or sent securely to a pod (on the same host) or to a central destination (different host) for analysis. A monitoring sidecar-container can have as little as *0.25 vCPUs and 256MB RAM* | 2.58 |
| GameOverZeus | is known for implementing P2P and domain generation algorithm (DGA) communications to determine the current Command and Control (C&C) domain. When these bots cant communicate with its botnet via P2P, DGA is used. The domain names generated by GameOver Zeus consist of a string with a length of 32 to 48 chars and one of the following TLDs: ru, com, biz, net, or org. The list contains over 1,000 domains and changes every 7 days, based on the current date. | 3.59 | 
| Bro_cut | extracts specific columns from the ASCII-based logs produced by Zeek on standard input. | 3.6O |
| Zeek/Bro C2 Command Discovery Example  |  cat dns.log \| bro-cut query \| sort -u \| cut -d . -f1 > domains-withoutTLD '\$\(for i in `cat domains-withoutTLD`); do echo "${#i}"; done \| sort -u | 3.59 | 
| Bro_cut Example  |  cat dns.log \| bro-cut query \| sort -u \| cut -d . -f1 > domains-withoutTLD $(for i in `cat domains-withoutTLD`); do echo "${#i}"; done \| sort -u | 3.59 |  
| X.509 certificate fields ttps | fiels like server_name, subject, and issuer_subject filled with random strings which is a common tactic employed by malware authors to evade signature detection. | 3.6O |
| JA3 and JA3S |  JA3 and JA3S are TLS fingerprinting methods. **JA3** fingerprints the way that a client application communicates over TLS.**JA3S** fingerprints the server response. <br> Combined, they essentially create a fingerprint of the cryptographic negotiation between client and server. TLS certificate values are often created or changed by malicious actors, usually with *self-signed* certificates that will have unique JA3 fingerprint values. By bringing those values into a SIEM or other analysis tools, you can hunt for unusual JA3 fingerprints or even match them against a threat list of known bad JA3 fingerprints | 3.61 | 
| Zeek JA3 and JA3S, Use Case |  JA3 and JA3S are TLS fingerprinting methods. ;   JA3 fingerprints the way that a client application communicates over TLS ;   JA3S fingerprints the server response;  Malicious self-signed certificates often have unique JA3 fingerprints.;  The way some C2 servers respond is unique too.;  These can be matched against known bad fingerprints. <br> **JA3 Zeek script** takes fields and concatenates them with fields separated by a comma and values within the field, separated by a hyphen. That string is hashed with md5, which results in the JA3 SSL client fingerprint. The results are output to the bro_ssl log file| 3.61 | 
| Suricata, JA3 Use case |  Suricata can also make good use of network metadata (in this caseJA3 hashes) even with a portless signature.; Detects Dridex1SSL Client Hello on a nonconventional TLS port | 3.62 |
| Zeek Analysis Toolkit, ZAT  | can be used to extract data formats that can be read by ML packages from raw Zeek log files. | 3.63 |
| Beaconing Detection | Search for signs of beaconing behavior in and out of your network.| 3.63 |
| DNS Tunneling Detection | Search for signs of DNS based covert channels.| 3.63 |
| Block List Checking |  Query block lists to search for suspicious domains and hosts. | 3.63 |
| Beaconing Detection with ML | Real Intelligence Threat Analytics, RITA from Active Countermeasures, can also ingest Zeek logs to detect beaconing, DNS tunnels, and query block lists. ; With the Python libraryZeek Analysis Toolkit (ZAT), you can extract data formats that can be read by ML packages from raw Zeek log files. | 3.63 | 
| VPCs, Leveraging NSM | allows organizations to understand the patterns of data flows, which is essential in detecting unusual patterns indicating potential breaches or data exfiltration attempts. Without visibility into east-west traffic inside VPCs, organizations have blind spots that can be exploited by attackers, especially in multi-tier applications where different components talk to each other. | 3.65 |
| EDR/XDR In Cloud | Many CSPs do not support traditional Endpoint Detection and Response (EDR) or Extended Detection and Response (XDR) solutions, use NSM in those scenerios | 3.65 | 
| Cloud Network Caps/Monitoring |  EDR/XDR tools may not be available; Many VPCs have flat networks. NSM will provide visibility on them; Cloud API logs arent often designed for security monitoring ; MITRE ATT&CK Cloud Matrix coverage; Traffic mirroring must be set up | 3.65 | 
| east-west traffic inside VPCs | without vis organizations have blind spots that can be exploited by attackers, especially in multi-tier applications where different components talk to each other | 3.65 | 
| Network Intrusion Detection | NIDS is primarily a "find evil"device.<br>Three main methods of detection;1. Signature-based; - Identify known bad patterns andcharacteristics.2. Anomaly-based; - Identify changes from baseline activity.3. Protocol analysis ; - Identify non-protocol/RFC specificbehaviors.<br>Signature and protocol analysis have fewer false positives. | 3.7O | 
| Anomaly detection |  in an IDS is usually in the form of protocols not conforming to common behaviors or RFC requirements. Can also be from automatic baselining or statistical calculations, but historically ***automatic baselining*** has not been mature. Instead, the **core of NIDS is signature-based rules**. | 3.7O | 
| NIDS Rules | Specifically look for network connections and specific Layer 7 payload information. If a match is found, a NIDS reacts. Most of the time an alert is generated, but a NIDS can also block traffic or kick off short-term packet captures to gather additional information | 3.7O |
| Signature-Based Detection | NIDS comes prepackaged with many signatures. These signatures fall within specific functional categories. For example, POLICY specifies a signature is identifying a potential corporate policy violation such as Dropbox use. *Some signatures may cause a lot of false positives*. *Other signatures may be high fidelity and highly actionable* | 3.71 | 
| C2 or INDICATOR-COMPROMISE signatures | call out that a system is most likely compromised and either phoning home to a command and control server or showing signs of post-compromise activity. | 3.71 | 
| Snort | the most common IDS.; Many commercial solutions use it.; Rule and rule format works on almost every IDS solution.; Contains built-in protocol analysis <br> Example signature rule:*alert ip any any -> any any (msg:"INDICATOR-COMPROMISE id check returned root"; content:"uid=0\|28\|root\|29\|"; metadata:ruleset community; classtype:bad-unknown; sid:498; rev:11;)* | 3.72 |
| Snort rule format | is accepted by most major IDS solutions, or there are converter utilities to translate from Snort syntax to commercial solution. Many next-generation firewalls have such converter utilities because their intrusion prevention engines are similar enough to Snort that rules can be converted to or from a specific implementation. | 3.72 | 
| Snort Rule Header | The Snort rule header has seven part, **Actions** (alert/log,pass), **Protocols**: ip/icmp/tcp/udp, **SourceIP**, **Source Port**, **Direction**: (CLient to server -> or  <> ),**Destination IP**, and **Destination Port** | 3.73 | 
| EXTERNAL_NET, Snort Var |  defaults to !$HOME_NET, or non-RFC1918 private IP addresses. Since many Snort rules use the variable $EXTERNAL_NET, it may be worth changing EXTERNAL_NET to *any*. By setting EXTERNAL_NET to *any*, rules will monitor and alert on actions from internal devices to other internal devices. Using *any* requires more work maintaining rules but provides significantly more security. | 3.74 | 
| Snort Variables | Need Tuned usually.   They are declared w/ ipvar and portvar.<br> *ipvar HOME_NET \[192.168.0.0/16,10.0.0.0/8,172.16.0.0/12]<br>ipvar EXTERNAL_NET !$HOME_NETportvar HTTP_PORTS \[80,8080]*<br> Most common IP variables are *HOME_NET* and *EXTERNAL_NET*; *EXTERNAL_NET* is commonly set to non-RFC1918 addresses; Doing so makes most rules miss internal -> internal traffic.; Alternative is to set *EXTERNAL_NET* to any <br> Default to *HOME_NET* is typically private IP/RFC1918. <br> Variables like HTTP_SERVERS default to $HOME_NET. This leads to false positives. For example, a workstation could accidentally trigger a web server-related rule even though it is not a web server. | 3.74 | 
| Snort Rule Options | Well written includes msg field, classtype, and metadata about rule;   Rule options are within the parentheses. ***msg*** Specifies an alert message; ***content*** Finds patterns in the payload of the packet (Layer 7); ***metadata*** Additional information about the alert; ***classtype*** Categorization for the alert ; ***sid*** Unique identifier per rule (must be unique) all rules require | 3.75 |
| Snort gid | The gid number specifies what generates an event. **1** - General rule system, default if no gid is specified.<br> **100**+ Preprocessors and decoders; special capabilities built into Snort that are rarely modified by an organization<br> **116** - Snort decoder<br> **119** - HTTP Inspect preprocessor (Client)<br> **123** - Frag3 preprocessor<br> **129** - Stream preprocessorgid | 3.76 | 
| Suricata | is a modern next-gen open-source IDS/NSM.; Developed by Open Information Security Foundation; Supports Snort rules and application identification; Generates alerts and network metadata logs; Version 7, released on July 2023, adds support for QUIC and HTTP/2 <br> **Example:*** alert tcpany any ->any !22 (msg:"SURICATA SSH non-standard port"; flow:to_server; app-layer-protocol:ssh; sid:5300001; rev:1;)* |  3.77 | 
| Suricata Application identification | this alone is worth the jump from Snort; Snort does not support application layer identification.. Suricata looks at L7s with ease by using the **app-layer-protocol** rule option. On top of that, network metadata logging is a huge boon to security. | 3.77 |
| app-layer-protocol, suricata | rule option that Suricata Application identification uses to do L7 |  3.77 |
| Metadata Logging, Suricata | creates network logs.; DNS; Bidirectional flow data; HTTP; SMTP; TLS and more Means you have IDS alerts plus, context | 3.78 |
| Suricata Metadata Logging, | creates network logs.; DNS; Bidirectional flow data; HTTP; SMTP; TLS and more Means you have IDS alerts plus, context | 3.78 |
| IDS vs NSM | level of context is a huge differentiator between an IDS and an NSM sensor. An IDS generates alerts. An NSM sensor generates alerts, network logs, and more | 3.78 | 
| NIDS Rule Tuning | Leaving all the default rulesets enabled generates a ton of false positives and can also cause performance bottlenecks that crash the system. Eliminating rules is a balancing act. Too many rules and false positives increase alert fatigue and affect the systems performance. Too few rules and alerts will increase the number of false negatives, increasing the chances of missing real attacks <br> **Rule of Thumb**:disable enough rules so that performance is acceptable and your analysts that are reviewing alerts can keep up with all alerts generated within a 24-hour time period. If more alerts are generated than can be investigated in a 24-hour period, then the rules likely are not tuned. pull a thread* (go, hunt, explore) vs reactively waiting for an alert. Hypothisis and Questions | 3.35 |<br> Also can have multiple sets with converage difference | 3.79 | 
| Pulledpork | ulledpork is a script that automates the download of new signatures and what to do with them, as well as existing signatures. It uses a combination of unique signature IDs, or SIDs, and regex to disable, change, or enable rules. | 3.8O |
| enablesid.conf, PulledPork Conf file | Forces a rule to be enabled | 3.8O |
| dropsid.conf, PulledPork Conf file | Sets rules to drop (used in IPS mode) | 3.8O |
| disablesid.conf, PulledPork Conf file | Disables rules on sensor1:2012648 <br> # ET POLICY Dropbox Client Broadcastingpcre:ET\ GAMES <br> # Disable all ET GAMES rules; Enable, drop, and disable share syntax (gid:sid or pcre) | 3.8O |
| modifysid.conf, PulledPork Conf file | Modifies rulesets with find/replace2012648 "\$HOME_NET" "!10.5.30.5" # ignore 10.5.30.5 | 3.8O | 
| thresholds.conf | Rules with flowbits cannot be disabled by disablesid.conf. <br> Instead, thresholds.conf needs to suppress the rule. <br> **Example:** *suppress gen_id 1, sig_id 2019401* <br> Rules with flowbits are linked together to check the state of flow. | 3.81 |
| ET.http.javaclient.vulnerable | example flowbit in alert | 3.81 | 
| flowint | similiar to flowbits, it allows storage and mathematical operations using variables. It operates much like flowbits but with the addition of mathematical capabilities and the fact that an integer can be stored and manipulated, not just a flag set. We can use this for a number of very useful things, such as counting occurrences, adding or subtracting occurrences, or doing thresholding within a stream in relation to multiple factors. | 3.81 | 
| IDS Default Config | Lots of False positive, needs tuning | 3.83 | 
| APP-DETECT VNC | exapmple rule: server response Alert defaults to low priority; However, ***If VNC is not used, this should be a high priority, as it could indicate the adversary is using it to pivot (MITRE T1021.005***) | 3.83 | 
| remote administration tools abuse | RATs, such as VNC, AnyDesk, and TeamViewer, which are used for normal purposes2, to take control of infected systems. A sudden detection of these tools when theyre not common in our organization should be a highly valuable detection. | 3.83 |
| modifysid.conf | can be used to dynamically change the priority on rules based on regex match or SID numbers. The problem is more so of going through all the rules. A default system may have upward of sixty thousand rules. Rule priority updates may be more feasible by updating alerts that are received that have an incorrect priority.| 3.83 |
| Whitecap Rules | A NIDS signature is primarily a block listing mechanism. However, because actions like pass exist, rules are able to be written in an allow list fashion. For example, Eric Conrad came up with the concept of using Snort rules to allow list ICMP traffic and then Justin Henderson worked with him to apply the technique in production environments. These rules are called Whitecap rules. | 3.84 |
| Whitecap example| ICMP Example; Ignores expected, alerts on everything else; see slide | 3.84 |
| internal pivoting | Involves desktop -> desktop or desktop -> server traffic; Hard to detect without visibility <br> Network sensor must be positioned to see pivoting | 3.86 | 
| Alert classification| classify alerts after an investigation. helps identify how many attacks are occurring and what they are. Classification also helps identify bad rules that need to be cleaned up. | 3.86 |
| Kibana, SIEM Integration:  |  network logs with a SIEM allows for simpler workflow orchestration. At its simplest, a SIEM provides a central location for storing and searching log data. By having the data centrally collected and searchable, an analyst gains efficiency by being able to search across disparate data sources that are related. Also  provides the ability to pivot from key data to external systems. By having dashboards and third-party products integrated through a SIEM, analysis becomes less frustrating and less time-consuming. | 3.87 |
| Virtual Private Network (VPN) | Most organizations have VPNs today **Benefits:*** - VPNs are flexible for traditional remote work usage* - A VPN "tunnel" over the internet can be set up rapidly* - IPsec VPNs are most common in site-to-site VPNs while TLS VPNs are most used by mobile users due to its ability to traverse firewalls and NAT.* - Requires on-premises termination platforms (encryption is not end to end), configuration of clients and/or connectivity optionsV | 3.95 | 
| remote access for mobile users |  TLS VPNs are preferred over IPsec VPNs because they can bypass most firewalls and NAT-enabled devices in the routing path. | 3.95 | 
| TLS VPN | Modern VPNs use TLS  Supports strong encryption such as AES256; Fast performance due to SSL/TLS use; Supports UDP or TCP (UDP may get blocked); Authentication support for user/pass/certificate ; Requires client or browser integrationTLS VPN usually supports post-authentication checks.; Such as antivirus and firewall verification; Similar to many commercial VPN solutions | 3.96 |
| OpenVPN | is a trending VPN solution for both commercial and open-source implementations. OpenVPN tunnels traffic over TLS but also uses capabilities in the OpenSSL library to maximum resiliency and performance. A standard OpenVPN configuration will attempt to use UDP first, and then if UDP is blocked, will fall back to TCP port 443. By utilizing UDP, OpenVPN optimizes the user experience and performance. <br> main downside to OpenVPN is that it requires the installation of an OpenVPN client. The solution supports strong authentication, strong encryption, and advanced capabilities such as post-authentication checks | 3.96 | 
| WireGuard | is a relatively new open-source VPN protocol that aims to offer a simpler and more efficient solution than some of the older protocols. Some of those protocols include the Noise protocol framework, Curve25519, ChaCha20, Poly1305, BLAKE2, SipHash24, HKDF, and secure trusted constructions. It makes conservative and reasonable choices and has been reviewed by cryptographers. It was designed to be easy to deploy, fast, and secure with modern cryptography standards. WireGuard operates at the kernel level, which means it runs more directly within the operating system and can offer better performance. | 3.96 | 
| Split-tunnel, VPN | Only specific subnets are routed over VPN.; Allows local traffic; Lowers bandwidth consumption; Increases the likelihood of external infection | 3.97 |
| Full-tunnel, VPN | All traffic must traverse VPN;Higher bandwidth consumption (central point of internet traffic);All traffic funnels through centralized security solutions.;Acts as if the system is plugged into the corporate network;Cannot access local resources such as IP printers | 3.97 | 
| Microsoft Always On | addition to Windows 10 Anniversary update or later,  supports split tunneling or full tunneling automatically using user-based or device-based certificates | 3.98 |
| user initiated tunnel | VPN tunnel is started after user authentication (instead of computer startup), passwords or certificates don't need to be stored locally on the computer. | 3.98 |
| Post-Authentication Checks, VPN Client | Is similiar to NAC. Many VPN clients support post-authentication checks; Most common is to check antivirus and firewall <br>O ther possibilities; Vulnerability scan with automated remediation; Patch verification with automated remediation; Custom scripts (look for new running processes); A user associated with the new asset (require approval); **Longer an asset has been disconnected, the more checks need run** | 3.10O |
|  VPN Client Post-Authentication Checks, | Is similiar to NAC. Many VPN clients support post-authentication checks; Most common is to check antivirus and firewall <br>O ther possibilities; Vulnerability scan with automated remediation; Patch verification with automated remediation; Custom scripts (look for new running processes); A user associated with the new asset (require approval); **Longer an asset has been disconnected, the more checks need run** | 3.10O |
| Split VPN |  remote clients access the company's resources via the VPN but directly connect to the internet for other needs without going through the VPN. If organizations configure it to allow only specific and controlled requests to route to the internet, they can effectively minimize potential risks. In most scenarios, the bulk of internet traffic remains under traditional VPN controls. Only pre-approved application traffic takes alternative paths. | 3.101 |
| COVID-19, VPN Strategy | pandemic and the sudden surge in remote work have forced organizations to rethink this approach. Over-relying on VPNs can strain its resources and hinder remote workers' productivity, especially if they use Software-as-a-Service (SaaS) applications. | 3.101 |
|  Microsoft Endpoint Configuration Manager, VPN issue | (formerly SSCM), requiring all remote users to connect through VPN to receive these updates. caused issues especially during convid-19 | 3.101 |
| Remote Access Applications | VPNs are not the only means of remote access. Applications or other services common for remote access; Remote desktop and applications like GoToMyPC <br> Remote desktop uses built-in Remote Desktop Protocol (RDP).; Supports external use and multiple users via terminal services; Built for Windows and uses *TCP port 3389* <br>Other remote access methods similar to SSL/TLS VPNs; Agent installed may create a reverse tunnel to cloud **service | 3.103 | 
| Remote Access Programs, Blocking | All unauthorized remote access programs need to be blocked; These are not only policy violations, but they are also often abusedby threat actors (MITRE ATT&CK T1219) <br> Use application control, FQDN blocking, or sinkholing <br> Expect to find many remote access methods.; Common to find 10+ methods (shadow IT or policy violations); Focus on more than installed programs | 3.104 | 
| MITRE ATT&CK T1219 | Remote access abuse technique | 3.104 | 
| BlueKeep   | Server side attack vector based on how auth is handled | 3.105 |
| RD Gateway | Server side attack vector based on how auth is handled | 3.105 |
| password guessing | still is a viable and successful technique for hackers and penetration testers. Password attempt restrictions are beneficial, but multifactor should be a standard for external access.| 3.105 |
| Dictionary Attack|   1 of 2 most common forms of PW guessing; Attacker uses password lists; Tries all combinations per user list; May get blocked after X failed attempts| 3.106 |
| Password Spraying|  1 of 2 most common forms of PW guessing;  Same but one try per user before rotating; May get blocked by source IP after X failed attempts| 3.106 |
| Botnet tunneling |  Same as #1 or #2 but source changes per attempt; botnet password attack makes attribution and prevention significantly more difficult. | 3.106 |
| ProxyCannon | Emulates a private botnet using Amazon EC2; Automation script to deploy new Amazon instances <br> - Supports rotating instances every X time period <br> - Tunnels all traffic through Amazon instances - Traffic load balances among instances; Example: Password spray attempts would each come from a different instance.; Defenders can use for testing   Helps identify detection/prevention/response abilities | 3.107 | 
| Alternatives to VPN: ZTNA and SDP |  VPN provides access to a network. Access is often overly permissive, grantingremote workers access to more of the network that is needed. <br> Zero Trust Network Access (ZTNA) or Software Defined Perimeter (SDP)provides access to an application or resource, taking an identity-based, zerotrust approach that enforces a custom policy for each user device. Each connection istreated as untrusted and veri�ed continuously. <br> Ideally, organizations should be moving toward a ZTNA solution, but you will haveto coexist with VPN access for a while. <br> Your goal should be moving toward ZTNA/SDP for most of your users, and partnersaccess, while maintaining well tuned and secure VPN access to only bring clientsinto the network when necessary. <br> Other alternatives including cloud-based VDIs, or Desktops as a Service (DaaS) arebecoming increasingly popular (i.e., NICE DCV or Azure Virtual Desktop). | 3.108 | 
| Azure Virtual Desktop | formerly Windows Virtual Desktop, as a cloud-based virtual desktop infrastructure. | 3.108 | 
|  Guacamole | A Remote Desktop on HTML5, Apache Guacamole is an open-source clientless remote desktop gateway that supports RDP, SSH, and VNC through HTML5 and WebSocket. <br> Supports RADIUS, LDAP, 2FA (TOTP, Google Auth, Duo, etc.) with load balancing and more<br> SSL/TLS termination can be achieved with Nginx in front of it. <br> It can be deployed using docker. | 3.109 |
| controlling remote access | Administrative workstations, jump boxes, and identity access management (IAM) solutions | 3.11O |
| BloodHound | uses graph theory to reveal relationships between users, computers, groups, and containers or reveals additional security principals which are highly privileged and represent shadow admins. Using BloodHound should be part of your regular threat modeling process to get a better understanding of the impact of your configurations or to track changes over time in your AD environments. . | 3.11O | 
| PingCastle | a security tool designed to assess the risk level of an Active Directory infrastructure. The primary reason to use PingCastle is that Active Directory often becomes complex over time, and without regular reviews, certain settings or configurations can be overlooked, potentially leaving the environment vulnerable to attacks or misconfigurations, or to too much implicit trust | 3.11O |
| Clean Source Principle |  When assessing how much **implicit trust** we have in our internal environments, we should consider the Clean Source Principle. <br> - CSP states that a system can be dependent on a higher trust system but not on a lower trust system.<br> - This means that you should identify all objectssecurity dependencies and make sure that they are as trusted as the object you are trying to secure.<br> - While simple in principle, this concept gets complex easily in the real world as most enterprises grow organically.<br> - In Section 4, we will cover additional data-centric strategies including privileged access. | 3.111 | 
| credential theft and reuse | Primary issue with remote access; Malware/adversaries highly successful at stealing credentials; Credential on disk or in RAM <br> Cleartext password retrieval; Mimikatz1; LSA secrets; Saved passwordsHash dumping/token smuggling| 3.112 |
| Mimikatz attacks | Microsoft Mitigations; all of them can be turned off through the registry for backwards compatibility. You might want to ensure the mitigations are always enabled with the Group Policy. | 3.112 |
| Administrative Workstations | Credential theft is high risk on workstations with: Users that have administrative rights; Users that use browsers and mail clients on system; <br> Recommend using administrative workstation design; Or separate workstations for separate tasks<br> Administrative workstations are locked down.; Only standard user access; Or depending on risk tolerance, should be an admin with separate user; No productivity applications | 3.113 | 
| Jump Box Connection Options | **Remote Desktop**: RDP used for web and internet: Limits compromise to RDP server: Limits credential theft to the standardaccount:  Assumes email is not sensitive <br> RDP used for admin tasks: Limits physical security risks of theadministrative workstation | 3.114 |
| VDI |  is still relatively common these days, but not as prevalent as VPN. VDI is definitely a strong control for managing how remote users can access systems, applications, and data internally. VDI can be deployed to use non-persistent (ephemeral) instances that disappear upon session termination, thus forcing users to save data to a controlled file share or other designated location, and also helping to curb any malware or other malicious software that may infect the VDI instance (if applicable). The images can be fully patched and managed centrally, too, making security posture maintainable. <br> Big issue is cost | 3.114 | 
| DaaS | are becoming increasingly popular. For example, AWS recently announced NICE DCV 1, a high-performance remote display protocol. It lets you securely deliver remote desktops and application streaming from any cloud or data center to any device, over varying network conditions. By using NICE DCV with Amazon EC2 2, you can run graphics-intensive applications remotely on Amazon EC2 instances. You can then stream the results to more modest client machines, which eliminates the need for dedicated workstations.Azure also offers Azure Virtual Desktop (formerly Windows Virtual Desktop) as a cloud-based virtual desktop infrastructure. | 3.114 | 
| Jump Boxes, Controlled Authentication | Purpose-built remote access allows prevention and detection <br> Example: Domain admins must come from the jump boxConsider network activity from productivity systems internally <br> Should be highly limited and exceptions = SUSPICIOUS <br> The concept works well with non-IT staff and IT staff. | 3.117 |
| Bastion Host | Bastion hosts (also called jump servers) are usually used in cloud environments to access the private resources <br> You should use existing hardened templates. Dont create them from scratch. <br> While bastion hosts offer some protections, they are still vulnerable because they rely on the security of the administrator workstation accessing it. If an attacker compromises this workstation, the attacker can also control the bastion host.<br> These can be replaced with CSPs native remote access services i.e. (AWS Systems Manager and Session Manage) to avoid opening ports. | 3.118 |
| Jump Server | see Bastion Host | 3.118 |
| IAM | IAM is often used for federation and single sign-on (SSO); Allows centralized authentication with the federation; Allows one login to work with multiple systems (SSO); Can be dangerous without timeouts or requiring login for critical appsSolutions can also be used for custom authentication workflows | 3.12O |
| IAM federation solutions | many often support or rely on the OAuth **(or OAuth2.0)** protocol among other protocols like **SAML (Security Assertion Markup Language)** for federation and single sign-on capabilities. For example, SAML is often used for Single Sign-On (SSO) in enterprise scenarios, whereas OAuth might be used more in scenarios involving third-party application access to user resources without exposing user credentials. | 3.12O |
| Modern authentication | Strong authentication: using MFA with or without passwords. Often includes the Fast Identity Online (FIDO) standard and passwordless; Identity federation: between parties using SAML, OAuth and OpenID Connect (OIDC); Validation: on-login and in-session risk assessment | 3.125 | 
| Legacy authentication | Basic and Digest authentication; NTLM and Kerberos; Relies on separate accounts rather than federated access; No continuous validation built into the protocols or authentication flows | 3.125 | 
| Identity federation | lets different groups work together using tools like **SAML, OAuth, and OpenID Connect (OIDC)**. On top of that these authentication systems should check for risks when you log in and even during your session to adhere to the Zero Trust principles. | 3.125 |
| NTLM | Legacy Auth, has known vulnerabilities and has been considered weak for quite some time. It doesn't provide features like mutual authentication (ensuring both client and server are genuine). Due to its vulnerability to various attacks (like relay attacks), it's generally recommended to move away from NTLM where possible. | 3.125 |
| Kerberos | Legacy Auth, is more secure than NTLM, it's not without its challenges, especially when improperly configured. It also depends on time synchronization and can be vulnerable if weak or predictable encryption types are used. | 3.125 |
| MFA |** should be required in all cases**!; Prioritize privileged access or accessing critical infrastructure,data, or services;   Direct MFA push should be completely disabled with privilegedusers.Form of authentication should be mixed (two or more);  **Something you have**: Token (OTP), Smartcard, FIDO U2F;  **Something you know**: Password or PIN;  **Something you are**: Fingerprint, retina, and facial pattern | 3.126 |
| MFA Push | Should be disabled on all Priv Accounts | 3.126 | 
| HOTP | HMAC One Time Base PW; uses a secret key and counter to generate an HMAC. HMAC = Hashed Message Authentication Code.  Counter is an 8-byte value that changes with each use; Physical tokens or universal 2nd factor (U2F) devices use HOTP or TOTP. | 3.127 |
| TOTP | involves generating a password that rotates based on time. Password typically rotates every 30-60 seconds; Algorithm uses time since epoch and a shared secret key; Same as HOTP but uses time for counter Physical tokens or universal 2nd factor (U2F) devices use HOTP or TOTP. | 3.127 |
| Physical tokens | or universal 2nd factor (U2F) devices use HOTP or TOTP.  | 3.127 |
| Google Auth | Free multifactor for the world; Requires a Google accountSupports code via SMS, voice call, or phone app; Can also integrate with physical U2F security keysOnline documentation allows for integration with systems.; Windows WinAuth2agent; Linux Requires Google Authenticator PAM module; VPN Solutions  Most vendors support integration.; Apache Guacamole | 3.128 | 
| Fast Identity Online (FIDO) | An open industry association with a mission to reduce the world's reliance on passwords ;FIDO's two main protocol specifications are UAF (Universal Authentication Framework) and U2F (Universal 2nd Factor). ;FIDO2 includes WebAuthn and CTAP to enable passwordless | 3.129 |
| WebAuthn (Web Authentication) | A web standard developed by the World Wide Web Consortium (W3C) in collaboration with FIDO. It allows online services and applications to utilize FIDO-based public key authentication | 3.129 | 
| CTAP (Client to Authenticator Protocol) | Allows external devices like USB security keys, mobile devices, and other authenticators to work with web browsers and other platforms using WebAuthn.CTAP2 defines how to establish communication between FIDO2-enabled browsers and operating systems and external authenticators (FIDO Security Keys, mobile devices) to enable a passwordless, second-factor or multi-factor authentication experience. | 3.129 | 
| Fast Identity Online2 (FIDO2) |  can be used to authenticate against SaaS apps that directly support FIDO2, or authenticating into apps with SSO, that support FIDO2 standards. On the other hand, legacy applications often have problems supporting passwordless. | 3.129 |
| Adversary-in-the-middle | AiTM phishing attacks are used for bypassing multi-factor. AiTM attacks complete the authentication process and capture the token. Currently, there are three main open-source AiTM phishing kits available that are widely known: **Evilginx2**, **Muraena**, **Modlishka** | 3.131 |
| Evilginx2  | tool used in AiTM phishing kit | 3.131 |
| Muraena  | tool used in AiTM phishing kit | 3.131 |
| Modlishka| tool used in AiTM phishing kit | 3.131 |
| YubiKey | is a hardware-based authentication solution that offers strong two-factor, multi-factor and passwordless authentication with support for multiple protocols including FIDO2, U2F, PIV, Yubico OTP, and OATH TOTP | 3.131 |
| MFA fatigue | is a type of cyberattack that attempts to overwhelm users with requests for multi-factor authentication (MFA) codes. The goal of this attack is to trick users into approving fraudulent login attempts or transactions.These attacks are typically carried out using automated scripts that send repeated MFA requests to users. Attackers may use a variety of methods to obtain the users' email addresses or phone numbers, such as phishing attacks or data breaches | 3.133 |
| OAUTH 2.O | OAuth 2.0 standardizes the process for third-party applications to access user data without exposing the user's password. <br> Some of the most popular attacks include: OAuth token theft; Device Authorization Grant Phishing; Consent Phishing Attacks | 3.134 |
| OAuth 2.O | is an authorization protocol that allows applications to obtain limited access to user accounts on an HTTP service, such as Facebook, GitHub, and DigitalOcean. It standardizes the process for third-party applications to access user data without exposing the user's password. | 3.134 |
| OAuth Access Token | A transaction requires three players: the end user, the application (API), and the resource (service provider that has stored your privileged credentials). The transaction begins once the user expresses intent to access the API. | 3.134 |
| OAuth token theft | GitHub recently reported that data was downloaded from dozens of organizations as an attacker was using stolen third-party OAuth integrations tokens to access GitHub customers repos. Stealing an OAuth token will get an attacker the exact access a user or an admin granted to a third-party app. For an attacker this makes an access token more lucrative than a user/password set: stealing a token bypasses multi-factor authentication, as it was already satisfied. There are several ways an app token may be compromised  Phishing for OAuth code grant, using Open Redirects, using client-side or browser attacks, or good old malware stealing it directly off an endpoint | 3.134 |
| Device Authorization Grant Phishing | the Device Flow enables devices with no browser or limited input capability to obtain an access token. Apps for Smart TVs and media streamers often use it to authenticate. A user trying to authenticate with Netflix for example will get a QR code on his TV or a short URL to go to and enter a code the device got from the identity platform such as Azure AD or Apple to prove he is authenticating and Authorizing the device App from his mobile device. Auth Grant works without entering the app client secret, as it is meant for devices whose code is exposed publicly and can be extracted from the device. Without a client secret, anyone can ask for a device authorization code on behalf of any app that allows this flow. The missing protections make it easy for an attacker to phish the user to authenticate using an attacker-generated code and obtaining the access token from the identity platform. | 3.134 |
| Consent Phishing Attacks - Malicious Apps | phishing a user to install a malicious App is the most straightforward way of obtaining OAuth access tokens. Malicious apps are created by an attacker who lures the target to click the consent link and approve the app's access to the user's data. This attack gives complete control to the attacker and doesnt require the malicious infrastructure that common phishing attacks demand. The attacker tricks the user to consent to the app's permission and redirects back to the attacker with the access token. As the attacker created the phishing app, the attacker controls the allowed redirect links and the permission scopes requested | 3.135 |
| OAUTH Consent Phishing defense | Enable the option to require Admin consent in Azure Active Directory when users try toconsent to applications that are not from a verified publisher. This makes sure that the admins investigate any risky app before granting the consent.<br> Review the consent screen carefully before granting permissions to any app or service.<br> Avoid granting permissions that are excessive or inappropriate for the app's functionality. <br> Monitor used applications and revoke permissions from any apps or services that you nolonger use or trust. You can do this by visiting enterprise applications area in Azure AD or the OAuth section in Defender for CloudApps. <br> Alternatively, you can create an OAuth policy in Microsoft Defender for cloud apps to notify you when a user consents to risky applications based on the level of permission that theapplication requires, how common it is within the organization or even the exact permissionthat the app requests. | 3.136 |
| OpenID vs SAML vs OAuth | Although there is some overlap, below are very simple ways of distinguishing three protocols. <br> **OpenID**: single sign-on for consumers2. <br> **SAML**: single sign-on for enterprise users <br> **OAuth**:API authorization between applications <br> SAML, OAuth and OpenID all facilitate different intentions via a common underlying mechanism, which is redirection to a service provider/identity authority for some private interaction, followed by redirection to the originating third party app.| 3.137 |
| Network Encryption | Many solutions work primarily using Layer 4 through 7 inspection. However, even Layer 7 inspection can also fall short. Signatures look for specific things of interest. The problem is evasion tools are prevalent and easy to use, making signature matching flawed. Given enough time, it is possible to evade any sig based tool, defense in depth is important!!! <br> network encryption provides non-repudiation and trust. Specifically, network encryption uses trust to verify that a system is an expected system. Trust is implemented using public key infrastructure. | 3.139-14O |
| Network Encryption Issues |  Malware routinely uses encryption.; Phishing sites are commonly encrypted.; Malware uses TLS to communicate to C2 servers.; Encryption breaks current investments.; Cannot see data exfiltration; Cannot see or analyze malware; No application control; IDS/NSM visibility significantly less | 3.141 |
| Encryption Issues |  Malware routinely uses encryption.; Phishing sites are commonly encrypted.; Malware uses TLS to communicate to C2 servers.; Encryption breaks current investments.; Cannot see data exfiltration; Cannot see or analyze malware; No application control; IDS/NSM visibility significantly less | 3.141 |
| Leveraging Encryption |  Industry push is to encrypt everything; Concept increases risk rather than reducing it; Encryption should be deliberate and calculated.<br> **Encryption considerations:;** Is end-to-end encryption necessary?; Is encryption implemented securely?; Is inspection allowed?; Is strong crypto support forced? | 3.142 |
| DNS over HTTPS (DoH), Leveraging Encyption | DoH encrypts DNS traffic using the HTTPS protocol, which is the same protocol used for secure web browsing. This means that your DNS traffic will be indistinguishable from other HTTPS traffic, making it more difficult for third parties to intercept and monitor | 3.143 |
| DNS over TLS (DoT),Leveraging Encyption | DoT encrypts DNS traffic using the TLS protocol, which is the same protocol used for secure email and other online transactions. DoT is generally considered to be more performant than DoH, but it is not as widely supported by DNS servers | 3.143 |
| Lets Encrypt | The internet is moving toward 100% encryption.  Standard sites do not want to buy certificates. A free, automated, and open CA. Based on non-profit crowdfunding <br> Provides automated certificate issuance and renewal <br> Certbot automates certificates and hardens configuration. <br> Domain validated (own a DNS domain = free certificate)Already is being used for evil <br> Malware can easily have a trusted certificate. | 3.144 | 
| Strict-Transport-Security | HSTS Header Strict-Transport-Security: max-age=31536000; includeSubdomains | 3.145 |
| HTTP Strict Transport Security (HSTS) | Many websites support HTTP and HTTPS. <br> Done for performance but can greatly affect security <br> Switching between HTTP and HTTPS is insecure. <br> Information leakage (cookies, session tokens) and MITMHSTS fixes the above issues (requires setting HTTP header). <br> Upgrades HTTP links to HTTPS automatically <br> Disables ability to click through invalid certificates <br> Removes the ability to downgrade site access to HTTP | 3.145 |
| sslstrip | sslstrip1is a tool written by Moxie Marlinspike: Requires victim machine caught in a MITM attack; Then performs downgrade attacks on HTTPS; Supports padlock favicon to make folks feel more secureWorks because users browse the internet via google.com; Rather than https://www.google.com; Why browser site identity button is now used; ***One of the reasons HSTS was born*** | 3.146 |
| HSTS Preloading | The default behavior is that HSTS site must be accessed once Major browsers support HSTS preloading. <br> HSTS preload lists enforce HTTPS even on first access.Requirements for HSTS preloading: <br> The header must include subdomains, age over 1 year, and preload. <br> *Strict-Transport-Security: max-age=31536000; includeSubDomains;* ***preload*** <br> The site must redirect from HTTP to HTTPS. <br> Verify site is working, then submit a domain to hstspreload.org | 3.147 | 
| Certificate Transparency Monitoring| Certificate authorities are expected to generate public logs.; Means a public log is available per certificate issued; The goal is to require support for certificate transparency.Provides near real-time notification of new certificates; Vendors offer commercial integration and monitoring.1; Facebook provides free certificate transparency monitoring. | 3.148 | 
| certificate transparency | provides near real-time detection capabilities of certificate misuse. Commercial solutions like Cert Spotter or free solutions like Facebook certificate transparency monitoring can be subscribed to and provide automatic notification of new certificates issued for a domain. Google is pushing strongly for certificate transparency. To help force certificate transparency, Google Chrome will check a site's certificate of compliance with certificate transparency. Failure to comply will result in page errors or notifications and potentially being blocked moving forward. | 3.148 |
| Certificate Authority Authorization (CAA) | DNS can also be used to support proper certificate use. Specifically, certificate authority authorization, or CAA, records should be created to enforce which certificate authorities are authorized to create certificates for a given domain. A CAA record type includes a domain, a flag to identify if a record is critical or noncritical, a tag to identify the purpose, and the CAA record value, which is usually set to the name of an authorized certificate authority. | 3.149 |
| iodef | can be used to report invalid certificate requests to the domain owner. If the iodef tag is used, either an email address or web server address can be specified <br> *sec530.com.CAA 0 iodef mailto:someone@sec530.com*<br> *sec530.com.CAA 0 iodef "certissues.sec530.com"*| 3.149 |
| Crypto Suite Support | Different devices/software support different algorithms. <br> Cipher suites are the encryption algorithms supported. <br> Examples: TLS_RSA_WITH_RC4_128_MD5 and TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P521 <br> Weak ciphers can be exploited by adversaries. <br> Malware may use abnormal or old ciphers.Modern operating systems allow selection of ciphers <br> Windows via registry keys1and Linux via configuration files <br> **Zeek logs can help identify what algorithms are used on the network.** | 3.15O | 
| Crypto Suite Support | Different devices/software support different algorithms. <br> Cipher suites are the encryption algorithms supported. <br> Examples: TLS_RSA_WITH_RC4_128_MD5 and TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P521 <br> Weak ciphers can be exploited by adversaries. <br> Malware may use abnormal or old ciphers.Modern operating systems allow selection of ciphers <br> Windows via registry keys1and Linux via configuration files <br> **Zeek logs can help identify what algorithms are used on the network.** | 3.15O | 
| /etc/apache2/sites-enabled/ssl_site.conf | location to set cipher use for Apache service on Linux;  can be configured to only use certain cipher suites by using a global configuration file or a site-specific file such | 3.15O |
| Ciphers for Windows system | can be configured by editing the group policy found at *Computer Configuration -> Administrative Templates -> Network -> SSL Configuration Settings -> SSL Cipher Suite Order*. | 3.15O |
| Qualys SSL Labs | Web servers need to be hardened for proper encryption.;Disable SSL support;Fine-tune cipher suites;Enable proper headers ;Such as HSTS and HPKP;Harden SSL/TLS settingsQualys SSL Labs1scans and grades SSL/TLS settings.;Recommendations provided to improve the score | 3.151 |
| SSL/TLS Passive Decryption | Proper certificate establishment and use is important. <br> But so is maintaining security capabilities and visibility.Depending on the encryption method, decryption is possible. <br> Packet captures can be decrypted with Wireshark.1 <br> Tools like viewssld2can decrypt data on the fly.Passive sniffing has a high fail rate for decryption. <br> Perfect forward secrecy (PFS) breaks passive decryption. <br> Many internet sites use PFS. | 3.152 | 
| Perfect Forward Secrecy (PFS) | PFS negotiates an encryption key using Diffie-Hellman.; Symmetric key changes per client/server session; Even if the private key is compromised, prior sessions are unlikely to be decrypted. | 3.153 | 
| TLS 1.3 |  TLS 1.3 is the latest version of the TLS protocol, dropping support for older, less secure cryptographic features and speeding up TLS handshakes, among other improvements. <br> TLS 1.3 is widely used, becoming the chosen encryption protocol for most web servers among the top million. <br> TLS 1.3 is faster requiring only one round trip instead of two, cutting down latency. <br> In TLS 1.3, vulnerable algorithms have been removed, including RSA and any static, non-PFS key exchanges. <br> Everything after the server hello is now encrypted, including the X.509 certificate| 3.154-155 |
| SSL inspection | involves acting as a proxy for SSL/TLS connections. It functions by initiating an SSL session with the requested services, receiving the expected data, decrypting it, and then re-encrypting using a generated certificate. The re-encrypted data is delivered to the initial system requesting the connection. <br> The most important aspect of SSL inspection is that now there is full visibility into the traffic. The visibility includes everything including usernames, passwords, and other sensitive information. As a result, there are political and ethical concerns with SSL inspection. However, without SSL inspection technologies like AV, IDS/IPS, malware detonation, and more cannot function and become expensive paperweights | 3.156 |
| SSL Decrypt Mirroring |Modern devices with SSL Inspection also support SSL decrypt mirroring.; Decrypted packets are mirrored out an interface; Puts NSM/IDS back in the game <br> Decrypted traffic shows up withthe original port, such as 443.  But reflects decrypted data  IDS should include 443 in $HTTP_PORTS.| 3.157 | 
| TLS Interception Risks | There are a number of risks and cons associated with TLS interception, including:<br>Increased attack surface: If the TLS interception system is compromised, attackers could gain access to sensitive data, such as passwords, credit card numbers, and other personal information.<br>Increased management overhead in part due to the increasing use of certificate pinning in mobile apps. Over 11% of iOS apps use cert pinning according to a study, and the number is increasing. | 3.159 | 
| Certificate pinning | Certificate pinning is a security technique that can be used to mitigate the risks of TLS interception. However, certificate pinning can also make TLS interception more difficult to manage. This is because organizations need to update their applications to support certificate pinning and to manage the pinned certificates. | 3.159 | 
| local virtualization segmentation | Possible to localize jump box with virtualization; Potential risk of VM escape; Attacker compromising host from within VMPhysical host needs to be the secured OS; Productivity applications should be in VM; Compromise of host = compromise of VM <br> Host OS has full access to VM disks and full memory visibility | 3.116 |
| Tufin | tool to ingest rules and policies, and track them as the number of rules grows. another option is  AlgoSec | 3.3O | 
| Cloud NGFWs | enable for all north-south traffic to and from the cloud subscriptions or accounts in all virtual private clouds (VPCs) or virtual networks. Services like Azure Firewall and AWS Network Firewall can also play a role in centralized network defense. | 3.3O | 
| AMIs Cloud NGFW | Include: Palo Alto Networks VM-Series; Cisco Adaptive Security Virtual Appliance (ASAv); Fortinet FortiGate; Check Point CloudGuard; Sophos XG Firewall; Barracuda CloudGen Firewall; SonicWall NSv; | 3.3O |
| Cloud NGFW  AMIs  | Include: Palo Alto Networks VM-Series; Cisco Adaptive Security Virtual Appliance (ASAv); Fortinet FortiGate; Check Point CloudGuard; Sophos XG Firewall; Barracuda CloudGen Firewall; SonicWall NSv; | 3.3O |
| Palo Alto Networks VM-Series | Palo Alto Networks offers a VM-Series NGFW that you can deploy as an AMI in AWS <br> - It provides advanced security features and integrates with the Palo Alto Networks ecosystem | 3.3O | 
| Cisco Adaptive Security Virtual Appliance (ASAv) | Cisco offers ASAv as an NGFW solution in a virtual appliance form <br> - It supports various security features and can be deployed as an AMI in AWS3 | 3.3O | 
| Fortinet FortiGate | Fortinet provides FortiGate virtual appliances that offer NGFW capabilities <br> - You can find FortiGate AMIs in the AWS Marketplace and choose the appropriate instance size based on your  | 3.3O | 
| Check Point CloudGuard | Check Point offers CloudGuard as a virtual NGFW solution that can be deployed in AWS <br> - It provides advanced threat prevention and centralized management | 3.3O | 
| Sophos XG Firewall | Sophos XG Firewall is available as an AMI in AWS <br> - It combines advanced security features, including web filtering, IPS, application control, and more | 3.3O | 
| Barracuda CloudGen Firewall | Barracuda Networks offers the CloudGen Firewall as a virtual appliance that provides NGFW capabilities <br> - You can find Barracuda CloudGen Firewall AMIs in the AWS Marketplace | 3.3O | 
| SonicWall NSv | SonicWall offers the NSv series as virtual NGFW appliances that can be deployed in AWS <br> - They provide features such as threat prevention, TLS inspection, and VPN connectivity | 3.3O | 
| WatchGuard Firebox Cloud | is a virtual NGFW solution that can be deployed in AWS;  It offers advanced security services, including web filtering, network discovery, and application control | 3.3O | 
| AWS Network Firewall | AWS itself provides Network Firewall as a managed firewall service. Although its not an NGFW from a specific vendor, it offers essential firewall capabilities and integrates well with other AWS services. | 3.3O | 
| Juniper Networks vSRX | Juniper Networks offers vSRX as a virtual NGFW solution that can be deployed in AWS. It provides advanced security features, including intrusion prevention, application visibility, and unified threat management. | 3.3O | 
| enablesid.conf, PulledPork Conf file | Forces a rule to be enabled | 3.8o |
| dropsid.conf, PulledPork Conf file | Sets rules to drop (used in IPS mode) | 3.8o |
| disablesid.conf, PulledPork Conf file | Disables rules on sensor1:2012648 <br> # ET POLICY Dropbox Client Broadcastingpcre:ET\ GAMES <br> # Disable all ET GAMES rules; Enable, drop, and disable share syntax (gid:sid or pcre) | 3.8o |
| modifysid.conf, PulledPork Conf file | Modifies rulesets with find/replace2012648 "\$HOME_NET" "!10.5.30.5" # ignore 10.5.30.5 | 3.8o | 
| Anomaly detection |  in an IDS is usually in the form of protocols not conforming to common behaviors or RFC requirements. Can also be from automatic baselining or statistical calculations, but historically ***automatic baselining*** has not been mature. Instead, the **core of NIDS is signature-based rules**. | 3.7o | 
| NIDS Rules | Specifically look for network connections and specific Layer 7 payload information. If a match is found, a NIDS reacts. Most of the time an alert is generated, but a NIDS can also block traffic or kick off short-term packet captures to gather additional information | 3.7o |